"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5512],{54490:(e,t,r)=>{r.d(t,{Z:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"DebugPanel.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>Promise.all([r.e(6122),r.e(7671)]).then(r.bind(r,87048)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>87048},{ssr:!1})},33728:(e,t,r)=>{r.d(t,{S:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"GameNewsContainerVertical.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>r.e(5309).then(r.bind(r,34915)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>34915},{resolveComponent:e=>e.GameNewsContainerVertical})},73571:(e,t,r)=>{r.d(t,{Z:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"BalanceRefilled.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>r.e(4521).then(r.bind(r,7911)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>7911},{ssr:!1})},58595:(e,t,r)=>{r.d(t,{Z:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"MergeConflictsDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>r.e(3925).then(r.bind(r,94639)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>94639},{})},20119:(e,t,r)=>{r.d(t,{Z:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"PlayPurchaseDialog.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>Promise.all([r.e(6122),r.e(3332),r.e(8726)]).then(r.bind(r,3739)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>3739},{ssr:!1})},24568:(e,t,r)=>{r.d(t,{P:()=>a});r(57627);const a=(0,r(97787).Z)({resolved:{},chunkName:()=>"DisableAdvButtonSticky.component.async",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!r.m[t]},importAsync:()=>Promise.all([r.e(6122),r.e(9117)]).then(r.bind(r,46707)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then(e=>(this.resolved[t]=!0,e))},requireSync(e){const t=this.resolve(e);return r(t)},resolve:()=>46707},{resolveComponent:e=>e.DisableAdvButtonSticky})},36240:(e,t,r)=>{function a(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0}function s(e,t){if("signature"in e){const{signature:r}=e;if("string"==typeof r){const{data:e}=JSON.parse(function(e){for(var t,r="",a=e.length,s=0;s<a;s++)t=e[s],r+=String.fromCharCode(t>251&&t<254&&s+5<a?1073741824*(t-252)+(e[++s]-128<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>247&&t<252&&s+4<a?(t-248<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>239&&t<248&&s+3<a?(t-240<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:t>223&&t<240&&s+2<a?(t-224<<12)+(e[++s]-128<<6)+e[++s]-128:t>191&&t<224&&s+1<a?(t-192<<6)+e[++s]-128:t);return r}(function(e){for(var t,r,s=e.replace(/[^A-Za-z0-9\+\/]/g,""),i=s.length,n=3*i+1>>>2,o=new Uint8Array(n),l=0,d=0,c=0;c<i;c++)if(r=3&c,l|=a(s.charCodeAt(c))<<18-6*r,3===r||i-c===1){for(t=0;t<3&&d<n;t++,d++)o[d]=l>>>(16>>>t&24)&255;l=0}return o}(r.split(".")[1])));return{data:e,signature:r}}t({},new Error("response.signature is not a string"))}return{data:e}}r.d(t,{c:()=>s})},77671:(e,t,r)=>{r.d(t,{X:()=>k});var a=r(57627),s=r(87363),i=r(16128),n=r(53322),o=r(62218),l=r(87214);const d={"sz-18":"checkbox-critical-module__sz-18--bkrJI","align-top":"checkbox-critical-module__align-top--LZGTh","align-center":"checkbox-critical-module__align-center--P6SxJ","align-bottom":"checkbox-critical-module__align-bottom--YTlvt",checkbox:"checkbox-critical-module__checkbox--QSq4A",checked:"checkbox-critical-module__checked--iGuDb",disabled:"checkbox-critical-module__disabled--BAmph",part:"checkbox-critical-module__part--XjCPu",control:"checkbox-critical-module__control--gdlIp",tick:"checkbox-critical-module__tick--Csl14",wrapper:"checkbox-critical-module__wrapper--XCy8g"};let c;var u=Object.defineProperty,h=Object.defineProperties,p=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,y=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f=(e,t)=>{for(var r in t||(t={}))m.call(t,r)&&y(e,r,t[r]);if(v)for(var r of v(t))g.call(t,r)&&y(e,r,t[r]);return e};const w={...(c=r(68178))&&c.default||{}},b=(0,s.forwardRef)((e,t)=>{const r=e,{align:c="center",className:u="",size:y,checked:b=!1,disabled:k=!1,onChange:A,onKeyDown:S,onKeyUp:P,label:I}=r,T=((e,t)=>{var r={};for(var a in e)m.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&v)for(var a of v(e))t.indexOf(a)<0&&g.call(e,a)&&(r[a]=e[a]);return r})(r,["align","className","size","checked","disabled","onChange","onKeyDown","onKeyUp","label"]),E=`input-${(0,s.useId)()}`,C=(0,s.useCallback)(e=>{!k&&(null==A||A(e))},[k,A]),D=(0,l.c)({variant:"checkbox-label"});return(0,a.jsxs)("div",{className:(0,o.y)(d.checkbox,k&&d.disabled,b&&d.checked,d[`align-${c}`],d[`sz-${y}`]),children:[I&&(0,a.jsx)("label",{className:(0,o.y)(d.part,w.label,D),htmlFor:E,children:I}),(0,a.jsxs)("div",{className:(0,o.y)(d.wrapper,d.part),children:[(0,a.jsx)("div",{className:(0,o.y)(d.tick),children:b&&(0,a.jsx)(i.Z,{size:18,children:(0,a.jsx)(n.Z,{})})}),(0,a.jsx)("input",(R=f({type:"checkbox"},T),x={autoComplete:"off",checked:b,className:(0,o.y)(u,d.control),disabled:k,id:E,ref:t,onChange:C},h(R,p(x))))]})]});var R,x});b.displayName="Checkbox";const k=(0,s.memo)(b)},81092:(e,t,r)=>{r.d(t,{AN:()=>c,f_:()=>n,ht:()=>s,hu:()=>i,lt:()=>l,rV:()=>o,wu:()=>d});var a=r(23497);const s=e=>({type:a.esH,payload:{value:e}}),i=e=>({type:a.iZl,payload:{value:e}}),n=e=>({type:a.OSx,payload:{value:e}}),o=e=>({type:a.E_7,payload:{value:e}}),l=e=>({type:a.Die,payload:{value:e}}),d=e=>({type:a.atG,payload:{value:e}}),c=e=>({type:a.cIs,payload:{value:e}})},19694:(e,t,r)=>{r.d(t,{B8:()=>i,Nl:()=>n,bL:()=>a,yD:()=>s});const a=e=>e.ui.isFullscreenActive,s=e=>e.ui.isFullscreenEnabled,i=e=>e.ui.isLoginStripeLargeModalVisible,n=e=>e.ui.isLoginStripeModalVisible},86712:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(93335),s=r(38225),i=r(76753),n=r(150);const o=()=>{const e=(0,s.T)(),t=(0,s.C)(e=>e.advPartnerInfo.advEnabledByPartner);return(0,i.q)(()=>{if(null!==t)return;const r=Date.now(),s=window.setInterval(()=>{const t=(0,n.kH)();(void 0!==t||(0,n.$g)(r))&&(window.clearInterval(s),e((0,a.ju)(!t)))},100);return()=>{window.clearInterval(s)}}),null}},79020:(e,t,r)=>{r.d(t,{Z:()=>T});var a=r(4545),s=r(87363),i=r.n(s),n=r(32221),o=r(23665),l=r(22706),d=Object.defineProperty,c=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,p=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t)=>{for(var r in t||(t={}))u.call(t,r)&&p(e,r,t[r]);if(c)for(var r of c(t))h.call(t,r)&&p(e,r,t[r]);return e};class m{constructor(e){var t;p(this,"symbol"!=typeof(t="REPORT_URL")?t+"":t,undefined),this.REPORT_URL=`https://csp.yandex.net/csp?from=${encodeURIComponent(e)}-game-html&project=${encodeURIComponent(e)}`}getReportURL(e){return(0,n.Z)({url:this.REPORT_URL,params:v({yandexuid:(0,o.e)("yandexuid")||""},e)})}report(e,t){const r=this.getReportURL(t);return(0,l.Z)(r,e,{credentials:"omit"})}}var g=r(77314),y=r(78825),f=r(19960),w=r(20966);function b(){const e="production";switch(e){case"production":case"prestable":case"testing":return e;default:return"development"}}var k=r(27172);function A(e){return e===k.n.desktop?"desktop":"touch"}var S=r(84791),P=r(60617),I=r(99251);const T=i().memo(e=>{const{page:t}=e,{deviceType:r,playPageData:i,abt:n,version:o}=(0,g.b)(),l=(0,s.useMemo)(()=>{const e={environment:b(),page:t,platform:A(r),version:String(o)};if("app"===t&&i){const t=String(i.gameInfo.appId);t&&(e.appId=t)}return e},[r,t,i,o]),d=(0,s.useMemo)(()=>new m((0,a.getDomainConfig)().analytics.rumProject||"games"),[]),c=(0,s.useCallback)((e,t)=>{if("violation"===e.data.action){const r=function(e){try{const{data:t}=e.data;if(function({blockedURI:e,originalPolicy:t}){return!!/^https?:\/\/log\.strm\.yandex\.ru/.test(e)||"child-src 'self' blob: mc.yandex.ru; connect-src 'self' localhost.msup.yandex.ru mc.yandex.ru amc.yandex.ru an.yandex.ru jstracer.yandex.ru verify.yandex.ru *.verify.yandex.ru csp.yandex.net strm.yandex.ru strm.yandex.net *.strm.yandex.net favicon.yandex.net avatars.mds.yandex.net yandexmetrica.com www.google-analytics.com www.googletagmanager.com games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; default-src 'self'; font-src 'self' yastatic.net yastat.net an.yandex.ru fonts.gstatic.com; frame-src 'self' localhost yastatic.net; img-src 'self' data: blob: mc.yandex.ru amc.yandex.ru an.yandex.ru verify.yandex.ru *.verify.yandex.ru favicon.yandex.net avatars.mds.yandex.net games.games-test.yandex.ru games-sdk.yandex.az games-sdk.yandex.by games-sdk.yandex.co.il games-sdk.yandex.com games-sdk.yandex.com.am games-sdk.yandex.com.ge games-sdk.yandex.com.tr games-sdk.yandex.ee games-sdk.yandex.fr games-sdk.yandex.kg games-sdk.yandex.kz games-sdk.yandex.lt games-sdk.yandex.lv games-sdk.yandex.md games-sdk.yandex.ru games-sdk.yandex.tj games-sdk.yandex.tm games-sdk.yandex.ua games-sdk.yandex.uz; media-src 'self' data: blob: strm.yandex.ru *.strm.yandex.net; script-src 'self' 'unsafe-eval' 'unsafe-inline' blob: yandex.ru *.yandex.ru yastatic.net; style-src 'self' 'unsafe-eval' 'unsafe-inline' fonts.googleapis.com; report-uri https://csp.yandex.net/csp?from=games-game&project=games&yandex_login=&yandexuid=;"===t}(t))return null;const{blockedURI:r,columnNumber:a,disposition:s,documentURI:i,effectiveDirective:n,lineNumber:o,originalPolicy:l,referrer:d,sample:c,sourceFile:u,statusCode:h,violatedDirective:p}=t;return JSON.stringify({"csp-report":{"document-uri":i,referrer:d,"violated-directive":p,"effective-directive":n,"original-policy":l,disposition:s,"blocked-uri":r,"line-number":o,"column-number":a,"source-file":u,"status-code":h,"script-sample":c}})}catch(e){(0,w.H)({message:"[CSP] Failed to create violation report"},e)}return null}(e);((0,P.jP)(n.flags)?S.EE:S.Bu)(()=>{r?d.report(r,l).then(e=>t({data:e})):t({data:null})})}},[d,l,n]);return(0,s.useEffect)(()=>{const e=new URLSearchParams((0,I.e)().search);if(Boolean(e.get("debug-mode"))||(0,f.m)()||Math.random()<.05)return y.Z.onExternalMessage("csp",c),function(){y.Z.offExternalMessage("csp",c)}},[c]),null})},42876:(e,t,r)=>{r.d(t,{G:()=>o,Z:()=>l});var a=r(57627),s=r(36329),i=r(87363),n=r(29743);const o="test_currency",l=()=>{const[e,t]=(0,i.useState)(!0);(0,i.useEffect)(()=>{t(!0===(0,n.Q)(o))},[]);const r=(0,i.useCallback)(()=>{const r=!e;t(r),(0,n.H)({[o]:r})},[e]);return(0,a.jsx)(s.z,{size:32,title:"Toggle currency mock",view:"secondary",onClick:r,children:`ðŸª™ Currency mock is ${e?"enabled":"disabled"} `})}},65564:(e,t,r)=>{r.d(t,{H:()=>n});var a=r(57627),s=r(54490),i=r(59664);const n=()=>(0,i.mv)()?(0,a.jsx)(s.Z,{}):null},59664:(e,t,r)=>{r.d(t,{A:()=>l,Sy:()=>i,hw:()=>o,mv:()=>d,q:()=>n});var a=r(61310),s=r(87125);const i=()=>a.v.HasFlag(s.AV,s.aR.AdvertisementPanel),n=()=>a.v.HasFlag(s.AV,s.aR.LogPanel),o=()=>a.v.HasFlag(s.AV,s.aR.GameDeveloperPanel),l=()=>a.v.HasFlag(s.AV,s.aR.RecordPanel),d=()=>o()||n()||i()||l()},8823:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(57627),s=r(96896);const i=({children:e,block:t,game:r,listType:i,mix:n,onClick:o,onRef:l})=>(0,a.jsx)(s.Z,{game:r,mix:n,redirParamsForGame:{block:t,card:"event",listType:i},onClick:o,onRef:l,children:e})},20595:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(57627),s=r(24540),i=(e=>(e.DISCOUNT="discount",e.NORMAL="normal",e))(i||{});const n=({text:e,type:t=i.NORMAL,size:r=24})=>{const n=t===i.DISCOUNT;return(0,a.jsx)(s.C,{colorsCSSProps:n?{background:"--promo-badge-discount-background-color",boxShadow:"--promo-badge-discount-shadow-color",text:"--promo-badge-discount-text-color"}:{background:"--promo-badge-background-color",text:"--promo-badge-text-color"},fontWeight:"bold",size:r,text:e,type:"inline"})}},54059:(e,t,r)=>{r.d(t,{Bl:()=>a,VN:()=>s,nD:()=>n,nV:()=>i});var a=(e=>(e.FUTURE="future",e.NOW="now",e.PAST="past",e))(a||{}),s=(e=>(e.LESS24="less24",e.MORE24="more24",e))(s||{}),i=(e=>(e.COMMON="common",e.COMPACT="compact",e.COMPACT_LITE="compact-lite",e))(i||{}),n=(e=>(e.COMMON="common",e.COMPACT="compact",e))(n||{})},67818:(e,t,r)=>{r.d(t,{F:()=>l});var a=r(54059),s=r(2592);const i=(e,t,r)=>({type:r,label:e.getTime()-t.getTime()>s.s2?a.VN.MORE24:a.VN.LESS24,dateTime:e});var n=r(77314),o=r(39138);const l=({endTime:e,formattedEndDate:t,formattedStartDate:r,startTime:s})=>{const l=(0,o.T)(),{lang:d}=(0,n.b)(),{dateTime:c,type:u}=((e,t)=>{const r=new Date,s=new Date(1e3*e),n=new Date(1e3*t);return s>r?i(s,r,a.Bl.FUTURE):n>r?i(n,r,a.Bl.NOW):{type:a.Bl.PAST,label:a.VN.LESS24,dateTime:n}})(s,e),h=u===a.Bl.FUTURE?"game-news.dates.after":"game-news.dates.until";let p=u===a.Bl.FUTURE?r:t;return null!=p||(p=((e,t)=>e.toLocaleDateString(t,{day:"numeric",month:"long"}))(c,d)),l(h,{params:{value:p}})}},81399:(e,t,r)=>{r.d(t,{U:()=>s});var a=r(74516);const s=({game:e,promo:t,size:r=a.KL.pjpg480x270,imageType:s})=>{const[i]=(0,a.B3)(e.media,{size:r,imageType:s});let n="";if(t.images.length){const e=(0,a.B3)({cover:t.images[0]},{size:r,imageType:s});e.length&&(n=e[0]||"")}return n||i}},12883:(e,t,r)=>{r.d(t,{h:()=>a});const a=e=>{if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?null:t}},26156:(e,t,r)=>{r.d(t,{Z:()=>y});var a=r(57627),s=r(45682),i=r(60362),n=r(87363),o=r(97435),l=r(58595),d=r(77314),c=r(39138),u=r(78825),h=r(38207),p=r(61712),v=r(20966),m=r(99634),g=r(33376);const y=()=>{const[e,t]=(0,n.useState)(void 0),r=(0,c.T)(),y=(0,d.b)(),f=null==e?void 0:e.data;(0,n.useEffect)(()=>{function e(){var e,a,n;(null==(a=null==(e=window.YandexGamesSDK)?void 0:e.conflicts)?void 0:a.data.conflictInfo)&&(u.Z.offAllMessages("merge-conflicts",r),t(null==(n=window.YandexGamesSDK)?void 0:n.conflicts),u.Z.postToChild((0,s.TI)(i.q1.ACCOUNT_SELECTION_DIALOG_OPENED)))}function r(t,r){"processing"===t.data.action&&e()}return u.Z.onAllMessages("merge-conflicts",r),e(),()=>{u.Z.offAllMessages("merge-conflicts",r)}},[]);const{gamePause:w,gameResume:b}=(0,h.ff)();return(0,n.useEffect)(()=>{if(f)return w("merge_conflicts_dialog"),()=>{b("merge_conflicts_dialog")}},[f,w,b]),f?(0,a.jsx)(l.Z,{conflicts:f,onResolve:a=>{(0,p.NF)({},g.Ji.MERGE_CONFLICTS_RESOLVE),t(void 0),new o.Z(window.YandexGamesSDK.apiData).setResolveConflict({appID:y.playPageData.gameInfo.appId,authPriority:"account"===a,iGames:"account"===a?void 0:a}).then(()=>{null==e||e.callback(!0),u.Z.post({type:"message-box",action:"show",data:{message:r("merge-conflicts.success")}})}).catch(t=>{(0,v.H)({message:`SDK Api request error from ${m.Wv}`,type:"fetch"},t),null==e||e.callback(!1),u.Z.post({type:"message-box",action:"show",data:{message:r("merge-conflicts.error"),type:"error"}}),console.warn("Data not applied")}).finally(()=>{u.Z.postToChild((0,s.TI)(i.q1.ACCOUNT_SELECTION_DIALOG_CLOSED))})}}):null}},45758:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(57627),s=r(51340),i=r(4522);const n=({onClosePaymentModal:e,renderSpin:t,renderPurchaseIframe:r,skipEmail:n,isVisibleIframe:o,children:l,isSpinVisible:d})=>(0,a.jsx)(s.Z,{centeredVertically:!1,cls:(0,i.E)("PaymentsModalDesktop-module__modal--n9yJJ","inAppForm"),isAdaptive:!0,testId:"in-app-form",onClose:e,children:(0,a.jsxs)("div",{className:(0,i.E)("PaymentsModalDesktop-module__modalInner--xPuSv",o?"PaymentsModalDesktop-module__modalIframeVisible--ianzL":"",n?"PaymentsModalDesktop-module__skipEmail--kEHK1":""),children:[(0,a.jsx)("div",{className:"PaymentsModalDesktop-module__modalInnerLeft--WcA7L",children:d?t():(0,a.jsx)("div",{className:"PaymentsModalDesktop-module__modalInnerLeftContent--Vf7oY",children:l})}),(0,a.jsx)("div",{className:"PaymentsModalDesktop-module__modalInnerRight--sZ4pG",children:(0,a.jsx)("div",{className:"PaymentsModalDesktop-module__purchaseIframeContainer--EZ000",children:r()})})]})})},99654:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(57627),s=r(19291);var i=r(49513),n=r(15292),o=r(77314),l=r(53673),d=r(50337);const c=()=>{const e=(()=>{const{platform:e,isSafari:t,lang:r}=(0,o.b)(),{isIOS:a}=(0,d.AK)(e),s=(0,n.u)();var c;return(c={isIOS:Boolean(a||t),lang:r},{[l.ob.XSOLLA]:["visa","master-card",c.isIOS?"apple-pay":"google-pay"],[l.ob.PSP]:["sbp","mir",c.lang===i.I.RU?"yandex-pay-ru":"yandex-pay-en"]})[s]})();return(0,a.jsx)("div",{className:"PaymentsList-module__paymentListContainer--gc3zj",children:e.map(e=>(0,a.jsx)(s.Z,{className:"PaymentsList-module__iconContainer--iCVZb",type:e},e))})};var u=r(39138),h=r(4522);const p=({className:e})=>{const t=(0,u.T)(),r=(0,n.u)()===l.ob.XSOLLA;return(0,a.jsxs)("div",{className:(0,h.E)("PaymentsFooter-module__payments-footer--aVZaB",e),"data-testid":"payments-footer",children:[(0,a.jsxs)("div",{className:"PaymentsFooter-module__label--bTW6b",children:[(0,a.jsx)(s.Z,{className:"PaymentsFooter-module__lock-icon--nWC1e",type:"lock"}),(0,a.jsx)("span",{children:t("payments.secured_by",{params:{operator:r?"XSolla":"SSL"}})})]}),(0,a.jsx)(c,{})]})}},41145:(e,t,r)=>{r.d(t,{Z:()=>a});var a=(e=>(e.BALANCE="balance",e.PURCHASE="purchase",e))(a||{})},61582:(e,t,r)=>{r.d(t,{q:()=>n});var a=r(87363),s=r(61265);const i=[],n=()=>{const e=(0,a.useContext)(s.OM),t=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{e&&!t.current&&(t.current=!0,i.forEach(t=>{e.registerPopup(t)}))}),null}},89875:(e,t,r)=>{r.d(t,{Z:()=>Ms});var a=r(57627),s=r(87363),i=r.n(s),n=r(65751),o=r(72936),l=r(89131),d=r(66287),c=r(29276),u=r(43774),h=r(61533),p=r(30928),v=r(94713),m=r(12536),g=r(78339),y=r(38225),f=r(63904),w=r.n(f),b=r(87125);const k=(w().with("google-sticky-adv-banner"),(0,b.M$)("AdsenseStickyBanner",b.XG.Adv));var A=r(27987);const S=w().with("google-sticky-adv-banner"),P=(0,b.M$)("PubliftStickyBanner",b.XG.Adv),I=({slot:e,provider:t})=>{(0,s.useEffect)(()=>{const r=e.current;return()=>{r&&t&&(P(`Destroy slot ${r}`),t.destroySlot(r))}},[t,e])};var T=r(70931);const E=({width:e,minHeight:t,height:r})=>(0,s.useMemo)(()=>{if(r)return{height:r,minHeight:r};const a={maxWidth:e,width:e};return t&&(a.minHeight=t),(0,T.oi)(a)},[r,t,e]);var C=r(23160),D=r(89196);const R=w().with("google-sticky-adv-banner"),x=T.P5.COLUMN,_=({advLogger:e,block:t,blockType:r,hidden:i,location:n=D.rq.RIGHT,withSpinner:l,width:d,provider:c,refreshCounter:u,onAdvShowed:h,onClose:p})=>{const v="google-adv-sticky-banner-"+r,m=(0,s.useRef)(void 0),g=(0,s.useMemo)(()=>null==e?void 0:e.copy({advBlockId:t.slotId}),[e,t.slotId]),[y,f]=(0,s.useState)(l),{maxHeight:w,minHeight:b}=(0,s.useMemo)(()=>r===o.kq.DESKTOP?{minHeight:600}:{maxHeight:250},[r]),S=E({width:d,minHeight:b});I({slot:m,provider:c});const P=(0,s.useCallback)(()=>{return e=function*(){if(c&&g)try{m.current&&(yield c.destroySlot(m.current)),k(`Create slot for ${v}`),g.demand({advBlockId:t.slotId,depth:0,provider:C.e.Adsense}),m.current=yield c.createSlot({adFormat:w?"fluid":"auto",blockId:t.slotId,clientId:t.clientId,divId:v,height:b||250,maxHeight:w,width:d}),g.request();const{isEmpty:e,slot:r}=yield c.preloadSlot({slot:m.current});if(e)return g.responseEmpty(),k(`#${v} empty.`),void p(T.JK.Desktop);g.response(),yield c.showSlot(r),g.show(),c.setClickEventListener(r,()=>{null==g||g.click()}),f(!1),h(),k(`Creative showed for ${v}`)}catch(e){k(`Failed to refresh ${v}`,e),p(T.JK.Desktop)}},new Promise((t,r)=>{var a=t=>{try{i(e.next(t))}catch(e){r(e)}},s=t=>{try{i(e.throw(t))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,s);i((e=e.apply(undefined,null)).next())});var e},[g,t,v,b,w,c,d,h,p]);return(0,s.useEffect)(()=>{!c||!g||u<0||P()},[c,g,P,u]),(0,a.jsx)("div",{className:R({desktop:!0,[`desktop_${n}`]:!0,direction:x,hidden:i,"with-disable-ad-button":!0}),id:v,style:S,children:y&&(0,a.jsx)(A.y,{className:R("spinner"),position:"center",size:28,spinning:!0},`${v}-spinner`)},v)};var O=r(23193),L=r(1415),B=r(24568),N=r(78825),j=r(1461),M=Object.defineProperty,H=Object.defineProperties,$=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,q=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,G=(e,t)=>{for(var r in t||(t={}))W.call(t,r)&&q(e,r,t[r]);if(F)for(var r of F(t))Z.call(t,r)&&q(e,r,t[r]);return e},z=(e,t)=>H(e,$(t));const U=w().with("google-sticky-adv-banner"),V=({advHidden:e,advLogger:t,blocks:r,canShowDesktopAdv:i,desktopAdvWidth:n,hideAdvCloseButton:l,innerHeight:d,provider:c,refreshCounter:p,stickyBannerLocation:{desktop:v},onAdvShowed:m,onClose:g,wrapperRef:y})=>{const[f,w]=(0,s.useState)(!(0,L.I)()),b=d>=700;(0,s.useEffect)(()=>{const e=e=>{w("enabled"===e.data.action)};return N.Z.onInternalMessage("header",e),()=>{N.Z.offInternalMessage("header",e)}},[]);const k=(0,s.useMemo)(()=>(0,j.C)(),[]),A=(0,s.useMemo)(()=>({marginTop:f&&!l?-k:0,paddingTop:l?0:k,width:n}),[k,n,f,l]),S=(0,s.useMemo)(()=>({marginTop:f?-k:0,width:n}),[k,n,f]),P={advLogger:t,hidden:e||!i,location:v,provider:c,refreshCounter:p,width:n,onAdvShowed:m,onClose:g},I=e||!i;return(0,a.jsxs)("div",{className:U("desktop-wrapper",{hidden:I,"with-disable-ad-button":!0}),style:A,children:[!l&&!I&&(null==y?void 0:y.current)&&(0,h.createPortal)((0,a.jsx)("div",{className:U("desktop-disable-ad-button-wrapper"),style:S,children:(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{})}),y.current),d>=500&&(0,a.jsx)(_,z(G({},P),{block:r.desktop.main,blockType:o.kq.DESKTOP,withSpinner:!0})),b&&(0,a.jsx)(_,z(G({},P),{block:r.desktop.small,blockType:o.kq.DESKTOP_ADDITIONAL,withSpinner:!1}))]})};T.P5.ROW,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var K=r(17936),Y=r(65962),X=r(32574),J=r(79483),Q=r(50678);const ee=(e,t)=>{const r=(0,s.useRef)(!1);(0,s.useEffect)(()=>{!r.current&&t&&(r.current=!0,e())},[t,e])};var te=r(19631),re=r(61916),ae=r(66490),se=r(13949),ie=r(64831),ne=r(20966),oe=r(97731),le=Object.defineProperty,de=Object.defineProperties,ce=Object.getOwnPropertyDescriptors,ue=Object.getOwnPropertySymbols,he=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,ve=(e,t,r)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const me=(0,X.Z)(({advHidden:e,appId:t,blocks:r,canShowDesktopAdv:i,canShowLandscapeAdv:n,canShowPortraitAdv:l,desktopAdvWidth:d,mobileAdvLandscapeHeight:c,mobileAdvSideLandscapeWidth:u,mobileAdvPortraitHeight:h,onClose:p,onAdvShowed:v,hideAdvCloseButton:f,stickyBannerLocation:w,intervalBetweenRefreshAd:b,isLandscapeSide:A,wrapperRef:S})=>{const P=(0,y.C)(e=>e.advGameCanBeLoaded),[I,E]=(0,s.useState)(),[D,R]=(0,s.useState)("object"==typeof window?window.innerHeight:0),x=(0,s.useRef)(null),_=(0,g.D)(e),[O,L]=(0,s.useState)(-1),B=(0,s.useRef)(O),N=(0,s.useRef)(!1),j=(0,s.useRef)(!1),M=(0,s.useMemo)(()=>{const e=(0,re.KT)();return(0,m.Me)(e,m.QQ.SnailTech)?(0,K.WF)():r},[r]);(0,s.useEffect)(()=>{B.current=O},[O]),(0,s.useEffect)(()=>{const e=(0,ae.D)(()=>{R(window.innerHeight)},200);return window.addEventListener("resize",e,!0),()=>{window.removeEventListener("resize",e,!0)}},[]);const H=(0,s.useCallback)(()=>{return e=function*(){try{E(yield(0,Y.l)(J.oO.AdsenseResponsive)),k("Adsense script loaded.")}catch(e){(0,ne.H)({block:oe.W.GOOGLE_ADS,prefix:"AdvStickyBanner error [adsense]:",message:"script failed to load"}),p(),v()}},new Promise((t,r)=>{var a=t=>{try{i(e.next(t))}catch(e){r(e)}},s=t=>{try{i(e.throw(t))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,s);i((e=e.apply(undefined,null)).next())});var e},[p,v]);(0,s.useEffect)(()=>{P&&!I&&H()},[P,I,H]);const $=(0,s.useCallback)(()=>{x.current=new se.U({app_id:t,game_id:t,tag:o.$H.STICKY});const e=-1===B.current;x.current.tryOpen({provider:C.e.Adsense,reason:e?ie.p_.ONSPOT:ie.p_.REFRESH}),N.current=!0,j.current=!1,L(e=>e+1)},[t]),F=(0,s.useCallback)(()=>{j.current=!0,v()},[v]),W=(0,s.useCallback)(e=>{if(j.current)return;let t;switch(e){case T.JK.Landscape:t={onlyLandscape:!0};break;case T.JK.Portrait:t={onlyPortrait:!0}}p(t)},[p]);if(ee($,Boolean(I)),(0,s.useEffect)(()=>{N.current&&_&&!e&&$()},[e,_,$]),(0,s.useEffect)(()=>{},[I,e,w,$]),(0,te.Y)($,!I||e?null:b),!M)return;const Z={advHidden:e,advLogger:x.current,blocks:M,provider:I,refreshCounter:O,stickyBannerLocation:w,onAdvShowed:F,onClose:W};return(0,a.jsx)(V,(q=((e,t)=>{for(var r in t||(t={}))he.call(t,r)&&ve(e,r,t[r]);if(ue)for(var r of ue(t))pe.call(t,r)&&ve(e,r,t[r]);return e})({},Z),de(q,ce({canShowDesktopAdv:i,desktopAdvWidth:d,hideAdvCloseButton:f,innerHeight:D,wrapperRef:S}))));var q},Q.Z,{blocks:e=>{var t;return null==(t=e.allAdvBlocks.adsense)?void 0:t.sticky}}),ge=e=>{const{provider:t,bannerAdvLogger:r,setShowSpinner:a,withSpinner:i,blockType:n,location:o}=e,{refreshCounter:l,placement:c,block:u,retries:h,elementId:p,onClose:v,onAdvShowed:m,withOrientationValidation:g}=e,y=(0,s.useRef)(void 0),f=(0,s.useCallback)(()=>{return e=function*(){if(t&&r){a(i);for(let e=0;e<=h;e++)try{P(`Create slot for ${p}`),0===e&&r.demand({advBlockId:u.blockId,depth:0,provider:C.e.PubliftZone}),y.current=yield t.createSlot({blockId:u.blockId,testId:`sticky-banner-${n}-${o}-${t.providerLoaderName}`,divId:p,usePrevious:!0}),r.request();const s=yield t.preloadSlot({slot:y.current});if(s.isEmpty&&e<h){r.responseEmpty();continue}return s.isEmpty?(r.responseEmpty(),P(`#${p} empty.`),void v(c)):(r.response(),yield t.showSlot(s.slot),r.show(),a(!1),m(),void P(`Creative showed for ${p}`))}catch(e){return P(`Failed to refresh ${p}`,e),void v(c)}}},new Promise((t,r)=>{var a=t=>{try{i(e.next(t))}catch(e){r(e)}},s=t=>{try{i(e.throw(t))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,s);i((e=e.apply(undefined,null)).next())});var e},[u.blockId,n,o,p,r,m,v,c,t,h,a,i]);return(0,s.useEffect)(()=>{!t||!r||l<0||g&&(d.default.isLandscape&&c!==T.JK.Landscape||d.default.isPortrait&&c!==T.JK.Portrait)||f()},[t,r,f,l,c,g]),{refreshSlot:f,slot:y}};var ye=r(4522),fe=r(60617),we=r(27390);const be="adv-publift-sticky-banner-module__banner--aCdL8",ke="adv-publift-sticky-banner-module__spinner--Kw_Vr";var Ae=Object.defineProperty,Se=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,Ie=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,Ce=(e,t,r)=>t in e?Ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const De=w().with("google-sticky-adv-banner"),Re=T.P5.COLUMN,xe=(0,s.memo)((0,X.Z)(({advLogger:e,block:t,blockType:r,hidden:n,location:l=D.rq.RIGHT,withSpinner:d,width:c,provider:u,refreshCounter:h,onAdvShowed:p,onClose:v,flags:m})=>{var g;const y="sticky_banner_"+r+"_"+i().useId(),f=(0,s.useMemo)(()=>null==e?void 0:e.copy({advBlockId:t.blockId}),[e,t.blockId]),[w,b]=(0,s.useState)(d),{slot:k}=ge({provider:u,bannerAdvLogger:f,location:l,block:t,blockType:r,elementId:y,placement:T.JK.Desktop,onAdvShowed:p,onClose:v,setShowSpinner:b,refreshCounter:h,withSpinner:d,retries:null!=(g=(0,fe.$9)(m,we.Z.advPubliftStickyRetries))?g:2}),S=(0,s.useMemo)(()=>r===o.kq.DESKTOP?600:void 0,[r]),P=E({width:c,minHeight:S});I({provider:u,slot:k});const C=t.blockId&&(null==u?void 0:u.loaded)?{"data-fuse":t.blockId}:null;return(0,a.jsx)("div",(R=((e,t)=>{for(var r in t||(t={}))Te.call(t,r)&&Ce(e,r,t[r]);if(Ie)for(var r of Ie(t))Ee.call(t,r)&&Ce(e,r,t[r]);return e})({className:(0,ye.E)(De({desktop:!0,[`desktop_${l}`]:!0,direction:Re,hidden:n,"with-disable-ad-button":!0,publift:!0}),be),id:y,style:P},C),x={children:w&&(0,a.jsx)("div",{className:(0,ye.E)(De("spinner"),ke),children:(0,a.jsx)(A.y,{position:"center",size:28,spinning:!0},`${y}-spinner`)})},Se(R,Pe(x))),y);var R,x},Q.Z,{flags:e=>e.abt.flags}));var _e=Object.defineProperty,Oe=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,Ne=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,Me=(e,t,r)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,He=(e,t)=>{for(var r in t||(t={}))Ne.call(t,r)&&Me(e,r,t[r]);if(Be)for(var r of Be(t))je.call(t,r)&&Me(e,r,t[r]);return e},$e=(e,t)=>Oe(e,Le(t));const Fe=w().with("google-sticky-adv-banner"),We=({advHidden:e,advLogger:t,blocks:r,canShowDesktopAdv:i,desktopAdvWidth:n,hideAdvCloseButton:l,innerHeight:d,provider:c,refreshCounter:p,stickyBannerLocation:{desktop:v},onAdvShowed:m,onClose:g,wrapperRef:y})=>{const[f,w]=(0,s.useState)(!(0,L.I)()),b=d>=700;(0,s.useEffect)(()=>{const e=e=>{w("enabled"===e.data.action)};return N.Z.onInternalMessage("header",e),()=>{N.Z.offInternalMessage("header",e)}},[]);const k=(0,s.useMemo)(()=>(0,j.C)(),[]),A=(0,s.useMemo)(()=>({marginTop:f&&!l?-k:0,paddingTop:l?0:k,width:n}),[k,n,f,l]),S=(0,s.useMemo)(()=>({marginTop:f?-k:0,width:n}),[k,n,f]),P={advLogger:t,hidden:e||!i,location:null!=v?v:D.rq.RIGHT,provider:c,refreshCounter:p,width:n,onAdvShowed:m,onClose:g},I=e||!i;return(0,a.jsxs)("div",{className:Fe("desktop-wrapper",{hidden:I,"with-disable-ad-button":!0}),style:A,children:[!l&&!I&&(null==y?void 0:y.current)&&(0,h.createPortal)((0,a.jsx)("div",{className:Fe("desktop-disable-ad-button-wrapper"),style:S,children:(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{})}),y.current),d>=500&&(0,a.jsx)(xe,$e(He({},P),{block:r.desktop.main,blockType:o.kq.DESKTOP,withSpinner:!0})),b&&(0,a.jsx)(xe,$e(He({},P),{block:r.desktop.small,blockType:o.kq.DESKTOP_ADDITIONAL,withSpinner:!1}))]})};var Ze=Object.defineProperty,qe=Object.defineProperties,Ge=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable,Ke=(e,t,r)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const Ye=T.P5.ROW;(0,s.memo)((0,X.Z)(({advLogger:e,block:t,blockType:r,placement:n,hidden:o,height:l,location:d,provider:c,refreshCounter:u,withSpinner:h,onAdvShowed:p,onClose:v,flags:m})=>{var g;const y="sticky_banner_"+r+"_"+i().useId(),f=(0,s.useMemo)(()=>null==e?void 0:e.copy({advBlockId:t.blockId}),[e,t.blockId]),[w,b]=(0,s.useState)(h),{slot:k}=ge({provider:c,bannerAdvLogger:f,block:t,location:d,blockType:r,elementId:y,placement:n,onAdvShowed:p,onClose:v,setShowSpinner:b,refreshCounter:u,withOrientationValidation:!0,withSpinner:h,retries:null!=(g=(0,fe.$9)(m,we.Z.advPubliftStickyRetries))?g:2}),P=E({height:l});I({provider:c,slot:k});const T=t.blockId&&(null==c?void 0:c.loaded)?{"data-fuse":t.blockId}:null;return(0,a.jsx)("div",(C=((e,t)=>{for(var r in t||(t={}))Ue.call(t,r)&&Ke(e,r,t[r]);if(ze)for(var r of ze(t))Ve.call(t,r)&&Ke(e,r,t[r]);return e})({className:(0,ye.E)(S({[n]:!0,[`${n}_${d}`]:!0,direction:Ye,border_round:!0,hidden:o}),be),id:y,style:P},T),D={children:(0,a.jsx)("div",{className:(0,ye.E)(S("spinner",{hidden:!w}),ke),children:(0,a.jsx)(A.y,{position:"center",size:28,spinning:!0},`${y}-spinner`)})},qe(C,Ge(D))),y);var C,D},Q.Z,{flags:e=>e.abt.flags})),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Xe=r(76476),Je=Object.defineProperty,Qe=Object.defineProperties,et=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,st=(e,t,r)=>t in e?Je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const it=(0,X.Z)(({advHidden:e,appId:t,blocks:r,canShowDesktopAdv:i,canShowLandscapeAdv:n,canShowPortraitAdv:l,desktopAdvWidth:d,mobileAdvLandscapeHeight:c,mobileAdvSideLandscapeWidth:u,mobileAdvPortraitHeight:h,onClose:p,onAdvShowed:v,hideAdvCloseButton:m,stickyBannerLocation:f,intervalBetweenRefreshAd:w,isLandscapeSide:b,wrapperRef:k})=>{const A=(0,y.C)(e=>e.advGameCanBeLoaded),[S,I]=(0,s.useState)(),[E,D]=(0,s.useState)("object"==typeof window?window.innerHeight:0),R=(0,s.useRef)(null),x=(0,g.D)(e),[_,O]=(0,s.useState)(-1),L=(0,s.useRef)(_),B=(0,s.useRef)(!1),N=(0,s.useRef)(!1);(0,s.useEffect)(()=>{L.current=_},[_]),(0,s.useEffect)(()=>{const e=(0,ae.D)(()=>{D(window.innerHeight)},200);return window.addEventListener("resize",e,!0),()=>{window.removeEventListener("resize",e,!0)}},[]);const j=(0,s.useCallback)(()=>{return e=function*(){try{const e=yield(0,Y.l)(J.oO.PubliftZone,Xe.CX);I(e),P("Publift script loaded.")}catch(e){(0,ne.H)({block:oe.W.GOOGLE_ADS,prefix:"AdvStickyBanner error [publift]:",message:"script failed to load"},e),p(),v()}},new Promise((t,r)=>{var a=t=>{try{i(e.next(t))}catch(e){r(e)}},s=t=>{try{i(e.throw(t))}catch(e){r(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,s);i((e=e.apply(undefined,null)).next())});var e},[p,v]);(0,s.useEffect)(()=>{A&&!S&&j()},[A,S,j]);const M=(0,s.useCallback)(()=>{R.current=new se.U({app_id:t,game_id:t,tag:o.$H.STICKY});const e=-1===L.current;R.current.tryOpen({provider:C.e.PubliftZone,reason:e?ie.p_.ONSPOT:ie.p_.REFRESH}),B.current=!0,N.current=!1,O(e=>e+1)},[t]),H=(0,s.useCallback)(()=>{N.current=!0,v()},[v]),$=(0,s.useCallback)(e=>{var t;if(N.current)return;let r;switch(e){case T.JK.Landscape:r={onlyLandscape:!0};break;case T.JK.Portrait:r={onlyPortrait:!0}}null==(t=R.current)||t.close(),p(r)},[p]);if(ee(M,Boolean(S)),(0,s.useEffect)(()=>{B.current&&x&&!e&&M()},[e,x,M]),(0,s.useEffect)(()=>{},[S,e,f,M]),(0,te.Y)(M,!S||e?null:w),!r)return;const F={advHidden:e,advLogger:R.current,blocks:r,provider:S,refreshCounter:_,stickyBannerLocation:f,onAdvShowed:H,onClose:$};return(0,a.jsx)(We,(W=((e,t)=>{for(var r in t||(t={}))rt.call(t,r)&&st(e,r,t[r]);if(tt)for(var r of tt(t))at.call(t,r)&&st(e,r,t[r]);return e})({},F),Qe(W,et({canShowDesktopAdv:i,desktopAdvWidth:d,hideAdvCloseButton:m,innerHeight:E,wrapperRef:k}))));var W},Q.Z,{blocks:e=>{var t;return null==(t=e.allAdvBlocks.publift)?void 0:t.sticky}});var nt=r(96533);const ot={container:"sticky-adv-container-critical-module__container--XgGt1",containerHidden:"sticky-adv-container-critical-module__containerHidden--xNKe2",containerWhiteBg:"sticky-adv-container-critical-module__containerWhiteBg--glGA_",locationRight:"sticky-adv-container-critical-module__locationRight--lfPS1",locationBottom:"sticky-adv-container-critical-module__locationBottom--DUFro",headerEnabled:"sticky-adv-container-critical-module__headerEnabled--sK6Mk",banner:"sticky-adv-container-critical-module__banner--zIVS6",placementVertical:"sticky-adv-container-critical-module__placementVertical--_yL1R",placementPortrait:"sticky-adv-container-critical-module__placementPortrait--scwGu",placementSide:"sticky-adv-container-critical-module__placementSide--gZtFt",bannerLink:"sticky-adv-container-critical-module__bannerLink--_IZpm",spinner:"sticky-adv-container-critical-module__spinner--Nch4a"};var lt=r(61283);const dt=({advLogger:e,onResponsePost:t,onFailed:r,refreshCounter:a})=>{const i=(0,s.useMemo)(()=>({}),[e]),n=(0,s.useCallback)(t=>{let r=i[t];return r||(r=e.copy({blockType:t}),i[t]=r),r},[e,i]),o=(0,s.useCallback)((e,t,{payloadBlockType:r})=>{t?n(r).waterfall({advBlockId:(0,J.Qq)(e)?e.blockId:"",provider:e.provider,depth:0,reason:ie.p_.WATERFALL}):(n(r).tryOpen({provider:e.provider,reason:a>0?ie.p_.REFRESH:ie.p_.ONSPOT}),n(r).demand({advBlockId:(0,J.Qq)(e)?e.blockId:"unknown"}))},[n,a]),l=(0,s.useCallback)((e,{payloadBlockType:t})=>{n(t).request()},[n]),d=(0,s.useCallback)(({isEmpty:e},r)=>{const{payloadBlockType:a,payloadProductType:s}=r;e?n(a).responseEmpty():n(a).response({productType:s}),null==t||t({isEmpty:e},r)},[n,t]),c=(0,s.useCallback)((e,{payloadBlockType:t})=>{n(t).show()},[n]),u=(0,s.useCallback)((e,{payloadBlockType:t})=>{n(t).click()},[n]);return{onError:(0,s.useCallback)(({error:e},{payloadBlockType:t})=>{e instanceof lt.lu&&e.params.isEmpty||n(t).error(e.message)},[n]),onRequest:l,onResponse:d,onShow:c,onClick:u,onSkip:(0,s.useCallback)(({reason:e},{payloadBlockType:t})=>{n(t).skip(e)},[n]),onWaterfallNext:o,onWaterfallFailed:(0,s.useCallback)((e,{payloadBlockType:t,payloadPlacement:a})=>{null==r||r(a,t),(0,K._y)(`StickyAdv | ${t} | WaterfallFailed`,e)},[r])}};var ct=r(74495);const ut=()=>(0,ct.HX)().stickyAdv,ht=K._y.tag("StickyAdv");var pt=r(30707),vt=r(33376);const mt=(0,b.M$)("AdvStickyBanner",b.XG.Adv);function gt(e,t){const r=(0,fe.QR)(t,we.Z.prebidDisabledBids);return(0,vt.GI)(r)&&e.forEach(e=>{e.bids=e.bids.filter(({bidder:e})=>!r.includes(e))}),e}const yt=new Set,ft=({blockType:e,flags:t,sizes:r,waterfallItem:a})=>{if(!("blockId"in a))return;const{blockId:s}=a;if(yt.has(s))return;yt.add(s);const i=(({blockId:e,blockType:t,flags:r,sizes:a})=>gt([(()=>{switch(t){case o.kq.DESKTOP:return((e,t)=>{var r,a,s,i;return{code:e,mediaTypes:{banner:{sizes:t}},bids:null!=(i=null==(s=null==(a=null==(r=(0,ct.HX)().stickyAdv)?void 0:r.prebid)?void 0:a.bidders)?void 0:s.desktop)?i:[]}})(e,a);case o.kq.DESKTOP_ADDITIONAL:return((e,t)=>{var r,a,s,i;return{code:e,mediaTypes:{banner:{sizes:t}},bids:null!=(i=null==(s=null==(a=null==(r=(0,ct.HX)().stickyAdv)?void 0:r.prebid)?void 0:a.bidders)?void 0:s.desktop_additional)?i:[]}})(e,a);case o.kq.PORTRAIT:return{code:e,mediaTypes:{banner:{sizes:[[320,50]]}},bids:null!=(n=null==(i=null==(s=null==(r=(0,ct.HX)().stickyAdv)?void 0:r.prebid)?void 0:s.bidders)?void 0:i.portrait)?n:[]};case o.kq.PORTRAIT_HIGH:return(e=>{var t,r,a;return{code:e,mediaTypes:{banner:{sizes:[[320,100]]}},bids:null!=(a=null==(r=null==(t=(0,ct.HX)().stickyAdv)?void 0:t.prebid)?void 0:r.bidders.portrait_high)?a:[]}})(e);case o.kq.LANDSCAPE:case o.kq.LANDSCAPE_SIDE:case o.kq.LANDSCAPE_ADDITIONAL:case o.kq.LANDSCAPE_TABLET_ADDITIONAL:return(e=>{var t,r,a,s;return{code:e,mediaTypes:{banner:{sizes:[[320,50]]}},bids:null!=(s=null==(a=null==(r=null==(t=(0,ct.HX)().stickyAdv)?void 0:t.prebid)?void 0:r.bidders)?void 0:a.landscape)?s:[]}})(e);default:throw new Error(`Unknown blockType: ${t}`)}var r,s,i,n})()],r)[0])({flags:t,blockId:s,blockType:e,sizes:r});(0,pt.BA)(e=>{e.addAdUnits(i),ht.tag("Prebid")(`Added ${i.bids.length} bidders for unit ${s}`)})};var wt=r(4545),bt=r(34647);const kt="utm_source=sticky_promo",At=e=>{const{basePath:t,adv:{sticky:{promo:r}}}=(0,wt.getDomainConfig)(),a=t||"/";return(null==r?void 0:r.redirectTagId)?`${((...e)=>e.join("/").replace(/\/+/g,"/"))(a,(0,bt.Cx)(e,{tagId:r.redirectTagId}))}?${kt}`:`${a}?${kt}`};var St=r(77314),Pt=r(43770),It=r(70516),Tt=r(28250),Et=Object.defineProperty,Ct=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable,xt=(e,t,r)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_t=(e,t)=>{for(var r in t||(t={}))Dt.call(t,r)&&xt(e,r,t[r]);if(Ct)for(var r of Ct(t))Rt.call(t,r)&&xt(e,r,t[r]);return e};const Ot=[J.oO.GoogleBlock],Lt=(0,s.forwardRef)(({appId:e,blockType:t,flags:r,location:n,maxHeight:l,withSpinner:d=!1,provider:c,stickyLocation:u,waterfallItem:h,onClick:p,onError:v,onRequest:m,onResponse:g,onShow:y,onSkip:f,onFailed:w},b)=>{const k="sticky_banner_"+t+"_"+i().useId(),S=(0,s.useRef)(null),P=(0,s.useRef)(null),[I,T]=(0,s.useState)(!1),[E,C]=(0,s.useState)(d),D=(0,s.useMemo)(()=>(0,fe.ff)(r),[r]),[R,x]=(0,s.useState)(null),_=(0,St.b)();return(0,s.useEffect)(()=>{let a=null;var s;return s=function*(){var s,i,l,d,b,A;if(h&&(0,J.Qq)(h)&&c&&S.current&&P.current)try{if((0,ct.y)(h)&&t===o.kq.DESKTOP_ADDITIONAL&&(null!=(s=P.current.clientHeight)?s:0)<50)return void(null==f||f({reason:o.Jm.NOT_ENOUGH_CONTAINER_SIZE,slot:a}));(0,K._y)("Sticky | Actualy create slot",k,h,P,S.current.clientHeight,S.current.clientWidth),T(!1),x(null);const v=(0,ct._)(h)?(0,It.TG)({sizes:h.sizes,maxAdvWidth:null!=(l=null==(i=S.current.parentElement)?void 0:i.clientWidth)?l:window.innerWidth,maxAdvHeight:null!=(b=null==(d=S.current.parentElement)?void 0:d.clientHeight)?b:window.innerHeight}):[];if((0,ct._)(h)&&(0,pt.z4)(o.$H.STICKY)&&ft({blockType:t,flags:r,sizes:v,waterfallItem:h}),a=yield c.createSlot(_t(_t({appId:e,blockId:h.blockId,divId:k,disableRefresh:!0,location:n,testId:`sticky-banner-${t}-${u}-${c.providerLoaderName}`,withPageNumber:!1},(0,ct._)(h)?{size:v,usePrevious:!0,usePrebid:(0,pt.z4)(o.$H.STICKY),prebidTimeout:(0,pt.cm)(r)}:{size:[]}),(0,ct.dD)(h)?{promoSize:h.promoSize,variant:h.variant}:void 0)),!a)return;let w=0,I=!0;const E=Ot.includes(c.providerName)?D:0;do{null==m||m({slot:a});const e=yield c.preloadSlot({slot:a,flags:r}),{isEmpty:t}=e;if(null==g||g({slot:a,isEmpty:t},{payloadProductType:"productType"in e?null!=(A=e.productType)?A:"none":"unknown"}),!1===t){I=!1,"render"in e&&e.render&&x(e.render);break}if(!E)break;yield(0,Tt.D)(Pt.TE),w+=1}while(I&&w<=E);if(I)throw new lt.lu("Slot is empty",{isEmpty:!0});C(()=>!1),T(!0),yield c.showSlot(a),null==y||y({slot:a}),c.setClickEventListener(a,()=>null==p?void 0:p({slot:a}))}catch(e){null==v||v({error:e,slot:a}),null==w||w({error:e})}},new Promise((e,t)=>{var r=e=>{try{i(s.next(e))}catch(e){t(e)}},a=e=>{try{i(s.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,a);i((s=s.apply(undefined,null)).next())}),()=>{(0,K._y)("Sticky | Renderer clear",k),a&&c&&c.destroySlot(a)}},[e,p,t,k,r,D,v,m,g,y,f,w,n,c,u,h]),(0,a.jsxs)("div",{className:ot.banner,"data-testid":"sticky-banner-"+t,ref:P,style:{maxHeight:!I&&l?l+"px":void 0},children:[E&&(0,a.jsx)("div",{className:ot.spinner,children:(0,a.jsx)(A.y,{position:"center",size:28,spinning:!0})}),!R&&(0,a.jsx)("div",{id:k,ref:S}),R&&((null==c?void 0:c.providerName)===J.oO.PromoBlock?(0,a.jsx)("a",{className:ot.bannerLink,href:At(_),target:"_blank",children:R}):R)]})}),Bt=(0,X.Z)(Lt,Q.Z,{appId:e=>e.playPageData.gameInfo.appId,flags:e=>e.abt.flags,location:e=>e.location});var Nt=r(18216),jt=r(21798),Mt=r(31130),Ht=Object.defineProperty,$t=Object.defineProperties,Ft=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable,Gt=(e,t,r)=>t in e?Ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,zt=(e,t)=>{for(var r in t||(t={}))Zt.call(t,r)&&Gt(e,r,t[r]);if(Wt)for(var r of Wt(t))qt.call(t,r)&&Gt(e,r,t[r]);return e},Ut=(e,t)=>$t(e,Ft(t));const Vt=(0,s.memo)((0,X.Z)(({advLogger:e,flags:t,isVisible:r,refreshCounter:i,showDisableAdButton:n,onFailed:l})=>{var d;const c=ut(),[h,p]=(0,s.useState)(!(0,L.I)()),[v,m]=(0,s.useState)("object"==typeof window?window.innerHeight:0),[g,f]=(0,s.useState)(!1),w=(0,s.useRef)(-1),b=(0,s.useMemo)(()=>{var e,t,r,a;return i<0||!c?{[o.kq.DESKTOP]:[],[o.kq.DESKTOP_ADDITIONAL]:[]}:{[o.kq.DESKTOP]:[...null!=(t=null==(e=c.blocks[o.kq.DESKTOP])?void 0:e.waterfall)?t:[]],[o.kq.DESKTOP_ADDITIONAL]:[...null!=(a=null==(r=c.blocks[o.kq.DESKTOP_ADDITIONAL])?void 0:r.waterfall)?a:[]]}},[i,c]),k=(0,y.C)(e=>e.middleLayerInGameData),A=(0,y.C)(nt.Up);(0,s.useEffect)(()=>(f(!1),()=>{clearTimeout(w.current)}),[b]);const S=(0,s.useCallback)((e,{payloadProductType:t})=>{(0,K._y)(`Sticky | Received ${t} pcode banner.`),T.U_.includes(t)||(w.current=window.setTimeout(()=>f(!0),200))},[]),P=((e,t)=>(0,s.useMemo)(()=>{let r=T.q5;!(0,u.v_)({on:"new_game_navigation"})&&(0,Nt.ZQ)(e,J.oO.AdsenseResponsive)&&(r=Math.max(r,Mt.K));const a=(0,fe.$9)(t,we.Z.advStickyBannerDesktopWidth);return a&&(r=a),Math.floor(Math.min(Math.max(r,T.Ic),T.q5))},[t,e]))(b.desktop,t);(0,s.useEffect)(()=>{const e=e=>{p("enabled"===e.data.action)},t=(0,ae.D)(()=>{m(window.innerHeight)},200);return N.Z.onInternalMessage("header",e),window.addEventListener("resize",t,!0),()=>{N.Z.offInternalMessage("header",e),window.removeEventListener("resize",t,!0)}},[]);const I=dt({advLogger:e,refreshCounter:i,onResponsePost:S,onFailed:l}),E=!(0,Nt.ZQ)(b[o.kq.DESKTOP_ADDITIONAL],J.oO.GoogleBlock)||v>=700,C=(0,s.useMemo)(()=>n?(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{}):null,[n]);return(0,a.jsxs)("div",{className:(0,ye.E)(ot.container,ot.locationRight,r?"":ot.containerHidden,h&&n?ot.headerEnabled:"",(null==k?void 0:k.show)&&!A?ot.containerWhiteBg:""),style:{width:P},children:[C,v>=500&&(null==c?void 0:c.blocks[o.kq.DESKTOP])&&(0,a.jsx)(jt.Z,Ut(zt({alwaysRender:!0,payloadBlockType:o.kq.DESKTOP,payloadPlacement:T.JK.Desktop,waterfallList:b[o.kq.DESKTOP]},I),{children:(0,a.jsx)(Bt,{blockType:o.kq.DESKTOP,maxHeight:(null==(d=b[o.kq.DESKTOP][0])?void 0:d.provider)!==J.oO.YandexBlock?600:void 0,stickyLocation:D.Xn.RIGHT,withSpinner:!0})})),E&&g&&(null==c?void 0:c.blocks[o.kq.DESKTOP_ADDITIONAL])&&(0,a.jsx)(jt.Z,Ut(zt({alwaysRender:!0,payloadBlockType:o.kq.DESKTOP_ADDITIONAL,payloadPlacement:T.JK.Desktop,waterfallList:b[o.kq.DESKTOP_ADDITIONAL]},I),{children:(0,a.jsx)(Bt,{blockType:o.kq.DESKTOP_ADDITIONAL,stickyLocation:D.Xn.RIGHT})}))]})},Q.Z,{flags:e=>e.abt.flags,showDisableAdButton:e=>!e.isDistGame&&!e.hidePaymentsAndCurrency}));var Kt=Object.defineProperty,Yt=Object.defineProperties,Xt=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,Qt=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable,tr=(e,t,r)=>t in e?Kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rr=(e,t)=>{for(var r in t||(t={}))Qt.call(t,r)&&tr(e,r,t[r]);if(Jt)for(var r of Jt(t))er.call(t,r)&&tr(e,r,t[r]);return e};const ar=(0,s.memo)((0,X.Z)(({advLogger:e,refreshCounter:t,flags:r,isVisible:i,onFailed:n})=>{const l=ut(),c=(0,s.useMemo)(()=>{var e,r;return t<0||!i?[]:d.default.type.includes(T.JK.Landscape)?[...null!=(r=null==(e=null==l?void 0:l.blocks.landscape_side)?void 0:e.waterfall)?r:[]]:[]},[i,l,t]),u=(0,s.useMemo)(()=>(0,fe.$9)(r,we.Z.advStickyBannerLandscapeWidth)||T.HZ,[r]),h=dt({advLogger:e,refreshCounter:t,onFailed:n});return(0,a.jsx)("div",{className:(0,ye.E)(ot.container,ot.placementSide,ot.locationRight,i?"":ot.containerHidden),style:{width:u},children:(0,a.jsx)(jt.Z,(p=rr({alwaysRender:!0,payloadBlockType:o.kq.LANDSCAPE_SIDE,payloadPlacement:T.JK.Landscape,waterfallList:c},h),v={children:(0,a.jsx)(Bt,{blockType:o.kq.LANDSCAPE_SIDE,stickyLocation:D.Xn.RIGHT,withSpinner:!0})},Yt(p,Xt(v))))});var p,v},Q.Z,{flags:e=>e.abt.flags}));var sr=Object.defineProperty,ir=Object.defineProperties,nr=Object.getOwnPropertyDescriptors,or=Object.getOwnPropertySymbols,lr=Object.prototype.hasOwnProperty,dr=Object.prototype.propertyIsEnumerable,cr=(e,t,r)=>t in e?sr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ur=(e,t)=>{for(var r in t||(t={}))lr.call(t,r)&&cr(e,r,t[r]);if(or)for(var r of or(t))dr.call(t,r)&&cr(e,r,t[r]);return e},hr=(e,t)=>ir(e,nr(t));const pr={landscape:[],landscape_additional:[],landscape_tablet_additional:[]},vr=(0,s.memo)((0,X.Z)(({advLogger:e,refreshCounter:t,flags:r,isVisible:i,onFailed:n})=>{const l=ut(),[c,u]=(0,s.useState)(!0),[h,p]=(0,s.useState)(!1),v=(0,s.useRef)(-1),m="undefined"!=typeof window&&Math.max(window.innerWidth,window.innerHeight)>=T.kO,g=(0,s.useMemo)(()=>{var e,r,a,s,n,o;return t<0||!i||!l?pr:d.default.type.includes(T.JK.Landscape)?{landscape:[...null!=(r=null==(e=l.blocks.landscape)?void 0:e.waterfall)?r:[]],landscape_additional:[...null!=(s=null==(a=l.blocks.landscape_additional)?void 0:a.waterfall)?s:[]],landscape_tablet_additional:[...null!=(o=null==(n=l.blocks.landscape_tablet_additional)?void 0:n.waterfall)?o:[]]}:pr},[i,t,l]),y=(0,s.useMemo)(()=>(0,j.C)(),[]),f=(0,s.useMemo)(()=>(0,fe.$9)(r,we.Z.advStickyBannerLandscapeHeight)||T.qi,[r]),w=(0,s.useCallback)((e,{payloadProductType:t})=>{if(u(!1),(0,K._y)(`Sticky | Received ${t} pcode banner.`),t){if(T.iv.includes(t))return;v.current=window.setTimeout(()=>p(!0),T.fE)}},[]);(0,s.useEffect)(()=>()=>{clearTimeout(v.current)},[]);const b=dt({advLogger:e,refreshCounter:t,onResponsePost:w,onFailed:n}),k=null==l?void 0:l.placements.mobileLandscape.includes(D.Xn.UPPER);return(0,a.jsxs)("div",{className:(0,ye.E)(ot.container,ot.placementVertical,(null==l?void 0:l.placements.mobileLandscape.includes(D.Xn.UPPER))?ot.locationUpper:ot.locationBottom,i?"":ot.containerHidden),style:{height:f,left:-y,minWidth:`calc(100% + ${y}px)`},children:[c&&(0,a.jsx)(A.y,{position:"center",size:28,spinning:!0},"landscape-spinner"),(0,a.jsx)(jt.Z,hr(ur({alwaysRender:!0,payloadBlockType:o.kq.LANDSCAPE,payloadPlacement:T.JK.Landscape,waterfallList:g[o.kq.LANDSCAPE]},b),{children:(0,a.jsx)(Bt,{blockType:o.kq.LANDSCAPE,stickyLocation:k?D.Xn.UPPER:D.Xn.BOTTOM,withSpinner:!0})})),(null==l?void 0:l.blocks.landscape_additional)&&h&&(0,a.jsxs)(a.Fragment,{children:[m&&(0,a.jsx)(jt.Z,hr(ur({alwaysRender:!0,payloadBlockType:o.kq.LANDSCAPE_TABLET_ADDITIONAL,payloadPlacement:T.JK.Landscape,waterfallList:g[o.kq.LANDSCAPE_TABLET_ADDITIONAL]},b),{children:(0,a.jsx)(Bt,{blockType:o.kq.LANDSCAPE_TABLET_ADDITIONAL,stickyLocation:k?D.Xn.UPPER:D.Xn.BOTTOM,withSpinner:!0})})),(0,a.jsx)(jt.Z,hr(ur({alwaysRender:!0,payloadBlockType:o.kq.LANDSCAPE_ADDITIONAL,payloadPlacement:T.JK.Landscape,waterfallList:g[o.kq.LANDSCAPE_ADDITIONAL]},b),{children:(0,a.jsx)(Bt,{blockType:o.kq.LANDSCAPE_ADDITIONAL,stickyLocation:k?D.Xn.UPPER:D.Xn.BOTTOM,withSpinner:!0})}))]})]})},Q.Z,{flags:e=>e.abt.flags}));var mr=r(19694),gr=Object.defineProperty,yr=Object.defineProperties,fr=Object.getOwnPropertyDescriptors,wr=Object.getOwnPropertySymbols,br=Object.prototype.hasOwnProperty,kr=Object.prototype.propertyIsEnumerable,Ar=(e,t,r)=>t in e?gr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Sr=(e,t)=>{for(var r in t||(t={}))br.call(t,r)&&Ar(e,r,t[r]);if(wr)for(var r of wr(t))kr.call(t,r)&&Ar(e,r,t[r]);return e};const Pr=(0,s.memo)((0,X.Z)(({advLogger:e,refreshCounter:t,flags:r,isVisible:i,onFailed:n})=>{const l=ut(),c=(0,y.C)(mr.yD),u=(0,s.useMemo)(()=>{var e,t,a,s,i;const n=(0,fe.$9)(r,we.Z.advStickyBannerPortraitHeight);if(n)return n;const o=null!=(e=(0,fe.$9)(r,we.Z.advStickyBannerMinHeightForHigherAd))?e:T.Gh;return(c?Math.max(window.screen.height,window.screen.width):Math.max(window.innerHeight,window.innerWidth))>=o?null!=(a=null==(t=null==l?void 0:l.blocks.portrait_high)?void 0:t.height)?a:T.RH:null!=(i=null==(s=null==l?void 0:l.blocks.portrait)?void 0:s.height)?i:T.qi},[r,c,null==l?void 0:l.blocks]),h=u===T.RH?o.kq.PORTRAIT_HIGH:o.kq.PORTRAIT,p=(0,s.useMemo)(()=>{var e,r;return t<0||!i?[]:d.default.type.includes(T.JK.Portrait)?[...null!=(r=null==(e=null==l?void 0:l.blocks[h])?void 0:e.waterfall)?r:[]]:[]},[h,i,l,t]),v=dt({advLogger:e,refreshCounter:t,onFailed:n}),m=null==l?void 0:l.placements.mobilePortrait.includes(D.Xn.UPPER);return(0,a.jsx)("div",{className:(0,ye.E)(ot.container,ot.placementPortrait,m?ot.locationUpper:ot.locationBottom,i?"":ot.containerHidden),style:{height:u},children:(null==l?void 0:l.blocks[h])&&(0,a.jsx)(jt.Z,(g=Sr({alwaysRender:!0,payloadBlockType:h,payloadPlacement:T.JK.Portrait,waterfallList:p},v),f={children:(0,a.jsx)(Bt,{blockType:h,stickyLocation:m?D.Xn.UPPER:D.Xn.BOTTOM,withSpinner:!0})},yr(g,fr(f))))});var g,f},Q.Z,{flags:e=>e.abt.flags}));var Ir=Object.defineProperty,Tr=Object.defineProperties,Er=Object.getOwnPropertyDescriptors,Cr=Object.getOwnPropertySymbols,Dr=Object.prototype.hasOwnProperty,Rr=Object.prototype.propertyIsEnumerable,xr=(e,t,r)=>t in e?Ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_r=(e,t)=>{for(var r in t||(t={}))Dr.call(t,r)&&xr(e,r,t[r]);if(Cr)for(var r of Cr(t))Rr.call(t,r)&&xr(e,r,t[r]);return e},Or=(e,t)=>Tr(e,Er(t));const Lr=(0,s.memo)((0,X.Z)(({advHidden:e,appId:t,canShowDesktopAdv:r,canShowLandscapeAdv:i,canShowPortraitAdv:n,onClose:l,onAdvShowed:d})=>{const c=(0,y.C)(e=>e.advGameCanBeLoaded),u=ut(),[h,p]=(0,s.useState)(-1),v=(0,g.D)(e),m=(0,s.useRef)(h),f=(0,s.useRef)(!1),w=(0,s.useRef)(!1),b=(0,s.useMemo)(()=>new se.U({app_id:t,game_id:t,tag:o.$H.STICKY,refresh_count:h}),[t,h]);(0,s.useEffect)(()=>{m.current=h},[h]);const k=(0,s.useCallback)(()=>{p(e=>e+1),f.current=!0},[]),A=(0,s.useCallback)(()=>{w.current=!0,d()},[d]),S=(0,s.useCallback)((e,t)=>{if(w.current)return;if(t===o.kq.DESKTOP_ADDITIONAL)return;let r;switch(e){case T.JK.Landscape:r={onlyLandscape:!0};break;case T.JK.Portrait:r={onlyPortrait:!0}}b.close(),l(r)},[b,l]);if(ee(k,c&&!e),(0,s.useEffect)(()=>{f.current&&c&&v&&!e&&k()},[c,e,v,k]),(0,s.useEffect)(()=>{},[c,e,u,k]),(0,te.Y)(k,c&&!e&&(null==u?void 0:u.refreshInterval)||null),!u)return null;const P={advHidden:e,advLogger:b,refreshCounter:h,onAdvShowed:A,onFailed:S};return(0,a.jsxs)(a.Fragment,{children:[u.blocks.desktop&&(0,a.jsx)(Vt,Or(_r({},P),{isVisible:!e&&r})),u.blocks.portrait&&(0,a.jsx)(Pr,Or(_r({},P),{isVisible:!e&&n})),u.blocks.landscape&&(0,a.jsx)(vr,Or(_r({},P),{isVisible:!e&&i})),u.blocks.landscape_side&&(0,a.jsx)(ar,Or(_r({},P),{isVisible:!e&&i}))]})},Q.Z,{appId:e=>e.playPageData.gameInfo.appId}));var Br=r(62036),Nr=r(69278),jr=r(48903),Mr=r(4328),Hr=r(22854),$r=r(84910),Fr=r(27637),Wr=r(23202),Zr=r(61712),qr=r(2592),Gr=r(99251),zr=Object.defineProperty,Ur=Object.defineProperties,Vr=Object.getOwnPropertyDescriptors,Kr=Object.getOwnPropertySymbols,Yr=Object.prototype.hasOwnProperty,Xr=Object.prototype.propertyIsEnumerable,Jr=(e,t,r)=>t in e?zr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Qr=(e,t)=>{for(var r in t||(t={}))Yr.call(t,r)&&Jr(e,r,t[r]);if(Kr)for(var r of Kr(t))Xr.call(t,r)&&Jr(e,r,t[r]);return e},ea=(e,t)=>Ur(e,Vr(t)),ta=(e,t,r)=>(Jr(e,"symbol"!=typeof t?t+"":t,r),r),ra=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const aa=w().with("google-sticky-adv-banner"),sa=(0,b.M$)("GoogleStickyAdvBanner",b.XG.Adv),ia="AdvStickyBanner error [google]:",na="google-adv-sticky-banner-",oa=2*qr.WT;function la(e,t){if(e.mediaSizes)for(const r of e.mediaSizes)if(window.innerHeight-t<=r.maxHeight)return r.sizes;return e.sizes}function da(e,t){(0,Zr.U4)({},{borrowParams:{adv:{sticky:{[e]:t}}}})}class ca extends Q.P{constructor(){super(...arguments),ta(this,"clickDaemon"),ta(this,"isAdditionalTabletLandscapeBlockEnabled",!1),ta(this,"allStickyGoogleAdvBlocks",this.context.allAdvBlocks.google.sticky),ta(this,"blockIds"),ta(this,"usePrebid",(0,pt.z4)(o.$H.STICKY)),ta(this,"prebidAdUnits",(({flags:e,stickyBlocks:t})=>{let r=(e=>{var t,r,a,s,i,n,o,l;return[{code:e.main.blockId,mediaTypes:{banner:{sizes:e.main.sizes}},bids:null!=(s=null==(a=null==(r=null==(t=(0,ct.HX)().stickyAdv)?void 0:t.prebid)?void 0:r.bidders)?void 0:a.desktop)?s:[]},{code:e.small.blockId,mediaTypes:{banner:{sizes:e.small.sizes}},bids:null!=(l=null==(o=null==(n=null==(i=(0,ct.HX)().stickyAdv)?void 0:i.prebid)?void 0:n.bidders)?void 0:o.desktop_additional)?l:[]}]})({desktop:t.desktop,landscape:t.landscape,portrait:t.portrait,portrait_high:t.portrait_high}.desktop);return r=gt(r,e),mt("getPrebidStickyAdUnits result",r),r})({stickyBlocks:this.allStickyGoogleAdvBlocks,flags:this.context.abt.flags})),ta(this,"isThreeDesktopBannersExpEnabled",(0,u.v_)({on:"adv_three_desktop_google_sticky_banners"})),ta(this,"prebidAuctionTimeout"),ta(this,"waitForAuction",null),ta(this,"retries",(0,fe.ff)(this.context.abt.flags)),ta(this,"isScriptsLoaded"),ta(this,"hasBeenShownAtLeastOnce",!1),ta(this,"slots",{desktop:{},landscape:{},portrait:{}}),ta(this,"refreshTimer"),ta(this,"desktopAdvMinHeight"),ta(this,"timeToLoadAdv",(0,T.Qt)(this.context.abt.flags)),ta(this,"headerHeight",(0,j.C)()),ta(this,"landscapeStyles",Qr({},this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:`${this.props.mobileAdvLandscapeHeight}px`,left:-this.headerHeight,minWidth:`calc(100% + ${this.headerHeight}px)`})),ta(this,"state",{isMounted:!1,isHeaderEnabled:!(0,L.I)(),showLandscapeSpinner:!0,showSpinner:!0,windowInnerHeight:"object"==typeof window?window.innerHeight:0}),ta(this,"isFirstTryOpen",!0),ta(this,"onShow",e=>{const{slot:t}=e,{stickyPlacement:r,clickDaemon:a}=t;r&&(null==a||a.show())}),ta(this,"onSlotRenderEnded",e=>{const{slot:t}=e,{clickDaemon:r,stickyPlacement:a,stickyBlockType:s,stickyLocation:i}=t,n=this.getSlotObject(a,s);if(n){if(sa.spoiler(t.getAdUnitPath())("onSlotRenderEnded",s,`isEmpty = ${e.isEmpty}`,`isBackfill = ${e.isBackfill}`,"size :",e.size),clearTimeout(n.loadTimer),this.resetRefreshTimer(),e.isEmpty)return null==r||r.responseEmpty(),void this.onNoContent(t);null==r||r.response(),n.retries&&(n.retries=0),this.hasBeenShownAtLeastOnce=!0,(0,$r.o)(t,`sticky-banner-${a}-${i}-${C.e.Google}`)}}),ta(this,"resetRefreshTimer",()=>{sa("Reset refresh timer",Date.now()),this.refreshTimer||da("startRefreshTimer",!0),clearTimeout(this.refreshTimer),this.refreshTimer=setTimeout(()=>{sa.spoiler("refresh timer executed"),da("refreshTimerEnded",!0),clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.displaySlotsBatched(!0)},this.props.intervalBetweenRefreshAd)}),ta(this,"onSlotLoaded",({slot:e})=>{const{stickyPlacement:t,stickyBlockType:r}=e,a=this.getSlotObject(t,r);if(a)switch(sa.spoiler(e.getAdUnitPath())("onSlotLoaded",r),a.loaded=!0,clearTimeout(a.loadTimer),t){case T.JK.Desktop:this.setState({showSpinner:!1});break;case T.JK.Landscape:this.setState({showLandscapeSpinner:!1});break;case T.JK.Portrait:this.setState({showSpinner:!1})}}),ta(this,"onSlotRequested",({slot:e})=>{const{stickyPlacement:t,stickyBlockType:r,clickDaemon:a}=e,s=this.getSlotObject(t,r);s&&(sa.spoiler(e.getAdUnitPath())("onSlotRequested",r),clearTimeout(s.loadTimer),s.loadTimer=setTimeout(()=>{s.loaded||((0,ne.H)({block:oe.W.GOOGLE_ADS,prefix:ia,message:`${t} timeout error`}),null==a||a.error(`${t} timeout error`),this.resetRefreshTimer(),this.onClose(e))},this.timeToLoadAdv))}),ta(this,"onSlotResponseReceived",({slot:e})=>{const{stickyPlacement:t,stickyBlockType:r}=e,a=this.getSlotObject(t,r);a&&(sa.spoiler(e.getAdUnitPath())("onSlotResponseReceived",r),clearTimeout(a.loadTimer))}),ta(this,"prebidStartAuction",(0,jr.P)(()=>ra(this,null,function*(){if(null!==this.waitForAuction)return;const{flags:e}=this.context.abt;sa("[prebid_sticky] startAuction"),this.waitForAuction=new Nr.Z,yield(0,pt.BA)(t=>{t.requestBids({adUnits:this.prebidAdUnits,bidsBackHandler:this.prebidAuctionHandler,timeout:(0,pt.cm)(e)})}),this.prebidAuctionTimeout=setTimeout(()=>{sa("[prebid_sticky] No auction handled, call empty function."),this.prebidAuctionHandler()},T.kr)}),Fr.kw)),ta(this,"prebidAuctionHandler",(e,t)=>ra(this,null,function*(){clearTimeout(this.prebidAuctionTimeout),sa("[prebid_sticky] prebidAuctionHandler",e),t&&(0,ne.H)({block:oe.W.ADV},new Error("[prebid_sticky] Auction finished with bidders timed out."));const r=(0,T.Dr)(this.prebidAdUnits);(0,Wr.H)({advTag:o.$H.STICKY,adUnitCodes:r,bids:e}),yield(0,pt.BA)(e=>{var t;e.setTargetingForGPTAsync(r),null==(t=this.waitForAuction)||t.resolve()})})),ta(this,"onWindowResize",(0,ae.D)(()=>{this.setState({windowInnerHeight:window.innerHeight})},200)),ta(this,"changeOrientationListener",()=>ra(this,null,function*(){if(this.props.advHidden)return;let e;if(d.default.isPortrait)e=T.JK.Portrait;else{if(!d.default.isLandscape)return;e=T.JK.Landscape}for(const{slot:t,isClosed:r}of Object.values(this.slots[e])){if(!t||r)return;if(t.stickyBlockType===o.kq.LANDSCAPE_TABLET_ADDITIONAL&&!this.isAdditionalTabletLandscapeBlockEnabled)return;yield this.tryShowAdv(t)}}))}get slotsArray(){return Object.values(this.slots).map(Object.values).reduce((e,t)=>e.concat(t))}componentDidMount(){var e,t;this.setAdvBlocks(),this.setState({windowInnerHeight:window.innerHeight,isMounted:!0}),sa("blockIds = ",this.blockIds),window.addEventListener("resize",this.onWindowResize,!0);const{desktop:r}=this.props.stickyBannerLocation;r&&(this.desktopAdvMinHeight="number"==typeof(null==(t=null==(e=this.allStickyGoogleAdvBlocks.desktop.main.sizes)?void 0:e[0])?void 0:t[1])?this.allStickyGoogleAdvBlocks.desktop.main.sizes[0][1]:600),this.props.advGameCanBeLoaded&&this.loadScripts(),N.Z.onInternalMessage("header",e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})})}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize,!0),d.default.removeChangeListener(this.changeOrientationListener),clearTimeout(this.refreshTimer);const{googletag:e}=window;e&&(this.removeSlotsEventListeners(),this.slotsArray.forEach(t=>{clearTimeout(t.loadTimer),t.slot&&e.destroySlots([t.slot])}))}setAdvBlocks(){this.blockIds=Qr({},this.allStickyGoogleAdvBlocks),this.props.useHighPortraitBlockIds&&this.allStickyGoogleAdvBlocks.portrait_high&&(this.blockIds.portrait=this.allStickyGoogleAdvBlocks.portrait_high),this.blockIds.desktop=ea(Qr({},this.blockIds.desktop),{main:ea(Qr({},this.blockIds.desktop.main),{sizes:la(this.blockIds.desktop.main,this.headerHeight)}),small:ea(Qr({},this.blockIds.desktop.small),{sizes:la(this.blockIds.desktop.small,this.headerHeight)})}),this.blockIds.desktop.small2&&(this.blockIds.desktop.small2=ea(Qr({},this.blockIds.desktop.small2),{sizes:la(this.blockIds.desktop.small2,this.headerHeight)}))}addSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.addEventListener&&(t.addEventListener("slotRequested",this.onSlotRequested),t.addEventListener("slotResponseReceived",this.onSlotResponseReceived),t.addEventListener("slotOnload",this.onSlotLoaded),t.addEventListener("slotRenderEnded",this.onSlotRenderEnded),t.addEventListener("impressionViewable",this.onShow))}removeSlotsEventListeners(){var e;const t=null==(e=googletag.pubads)?void 0:e.call(googletag);t&&"function"==typeof t.removeEventListener&&(t.removeEventListener("slotRequested",this.onSlotRequested),t.removeEventListener("slotResponseReceived",this.onSlotResponseReceived),t.removeEventListener("slotOnload",this.onSlotLoaded),t.removeEventListener("slotRenderEnded",this.onSlotRenderEnded),t.removeEventListener("impressionViewable",this.onShow))}componentDidUpdate(e,t){var r,a,s;const{advGameCanBeLoaded:i,stickyBannerLocation:{desktop:n,mobilePortrait:l,mobileLandscape:d}}=this.props;if(e.advGameCanBeLoaded||!i||this.isScriptsLoaded||this.loadScripts(),n&&!e.isPageBlured&&this.props.isPageBlured)Object.values(this.slots.desktop).forEach(e=>{e.slot&&this.hideAdvSlot(e.slot)});else if(n&&e.isPageBlured&&!this.props.isPageBlured)Object.values(this.slots.desktop).forEach(e=>{e.slot&&this.tryShowAdv(e.slot)});else{if(this.isScriptsLoaded&&n&&t.windowInnerHeight!==this.state.windowInnerHeight){const e=this.minDocumentHeightForBanner();(null==(r=this.slots.desktop.desktop)?void 0:r.slot)&&t.windowInnerHeight<e.main&&this.state.windowInnerHeight>=e.main&&this.tryShowAdv(this.slots.desktop.desktop.slot),(null==(a=this.slots.desktop.desktop_additional)?void 0:a.slot)&&t.windowInnerHeight<e.additional&&this.state.windowInnerHeight>=e.additional&&this.tryShowAdv(this.slots.desktop.desktop_additional.slot),(null==(s=this.slots.desktop.desktop_additional_2)?void 0:s.slot)&&e.additional_2&&t.windowInnerHeight<e.additional_2&&this.state.windowInnerHeight>=e.additional_2&&this.tryShowAdv(this.slots.desktop.desktop_additional_2.slot)}if(this.isScriptsLoaded&&e.advHidden&&!this.props.advHidden||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv){if(n&&Object.values(this.slots.desktop).forEach(e=>{e.slot&&this.tryShowAdv(e.slot)}),l){const e=this.slots.portrait.portrait;(null==e?void 0:e.slot)&&!e.loaded&&this.tryShowAdv(e.slot)}d&&Object.values(this.slots.landscape).forEach(e=>{e.slot&&(e.slot.stickyBlockType!==o.kq.LANDSCAPE_TABLET_ADDITIONAL||this.isAdditionalTabletLandscapeBlockEnabled)&&this.tryShowAdv(e.slot)})}}}getSlotObject(e,t){if(e&&t)return this.slots[e][t]}onClose(e){const{stickyPlacement:t,stickyBlockType:r}=null!=e?e:{},a=this.getSlotObject(t,r);switch(a&&(a.loaded=!1,a.isClosed=!0),this.clickDaemon.close(!1),t){case"desktop":return void this.props.onClose();case"portrait":return void this.props.onClose({onlyPortrait:!0});case"landscape":return void this.props.onClose({onlyLandscape:!0});default:this.props.onClose()}}onNoContent(e){var t;const{stickyPlacement:r,stickyBlockType:a}=e,s=this.getSlotObject(r,a);if(!s)return;const i=null!=(t=s.retries)?t:0;if(i<this.retries)return sa.spoiler(e.getAdUnitPath())(`${i+1} of ${this.retries} retry to refresh slot ${a}`),s.retries=i+1,clearTimeout(s.loadTimer),void setTimeout(()=>{this.tryShowAdv(e)},oa);s.retries&&(s.retries=0),this.hasBeenShownAtLeastOnce||(sa.spoiler(e.getAdUnitPath())(`Hide slot ${a} due no content`),this.onClose(e))}initGPT(){return ra(this,null,function*(){sa("initGPT"),yield(0,Xe.Vg)();try{const{googletag:e}=window;this.addSlotsEventListeners(),this.defineSlots(),e.enableServices(),d.default.addChangeListener(this.changeOrientationListener)}catch(e){(0,ne.H)({message:"Trouble with getting google key values"},e)}})}defineSlots(){const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:r},mobileAdvPortraitHeight:a,mobileAdvLandscapeHeight:s}=this.props;if(this.blockIds)if(e)this.defineDesktopSlots();else if(r&&this.defineGPTSlot({sizes:[[320,a]],advBlockId:this.blockIds.portrait,blockType:o.kq.PORTRAIT,placement:T.JK.Portrait,stickyLocation:D.Xn.BOTTOM}),t)switch(t){case D.Xn.BOTTOM:case D.Xn.UPPER:this.defineGPTSlot({sizes:[[320,s]],advBlockId:this.blockIds.landscape,blockType:o.kq.LANDSCAPE,placement:T.JK.Landscape,stickyLocation:t}),this.defineGPTSlot({sizes:[[320,s]],advBlockId:this.blockIds.landscape,blockType:o.kq.LANDSCAPE_ADDITIONAL,placement:T.JK.Landscape,stickyLocation:t}),this.isAdditionalTabletLandscapeBlockEnabled&&this.defineGPTSlot({sizes:[[320,s]],advBlockId:this.blockIds.landscape,blockType:o.kq.LANDSCAPE_TABLET_ADDITIONAL,placement:T.JK.Landscape,stickyLocation:t});break;case D.Xn.RIGHT:case D.Xn.LEFT:this.defineGPTSlot({sizes:["fluid"],advBlockId:this.blockIds.landscape,blockType:o.kq.LANDSCAPE_SIDE,placement:T.JK.Landscape,stickyLocation:t})}}defineDesktopSlots(){var e,t;this.blockIds&&(this.defineGPTSlot({sizes:this.blockIds.desktop.main.sizes,advBlockId:this.blockIds.desktop.main.blockId,blockType:o.kq.DESKTOP,placement:T.JK.Desktop,stickyLocation:D.Xn.RIGHT}),this.defineGPTSlot({sizes:this.blockIds.desktop.small.sizes,advBlockId:this.blockIds.desktop.small.blockId,blockType:o.kq.DESKTOP_ADDITIONAL,placement:T.JK.Desktop,stickyLocation:D.Xn.RIGHT}),this.defineGPTSlot({sizes:null==(e=this.blockIds.desktop.small2)?void 0:e.sizes,advBlockId:null==(t=this.blockIds.desktop.small2)?void 0:t.blockId,blockType:o.kq.DESKTOP_ADDITIONAL_2,placement:T.JK.Desktop,stickyLocation:D.Xn.RIGHT}))}defineGPTSlot(e){var t;const{advBlockId:r,blockType:a,placement:s,sizes:i,stickyLocation:n}=e,{googletag:o}=window;if(!r||!i)return;sa.spoiler(r,s,a)("defineAndDisplayGPTSlot",`isErrorOnDisplaySlots = ${!o.pubads||!o.defineSlot}`);const l=null==(t=o.defineSlot(r,i,na+a))?void 0:t.addService(o.pubads());l?(l.stickyPlacement=s,l.stickyBlockType=a,l.stickyLocation=n,this.slots[s][a]={loaded:!1,isBatched:!1,isClosed:!1,retries:0,slot:l}):((0,ne.H)({block:oe.W.GOOGLE_ADS,prefix:ia,message:"googletag couldn't create gptSlot"}),this.onClose())}displaySlotsBatched(e){return ra(this,null,function*(){var t;const r=[];this.clickDaemon=new se.U({app_id:this.props.appId,game_id:this.props.appId,tag:o.$H.STICKY}),this.clickDaemon.tryOpen({provider:C.e.Google,reason:e?ie.p_.REFRESH:ie.p_.ONSPOT});for(const e of this.slotsArray)e.slot&&(yield this.tryShowAdv(e.slot,!0),e.isBatched&&(e.isBatched=!1,r.push(e.slot)));this.usePrebid&&(yield this.prebidStartAuction(),yield null==(t=this.waitForAuction)?void 0:t.promise,yield(0,Hr.t)()),googletag.pubads().refresh(r),this.usePrebid&&(this.waitForAuction=null)})}loadScripts(){var e;if(sa("loadScripts isLoaded=",this.isScriptsLoaded),this.isScriptsLoaded)return;this.clickDaemon=new se.U({app_id:this.props.appId,game_id:this.props.appId,tag:o.$H.STICKY});const t=(0,Mr.D)(Xe.CX).then(()=>{throw new Error(`Scripts load timeout (${Xe.CX}ms)`)}),r=(0,pt.cQ)({cdnUrl:this.context.cdnUrl,flags:this.context.abt.flags,fullUrl:(0,Gr.e)().href,options:{isSlowCountry:this.context.isSlowCountry}}),a=(0,Xe.xq)({metrikaCounter:null==(e=(0,wt.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:(0,fe.RM)(this.context.abt.flags,we.Z.prebidLoadAfterGpt)||!1,prebidScriptUrl:this.usePrebid?r:void 0});Promise.race([t,a]).then(e=>ra(this,null,function*(){var t;if(sa("onScriptsLoaded: true"),e.prebid||(this.usePrebid=!1,null==(t=this.waitForAuction)||t.resolve()),e.gptError)throw e.gptError;this.isScriptsLoaded=!0,yield this.initGPT(),this.usePrebid&&(yield this.initPrebid()),yield this.displaySlotsBatched(!1)})).catch(e=>{this.onScriptsLoadError(e)})}onScriptsLoadError(e){sa("onScriptsLoadError",e),(0,ne.H)({block:oe.W.GOOGLE_ADS,prefix:ia,message:"script failed to load"}),this.onClose(),this.props.onAdvShowed()}initPrebid(){return ra(this,null,function*(){sa("[prebid_sticky] initPrebid"),yield(0,pt.OH)(),yield(0,pt.BA)(e=>ra(this,null,function*(){return e.addAdUnits(this.prebidAdUnits)}))})}showAdv(e,t=!1){return ra(this,null,function*(){const{googletag:r}=window,{stickyPlacement:a,stickyBlockType:s}=e,i=this.getSlotObject(a,s);i&&(sa("showAdv",s),i.retries||(this.clickDaemon.demand({advBlockId:e.getAdUnitPath(),depth:0,provider:C.e.Google,reason:i.loaded?ie.p_.REFRESH:ie.p_.ONSPOT}),this.isFirstTryOpen&&(da("isFirstTryOpen",!0),this.isFirstTryOpen=!1)),e.clickDaemon=this.clickDaemon.copy(),e.clickDaemon.request(),t?i.isBatched=!0:(yield(0,Hr.t)(),r.pubads().refresh([e])),this.props.onAdvShowed())})}tryShowAdv(e,t=!1){return ra(this,null,function*(){const{advHidden:r,canShowDesktopAdv:a,canShowPortraitAdv:s,canShowLandscapeAdv:i}=this.props,{stickyPlacement:n,stickyBlockType:l}=e;if(n&&l)switch(sa("tryShowAdv",l),l){case o.kq.DESKTOP:a&&!r&&this.state.windowInnerHeight>=this.minDocumentHeightForBanner().main&&(yield this.showAdv(e,t));break;case o.kq.DESKTOP_ADDITIONAL:a&&!r&&this.state.windowInnerHeight>=this.minDocumentHeightForBanner().additional&&(yield this.showAdv(e,t));break;case o.kq.DESKTOP_ADDITIONAL_2:{const s=this.minDocumentHeightForBanner();a&&!r&&s.additional_2&&this.state.windowInnerHeight>=s.additional_2&&(yield this.showAdv(e,t));break}case o.kq.PORTRAIT:s&&!r&&d.default.isPortrait&&(yield this.showAdv(e,t));break;case o.kq.LANDSCAPE_SIDE:case o.kq.LANDSCAPE:case o.kq.LANDSCAPE_ADDITIONAL:i&&!r&&d.default.isLandscape&&(yield this.showAdv(e,t));break;case o.kq.LANDSCAPE_TABLET_ADDITIONAL:this.isAdditionalTabletLandscapeBlockEnabled&&i&&!r&&d.default.isLandscape&&(yield this.showAdv(e,t))}})}hideAdvSlot(e){sa("hideAdvSlot"),googletag.pubads().clear([e])}renderBanner(e,t,r,s,i){const{showSpinner:n}=this.state,l=na+t,d=e===T.JK.Desktop,c=e===T.JK.Landscape,u=d?T.P5.COLUMN:T.P5.ROW,h=(0,T.oi)(s,i),p=this.props.advHidden||t===o.kq.PORTRAIT&&!this.props.canShowPortraitAdv||c&&!this.props.canShowLandscapeAdv||d&&!this.props.canShowDesktopAdv;return(0,a.jsx)("div",{className:aa({[e]:!0,[`${e}_${r}`]:!0,direction:u,border_round:!d,hidden:p,"with-disable-ad-button":!0,"middle-layer-light":this.props.isMiddleLayerShownInGame&&!this.props.darkTheme}),id:l,style:h,children:!c&&t!==o.kq.DESKTOP_ADDITIONAL&&t!==o.kq.DESKTOP_ADDITIONAL_2&&(0,a.jsx)(A.y,{className:aa("spinner",{hidden:!n}),position:"center",size:28,spinning:!0},`${l}-spinner`)},l)}minDocumentHeightForBanner(){var e,t,r,a,s,i;if(this.isThreeDesktopBannersExpEnabled&&this.blockIds&&this.blockIds.desktop.small2){const n=null==(t=null==(e=this.blockIds.desktop.main.sizes)?void 0:e[0])?void 0:t[1],o=null==(a=null==(r=this.blockIds.desktop.small.sizes)?void 0:r[0])?void 0:a[1],l=null==(i=null==(s=this.blockIds.desktop.small2.sizes)?void 0:s[0])?void 0:i[1],d=this.headerHeight+n;return{main:d,additional:d+o,additional_2:d+o+l}}return{main:500,additional:700}}render(){var e;const{advHidden:t,canShowDesktopAdv:r,hideAdvCloseButton:s,desktopAdvWidth:i,isLandscapeSide:n,mobileAdvLandscapeHeight:l,mobileAdvSideLandscapeWidth:d,mobileAdvPortraitHeight:c,stickyBannerLocation:{desktop:p,mobileLandscape:v,mobilePortrait:m}}=this.props,{isHeaderEnabled:g,showLandscapeSpinner:y,windowInnerHeight:f}=this.state;if(!this.state.isMounted)return null;if(p){const n={marginTop:g&&!s?-this.headerHeight:0,paddingTop:s?0:this.headerHeight,width:i},l={width:i,marginTop:g?-this.headerHeight:0},d=this.minDocumentHeightForBanner(),c=t||!r;return(0,a.jsxs)("div",{className:aa("desktop-wrapper",{hidden:c,"with-disable-ad-button":!0,"middle-layer-light":this.props.isMiddleLayerShownInGame&&!this.props.darkTheme,"with-flex-banners":this.isThreeDesktopBannersExpEnabled}),style:n,children:[!this.props.hideAdvCloseButton&&!c&&(null==(e=this.props.wrapperRef)?void 0:e.current)&&(0,h.createPortal)((0,a.jsx)("div",{className:aa("desktop-disable-ad-button-wrapper"),style:l,children:(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{})}),this.props.wrapperRef.current),f>=d.main&&this.renderBanner(T.JK.Desktop,o.kq.DESKTOP,p,Qr({maxWidth:i,width:i},!this.isThreeDesktopBannersExpEnabled&&{minHeight:this.desktopAdvMinHeight})),f>=d.additional&&this.renderBanner(T.JK.Desktop,o.kq.DESKTOP_ADDITIONAL,p,{maxWidth:i,width:i}),this.isThreeDesktopBannersExpEnabled&&d.additional_2&&f>=d.additional_2&&this.renderBanner(T.JK.Desktop,o.kq.DESKTOP_ADDITIONAL_2,p,{maxWidth:i,width:i})]})}const w=(0,T.Z4)("landscape",this.isAdditionalTabletLandscapeBlockEnabled);return(0,a.jsxs)(a.Fragment,{children:[m&&this.renderBanner(T.JK.Portrait,o.kq.PORTRAIT,m,{height:c,maxHeight:c}),v&&(0,a.jsxs)("div",{className:aa("landscape-wrapper",{[v]:!0,"with-disable-ad-button":!0}),style:this.landscapeStyles,children:[(0,a.jsx)(A.y,{className:aa("spinner",{hidden:!y}),position:"center",size:28,spinning:!0},"landscape-spinner"),n&&this.renderBanner(T.JK.Landscape,o.kq.LANDSCAPE_SIDE,v,{width:d}),!n&&this.renderBanner(T.JK.Landscape,o.kq.LANDSCAPE,v,{height:l,maxHeight:l,minWidth:w}),!n&&this.isAdditionalTabletLandscapeBlockEnabled&&this.renderBanner(T.JK.Landscape,o.kq.LANDSCAPE_TABLET_ADDITIONAL,v,{height:l,maxHeight:l,minWidth:w}),!n&&this.renderBanner(T.JK.Landscape,o.kq.LANDSCAPE_ADDITIONAL,v,{height:l,maxHeight:l,minWidth:w})]})]})}}const ua=(0,p.$j)(function(e){var t;return{advGameCanBeLoaded:e.advGameCanBeLoaded,darkTheme:(0,nt.Up)(e),isMiddleLayerShownInGame:null==(t=e.middleLayerInGameData)?void 0:t.show}})(ca);var ha=r(3914);const pa=new Set;function va(e){!function(e,t){(0,ne.H)({block:oe.W.ADV_STICKY,message:`NativeStickyApi error: ${t.message}`},t)}(0,e)}function ma(e){var t,r;return"function"==typeof(null==(r=null==(t=window.yandex)?void 0:t.ads)?void 0:r[e])}function ga(e){return function(...t){var r,a,s;return ma(e)?null==(s=null==(a=null==(r=window.yandex)?void 0:r.ads)?void 0:a[e])?void 0:s.call(a,...t).catch(e=>{throw va(e),e}):function(e){const t=new Error(`Action "${e}" is not available`);return va(t),Promise.reject(t)}(e)}}const ya={isActionAvailable:ma,hideStickyBanner:ga("hideStickyBanner"),refreshStickyBanner:ga("refreshStickyBanner"),showStickyBanner:e=>{const{blockId:t,mediation:r,position:a,orientation:s,dimension:i,revenueData:n}=e;return ga("showStickyBanner")(t,r,a,s,i,n)},stickyBannerIsShowing:ga("stickyBannerIsShowing")};var fa=r(79092),wa=r(11391),ba=Object.defineProperty,ka=Object.getOwnPropertySymbols,Aa=Object.prototype.hasOwnProperty,Sa=Object.prototype.propertyIsEnumerable,Pa=(e,t,r)=>t in e?ba(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ia=(e,t)=>{for(var r in t||(t={}))Aa.call(t,r)&&Pa(e,r,t[r]);if(ka)for(var r of ka(t))Sa.call(t,r)&&Pa(e,r,t[r]);return e},Ta=(e,t,r)=>(Pa(e,"symbol"!=typeof t?t+"":t,r),r),Ea=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Ca=(0,b.M$)("NativeStickyAdvBanner",b.XG.Adv);class Da extends Q.P{constructor(e,t){var r;super(e),Ta(this,"nativeStickyApi"),Ta(this,"blockIds"),Ta(this,"library"),Ta(this,"isAdvHidden",i().createRef()),Ta(this,"refreshTimeoutIds",{landscape:0,portrait:0}),Ta(this,"isAdNeedToRefresh",{portrait:!1,landscape:!1}),Ta(this,"advHeight",{portrait:T.qi,landscape:T.qi}),Ta(this,"revenueData",{app_id:this.props.appId}),Ta(this,"revenueDataAsString",""),Ta(this,"clickDaemon"),Ta(this,"changeOrientationListener",()=>Ea(this,null,function*(){const e=d.default.isPortrait?o.kq.PORTRAIT:o.kq.LANDSCAPE;if(Ca(`changeOrientationListener isAdNeedToRefresh${e}=${this.isAdNeedToRefresh[e]}`),this.isAdNeedToRefresh[e])return void this.updateAdv(e);if(!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return;const t=yield this.nativeStickyApi.stickyBannerIsShowing();Ca(`changeOrientationListener isAdvShowing=${t} advHidden=${this.isAdvHidden.current}`),t||this.isAdvHidden.current||this.openNativeAdvBanner(e)})),this.blockIds=(0,T.AO)({advBlocks:t.playPageData.gameSettings.advBlocks,flags:t.abt.flags,residenceInfo:null==(r=t.playPageData.gameSettings.advInfo)?void 0:r.residence_info,withWorldWideAdv:t.withWorldWideAdv,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds}),Ca("native sticky advBlocks",this.blockIds),this.nativeStickyApi=ya,this.library=(0,T.dF)(t.abt.flags);const a=(0,fa.X)(),s=(0,wa.W5)(),n=Ia(Ia({},a?{clid:a}:{}),s?{gclid:s}:{});Object.assign(this.revenueData,n),this.revenueDataAsString=JSON.stringify(this.revenueData),this.advHeight={portrait:e.mobileAdvPortraitHeight,landscape:e.isLandscapeSide?e.mobileAdvSideLandscapeWidth:e.mobileAdvLandscapeHeight}}componentDidUpdate(e){e.advHidden&&!this.props.advHidden&&this.tryShowAdv(),!e.advHidden&&this.props.advHidden&&this.hideAdv(),this.isAdvHidden.current=this.props.advHidden}componentWillUnmount(){d.default.removeChangeListener(this.changeOrientationListener),window.clearTimeout(this.refreshTimeoutIds.landscape),window.clearTimeout(this.refreshTimeoutIds.portrait),this.onClose(!1)}tryShowAdv(){return Ea(this,null,function*(){if(this.clickDaemon=new se.U({tag:o.$H.STICKY,app_id:this.props.appId,game_id:this.props.appId}),!this.nativeStickyApi.isActionAvailable("stickyBannerIsShowing"))return Ca("tryShowAdv","ads.stickyBannerIsShowing is not a function"),void this.onClose();const e=yield this.nativeStickyApi.stickyBannerIsShowing();if(this.props.onAdvShowed(),e)return void Ca("tryShowAdv","adv is showing");const{mobilePortrait:t,mobileLandscape:r}=this.props.stickyBannerLocation;this.clickDaemon.tryOpen({provider:C.e.Native,reason:ie.p_.ONSPOT}),t&&d.default.isPortrait?(this.clickDaemon.demand({advBlockId:this.blockIds.portrait.blockID}),this.openNativeAdvBanner(o.kq.PORTRAIT)):r&&d.default.isLandscape&&(this.clickDaemon.demand({advBlockId:this.blockIds.landscape.blockID}),this.openNativeAdvBanner(o.kq.LANDSCAPE))})}componentDidMount(){return Ea(this,null,function*(){Ca(`blockIds = ${JSON.stringify(this.blockIds)}\n\n            revenueData=${this.revenueDataAsString}\n        `),yield this.tryShowAdv(),d.default.addChangeListener(this.changeOrientationListener)})}hideAdv(){this.nativeStickyApi.isActionAvailable("hideStickyBanner")?(this.nativeStickyApi.hideStickyBanner(),this.props.onAdvShowed()):Ca("hideAdv","ads.hideStickyBanner is undefined")}onClose(e=!0){e&&this.clickDaemon.close(),this.hideAdv(),this.props.onClose()}openNativeAdvBanner(e){if(!this.nativeStickyApi.isActionAvailable("showStickyBanner"))return Ca("openNativeAdvBanner","ads.showStickyBanner is undefined"),void this.onClose();const{stickyBannerLocation:{mobilePortrait:t,mobileLandscape:r}}=this.props,a="portrait"===e?t:r;if(!a)return void Ca("openNativeAdvBanner","ad position is a null");const s=function(e,t){return"upper"===t?t="bottom":"left"===t&&(t="right"),`${e}-${t}`}(e,a);if(pa.has(s))return Ca("openNativeAdvBanner","The previous show ended with an error"),void this.onClose();this.clickDaemon.request({advBlockId:this.blockIds[e].blockID,reason:ie.p_.ONSPOT}),this.nativeStickyApi.showStickyBanner({blockId:this.blockIds[e].blockID,mediation:this.library,position:a,orientation:e,dimension:this.advHeight[e],revenueData:{revenueData:this.revenueDataAsString}}).then(()=>{pa.delete(s),this.clickDaemon.response(),this.clickDaemon.show(),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)}).catch(e=>{var t;pa.add(s),this.clickDaemon.error(null!=(t=e.message)?t:String(e)),Ca(e),this.onClose()})}runUpdateAdvTimeout(e){const t=d.default.isPortrait?"portrait":"landscape";this.refreshTimeoutIds[e]=window.setTimeout(()=>{e===t?this.updateAdv(e):this.isAdNeedToRefresh[e]=!0},this.props.intervalBetweenRefreshAd)}updateAdv(e){this.nativeStickyApi.isActionAvailable("refreshStickyBanner")?(this.clickDaemon=new se.U({tag:o.$H.STICKY,app_id:this.props.appId,game_id:this.props.appId}),this.clickDaemon.tryOpen({provider:C.e.Native,reason:ie.p_.REFRESH}),this.clickDaemon.demand({advBlockId:this.blockIds[e].blockID}),this.clickDaemon.request(),this.nativeStickyApi.refreshStickyBanner().then(()=>{this.clickDaemon.response(),this.clickDaemon.show(),window.clearTimeout(this.refreshTimeoutIds[e]),this.isAdNeedToRefresh[e]=!1,this.runUpdateAdvTimeout(e)}).catch(e=>{var t;this.clickDaemon.error(null!=(t=e.message)?t:String(e)),Ca(e),this.onClose()})):Ca("updateAdv","ads.refreshAdvert is undefined")}render(){return null}}var Ra=r(45252),xa=r(34922),_a=r(39138);const Oa={root:"new-year-promo-module__root--ivl9P",title:"new-year-promo-module__title--FwcJH",marker:"new-year-promo-module__marker--SMAjs",description:"new-year-promo-module__description--GLk8j","height-50":"new-year-promo-module__height-50--EMXpa","height-100":"new-year-promo-module__height-100--_AKQj","height-240":"new-year-promo-module__height-240--KyfE2","height-320":"new-year-promo-module__height-320--AZKaz"},La=({size:e})=>{const t=(0,_a.T)();return(0,a.jsxs)("div",{className:(0,ye.E)(Oa.root,Oa[`height-${e}`]),"data-testid":`new-year-promo-${e}`,children:[(0,a.jsxs)("div",{className:Oa.title,children:[t("new.year.promo.title-1"),(0,a.jsx)("span",{className:Oa.marker,children:t("new.year.promo.title-2")})]}),(0,a.jsx)("div",{className:Oa.description,children:t("new.year.promo.description")})]})};var Ba=r(2306),Na=r(40862),ja=r(82640);const Ma=w().with("yandex-sticky-adv-banner"),Ha=({isDesktop:e,isLandscape:t,isLandscapeSide:r,isPortrait:s,isPortraitHigh:i})=>{const n=(0,St.b)(),o=(0,ja.U)(n.oneTabPWA);if((0,u.v_)({on:"new_year_promo"})){const n=(()=>{const{basePath:e}=(0,wt.getDomainConfig)();return`${e||"/"}/partner-events/new_year/?${kt}`})();return(0,a.jsx)("div",{className:Ma("banner-wrapper"),children:(0,a.jsxs)("a",{className:Ma("banner-link"),href:n,target:o,children:[e&&(0,a.jsx)(La,{size:"320"}),r&&(0,a.jsx)(La,{size:"240"}),t&&!r&&(0,a.jsx)(La,{size:"50"}),s&&(0,a.jsx)(La,{size:i?"100":"50"})]})})}const l=At(n);return(0,a.jsx)("div",{className:Ma("banner-wrapper"),children:(0,a.jsxs)("a",{className:Ma("banner-link"),href:l,target:o,children:[e&&(0,a.jsx)(Na.Q,{size:"320"}),r&&(0,a.jsx)(Na.Q,{size:"240"}),t&&!r&&(0,a.jsx)(Ba.f,{size:"50"}),s&&(0,a.jsx)(Ba.f,{size:i?"100":"50"})]})})},$a=({advHidden:e,canShowLandscapeAdv:t,canShowPortraitAdv:r,customStyles:i,darkTheme:n,isMiddleLayerShownInGame:l,location:d,sizeParams:c={},type:u})=>{const h=(0,T.oi)(c,i),{isDesktop:p,isLandscape:v,isLandscapeSide:m,isPortrait:g,isPortraitHigh:y}=(0,s.useMemo)(()=>((e,t,r)=>{var a;const s=e===o.kq.DESKTOP,i=e===o.kq.LANDSCAPE,n=i&&("left"===t||"right"===t),l=e===o.kq.PORTRAIT;return{isDesktop:s,isLandscape:i,isLandscapeSide:n,isPortrait:l,isPortraitHigh:l&&(null!=(a=r.maxHeight)?a:0)>50}})(u,d,c),[u,d,c]),f=y||m,w=v&&!m||g,b=((e,t,r,a,s)=>e||t&&!a||r&&!s)(e,g,v,r,t);return(0,a.jsx)("div",{className:Ma({flex:Boolean(f),horizontal:w,[u]:d,border_round:Boolean(g||v),hidden:b,"middle-layer-light":l&&!n}),id:{portrait:"yandex-adv-sticky-banner-portrait",portrait_high:"yandex-adv-sticky-banner-portrait",landscape:"yandex-adv-sticky-banner-landscape",desktop:"yandex-adv-sticky-banner-desktop"}[u],style:h,children:(0,a.jsx)(Ha,{isDesktop:p,isLandscape:v,isLandscapeSide:m,isPortrait:g,isPortraitHigh:y})},u)};var Fa=r(76753);const Wa=w().with("yandex-sticky-adv-banner"),Za=function(e){const{advHidden:t,appId:r,canShowDesktopAdv:i,canShowLandscapeAdv:n,canShowPortraitAdv:l,desktopAdvWidth:d,hideAdvCloseButton:c,intervalBetweenRefreshAd:p,mobileAdvLandscapeHeight:v,mobileAdvPortraitHeight:m,mobileAdvSideLandscapeWidth:g,onClose:f,stickyBannerLocation:w,wrapperRef:b,isLandscapeSide:k}=e,A=(0,y.C)(nt.Up),S=(0,y.C)(e=>{var t;return null==(t=e.middleLayerInGameData)?void 0:t.show}),[P,I]=(0,s.useState)(!(0,L.I)()),T=(0,s.useRef)(),E=(0,s.useRef)(new se.U({app_id:r,game_id:r,tag:o.$H.STICKY})),D=(0,j.C)(),R=(0,s.useCallback)(()=>{E.current.tryOpen({provider:C.e.Promo,reason:ie.p_.WATERFALL}),E.current.demand({provider:C.e.Promo,advBlockId:"sticky_promo"}),E.current.request(),E.current.response(),E.current.show(),clearTimeout(T.current),T.current=window.setTimeout(()=>f(),p)},[p,f]);if((0,s.useEffect)(()=>(N.Z.onInternalMessage("header",e=>{I("enabled"===e.data.action)}),()=>{window.clearTimeout(T.current)}),[]),(0,Fa.q)(()=>{R()}),w.desktop){const e={width:d,marginTop:P&&!c?-D:0,paddingTop:c?0:D},r={width:d,marginTop:P?-D:0},s=t||!i;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:Wa("desktop-wrapper",{hidden:s,"with-disable-ad-button":!0,"middle-layer-light":S&&!A,promo:!0}),style:e,children:[!s&&!c&&(null==b?void 0:b.current)&&(0,h.createPortal)((0,a.jsx)("div",{className:Wa("desktop-disable-ad-button-wrapper"),style:r,children:(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{})}),b.current),(0,a.jsx)($a,{advHidden:t,canShowLandscapeAdv:n,canShowPortraitAdv:l,darkTheme:A,isMiddleLayerShownInGame:S,location:w.desktop,stickyLocationParams:w,type:o.kq.DESKTOP})]})})}const x=k?{}:{left:-D,width:`calc(100% + ${D}px)`},_=k?{width:g}:{height:v,maxHeight:v};return(0,a.jsxs)(a.Fragment,{children:[w.mobilePortrait&&(0,a.jsx)($a,{advHidden:t,canShowLandscapeAdv:n,canShowPortraitAdv:l,darkTheme:A,isMiddleLayerShownInGame:S,location:w.mobilePortrait,sizeParams:{height:m,maxHeight:m},stickyLocationParams:w,type:o.kq.PORTRAIT}),w.mobileLandscape&&(0,a.jsx)("div",{className:Wa("landscape-wrapper",{[w.mobileLandscape]:!0}),style:x,children:(0,a.jsx)($a,{advHidden:t,canShowLandscapeAdv:n,canShowPortraitAdv:l,customStyles:_,darkTheme:A,isMiddleLayerShownInGame:S,location:w.mobileLandscape,sizeParams:_,stickyLocationParams:w,type:o.kq.LANDSCAPE})})]})},qa=r(33728).S;var Ga=r(56005),za=r(58894),Ua=r(68401),Va=r(8145),Ka=r(89491),Ya=r(83959),Xa=r(55222),Ja=r(70619),Qa=r(24046),es=r(29513),ts=r(7183),rs=Object.defineProperty,as=Object.defineProperties,ss=Object.getOwnPropertyDescriptors,is=Object.getOwnPropertySymbols,ns=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable,ls=(e,t,r)=>t in e?rs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ds=(e,t)=>{for(var r in t||(t={}))ns.call(t,r)&&ls(e,r,t[r]);if(is)for(var r of is(t))os.call(t,r)&&ls(e,r,t[r]);return e},cs=(e,t,r)=>(ls(e,"symbol"!=typeof t?t+"":t,r),r),us=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const hs=w().with("yandex-sticky-adv-banner"),ps=(0,b.M$)("YandexStickyAdvBanner",b.XG.Adv);class vs extends Q.P{constructor(){super(...arguments),cs(this,"gameBlockIds",(0,T.V0)({advBlocks:this.context.playPageData.gameSettings.advBlocks,appId:this.props.appId,flags:this.context.abt.flags,locations:this.props.stickyBannerLocation,useHighPortraitBlockIds:this.props.useHighPortraitBlockIds})),cs(this,"blockIds",{desktop:"",desktop_additional:"",portrait:"",portrait_high:"",landscape:"",landscape_additional:""}),cs(this,"containerIds",{portrait:"yandex-adv-sticky-banner-portrait",portrait_high:"yandex-adv-sticky-banner-portrait",landscape:"yandex-adv-sticky-banner-landscape",landscape_additional:"yandex-adv-sticky-banner-landscape_additional",desktop:"yandex-adv-sticky-banner-desktop",desktop_additional:"yandex-adv-sticky-banner-desktop_additional"}),cs(this,"useWhiteBackgroundOnDesktop",Boolean((0,fe.pJ)(this.context.abt.flags)&&this.props.stickyBannerLocation.desktop)),cs(this,"additionalLandscapeBlockEnabled",(0,fe.Vr)(this.context.abt.flags)&&this.props.stickyBannerLocation.mobileLandscape!==D.Xn.RIGHT),cs(this,"timeToLoadAdv",(0,T.Qt)(this.context.abt.flags)),cs(this,"additionalBlockTimeoutId"),cs(this,"eventLoadingTimeoutId"),cs(this,"refreshTimeoutId"),cs(this,"refreshLandscapeTimeoutId"),cs(this,"rejectTimeoutId"),cs(this,"checkReadyIntervalId"),cs(this,"desktopAdvOptions"),cs(this,"desktopAdditionalAdvOptions"),cs(this,"portraitAdvOptions"),cs(this,"landscapeAdvOptions"),cs(this,"landscapeAdditionalAdvOptions"),cs(this,"refreshCounters",{[o.kq.DESKTOP]:0}),cs(this,"eventsPromoBlockRefreshNumber",(0,u.v_)({on:"events_on_game_page.before_first_sticky_refresh"})?0:(0,u.v_)({on:"events_on_game_page.after_first_sticky_refresh"})?1:(0,u.v_)({on:"events_on_game_page.after_second_sticky_refresh"})?2:-1),cs(this,"clickDaemon",new se.U({app_id:this.props.appId,game_id:this.props.appId,tag:o.$H.STICKY})),cs(this,"loadedScript"),cs(this,"loadedFlags",{isDesktopAdvLoaded:!1,isLandscapeAdvLoaded:!1,isPortraitAdvLoaded:!1,isRefreshAdv:!1,isRefreshLandscapeAdv:!1}),cs(this,"hasBeenShownAtLeastOnce",!1),cs(this,"scriptLoadPromiseWrapper",new Nr.Z),cs(this,"headerHeight",(0,j.C)()),cs(this,"landscapeWrapperStyles",this.props.isLandscapeSide?{}:{left:-this.headerHeight,width:`calc(100% + ${this.headerHeight}px)`}),cs(this,"landscapeBlockStyles",this.props.isLandscapeSide?{width:this.props.mobileAdvSideLandscapeWidth}:{height:this.props.mobileAdvLandscapeHeight,maxHeight:this.props.mobileAdvLandscapeHeight}),cs(this,"state",{isAdditionalLandscapeMediaAdType:!1,isHeaderEnabled:!(0,L.I)(),isLandscapeMediaAdType:!1,isPortraitMediaAdType:!1,isWaitingForEventsToLoad:(0,Va.r_)()===Va.MD.BeforeFirstStickyRefresh,showDesktopAdditional:!1,showLandscapeAdditional:!1,showSpinner:!0,shouldShowEventsPromoBlock:!1}),cs(this,"changeOrientationListener",()=>{d.default.isPortrait?this.showAdv(o.kq.PORTRAIT):d.default.isLandscape&&this.showAdv(o.kq.LANDSCAPE)}),cs(this,"updateRefreshTimer",e=>{switch(e){case o.kq.DESKTOP:ps("update refresh timer"),window.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=window.setTimeout(this.handleDesktopRefreshTimeout,this.props.intervalBetweenRefreshAd);break;case o.kq.PORTRAIT:ps("update refresh timer"),window.clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=window.setTimeout(()=>{this.setState({showSpinner:!0},()=>{this.refreshPortrait()})},this.props.intervalBetweenRefreshAd);break;case o.kq.LANDSCAPE:ps("update refresh timer"),window.clearTimeout(this.refreshLandscapeTimeoutId),this.refreshLandscapeTimeoutId=window.setTimeout(()=>{this.refreshLandscape()},this.props.intervalBetweenRefreshAd)}}),cs(this,"handleDesktopRefreshTimeout",()=>{this.refreshCounters[o.kq.DESKTOP]++,this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isDesktopAdvLoaded=!1,this.setShowState(o.kq.DESKTOP_ADDITIONAL,!1),this.destroyAdv(this.blockIds[o.kq.DESKTOP]),this.destroyAdv(this.blockIds[o.kq.DESKTOP_ADDITIONAL]),ps("refresh timer executed"),this.canShowEventsPromoBlock()?this.showEventsPromoBlock():this.state.shouldShowEventsPromoBlock?this.hideEventsPromoBlock():this.showAdv(o.kq.DESKTOP)}),cs(this,"refreshLandscape",()=>{this.setShowState(o.kq.LANDSCAPE_ADDITIONAL,!1),this.destroyAdv(this.blockIds[o.kq.LANDSCAPE_ADDITIONAL]),this.destroyAdv(this.blockIds[o.kq.LANDSCAPE]),this.loadedFlags.isRefreshLandscapeAdv=!0,this.loadedFlags.isLandscapeAdvLoaded=!1,this.showAdv(o.kq.LANDSCAPE)}),cs(this,"refreshPortrait",()=>{this.destroyAdv(this.blockIds[o.kq.PORTRAIT]),this.loadedFlags.isRefreshAdv=!0,this.loadedFlags.isPortraitAdvLoaded=!1,this.showAdv(o.kq.PORTRAIT)})}get isInAppPromoAdvEnabled(){const{pathname:e}=(0,Gr.e)(),t=this.context.playPageData.gameSettings.extraFeatures.inAppGame;return!(0,ts.eT)(this.context,e)&&(0,u.v_)({on:"adv_inapp_promo_sticky"})&&!t}componentWillUnmount(){window.clearTimeout(this.refreshTimeoutId),window.clearTimeout(this.refreshLandscapeTimeoutId),window.clearTimeout(this.rejectTimeoutId),window.clearTimeout(this.additionalBlockTimeoutId),window.clearInterval(this.checkReadyIntervalId),d.default.removeChangeListener(this.changeOrientationListener)}handleAdvBlockIdError(e){(0,ne.H)({block:oe.W.ADV_STICKY,message:`AdvStickyBanner error [yandex]: There is no blockId for ${e}`})}tryInitAdvBlockId(e,t){return!!t&&(this.blockIds[e]=t,!0)}componentDidMount(){var e,t,r,a,s;const{desktop:i,mobileLandscape:n,mobilePortrait:l}=this.props.stickyBannerLocation;if(ps("yandex sticky advBlocks",this.gameBlockIds),i){const r=this.tryInitAdvBlockId(o.kq.DESKTOP,null==(e=this.gameBlockIds.desktop)?void 0:e.blockID);if(this.tryInitAdvBlockId(o.kq.DESKTOP_ADDITIONAL,null==(t=this.gameBlockIds.desktop_additional)?void 0:t.blockID),r||(this.onClose({error:"desktop block not initialized"}),this.handleAdvBlockIdError(o.kq.DESKTOP)),(0,Va.r_)()===Va.MD.BeforeFirstStickyRefresh){const e=2*qr.WT;this.eventLoadingTimeoutId=window.setTimeout(()=>{ps("event promos loading timeout exceeded"),this.setState({isWaitingForEventsToLoad:!1,shouldShowEventsPromoBlock:!1})},e)}}if(l&&(this.tryInitAdvBlockId(o.kq.PORTRAIT,null==(r=this.gameBlockIds.portrait)?void 0:r.blockID)||(this.onClose({onlyPortrait:!0,error:"portrait block not initialized"}),this.handleAdvBlockIdError(o.kq.PORTRAIT))),n){const e=this.tryInitAdvBlockId(o.kq.LANDSCAPE,null==(a=this.gameBlockIds.landscape)?void 0:a.blockID);this.tryInitAdvBlockId(o.kq.LANDSCAPE_ADDITIONAL,null==(s=this.gameBlockIds.landscape_additional)?void 0:s.blockID),e||(this.onClose({onlyLandscape:!0,error:"landscape block not initialized"}),this.handleAdvBlockIdError(o.kq.LANDSCAPE))}d.default.addChangeListener(this.changeOrientationListener),this.overrideBlockIds(),this.props.advGameCanBeLoaded&&!this.canShowEventsPromoBlock()&&this.loadAdvScript(),N.Z.onInternalMessage("header",e=>{this.setState({isHeaderEnabled:"enabled"===e.data.action})}),this.canShowEventsPromoBlock()&&this.showEventsPromoBlock()}componentDidUpdate(e,t){this.handleEventLoadingStatusChange(e),this.handleAdvVisibility(e,t)}overrideBlockIds(){var e,t;if(!this.isInAppPromoAdvEnabled)return;const r=(0,za.k)("sticky",this.context.abt.flags);if((null==r?void 0:r.showCount)&&r.showCount>0){const r=(null==(t=null==(e=(0,Br.CB)(this.context.abt.flags))?void 0:e.sticky)?void 0:t.desktop)||K.UV.sticky.desktop;this.blockIds.desktop=r,this.blockIds.desktop_additional=r}else this.gameBlockIds.desktop&&(this.blockIds.desktop=this.gameBlockIds.desktop.blockID),this.gameBlockIds.desktop_additional&&(this.blockIds.desktop_additional=this.gameBlockIds.desktop_additional.blockID);this.desktopAdvOptions=this.getAdvOptions(o.kq.DESKTOP,this.blockIds[o.kq.DESKTOP]),this.desktopAdditionalAdvOptions=this.getAdvOptions(o.kq.DESKTOP_ADDITIONAL,this.blockIds[o.kq.DESKTOP_ADDITIONAL])}handleAdvVisibility(e,t){const{advGameCanBeLoaded:r}=this.props;this.loadedScript?this.updateAdVisibility(e,t):!r||this.canShowEventsPromoBlock()||this.state.shouldShowEventsPromoBlock||this.loadAdvScript()}updateAdVisibility(e,t){const{stickyBannerLocation:{desktop:r,mobilePortrait:a,mobileLandscape:s}}=this.props;(e.advHidden&&!this.props.advHidden&&!this.state.shouldShowEventsPromoBlock||!e.canShowPortraitAdv&&this.props.canShowPortraitAdv||!e.canShowLandscapeAdv&&this.props.canShowLandscapeAdv||t.shouldShowEventsPromoBlock&&!this.state.shouldShowEventsPromoBlock)&&(r&&this.showAdv(o.kq.DESKTOP),a&&this.showAdv(o.kq.PORTRAIT),s&&this.showAdv(o.kq.LANDSCAPE))}handleEventLoadingStatusChange(e){var t,r;const{stickyBannerLocation:{desktop:a}}=this.props;a&&(null==(t=e.appPromos)?void 0:t.fetching)&&!(null==(r=this.props.appPromos)?void 0:r.fetching)&&(this.setState({isWaitingForEventsToLoad:!1},()=>{var e;(null==(e=this.props.appPromos)?void 0:e.error)||(this.canShowEventsPromoBlock()?this.updateRefreshTimer(o.kq.DESKTOP):this.setState({shouldShowEventsPromoBlock:!1}))}),clearTimeout(this.eventLoadingTimeoutId))}isAdditionalBlock(e){return[o.kq.DESKTOP_ADDITIONAL,o.kq.LANDSCAPE_ADDITIONAL].includes(e)}initAdvStickyBlocks(){const{stickyBannerLocation:{desktop:e,mobileLandscape:t,mobilePortrait:r}}=this.props;if(e)return this.desktopAdvOptions=this.getAdvOptions(o.kq.DESKTOP,this.blockIds[o.kq.DESKTOP]),this.desktopAdditionalAdvOptions=this.getAdvOptions(o.kq.DESKTOP_ADDITIONAL,this.blockIds[o.kq.DESKTOP_ADDITIONAL]),void this.showAdv(o.kq.DESKTOP);r&&(this.portraitAdvOptions=this.getAdvOptions(o.kq.PORTRAIT,this.blockIds[o.kq.PORTRAIT]),this.showAdv(o.kq.PORTRAIT)),t&&(this.landscapeAdvOptions=this.getAdvOptions(o.kq.LANDSCAPE,this.blockIds[o.kq.LANDSCAPE]),this.additionalLandscapeBlockEnabled&&(this.landscapeAdditionalAdvOptions=this.getAdvOptions(o.kq.LANDSCAPE_ADDITIONAL,this.blockIds[o.kq.LANDSCAPE_ADDITIONAL])),this.showAdv(o.kq.LANDSCAPE))}onAdLoadFailed(e){if(ps("onAdLoadFailed",e),this.isAdditionalBlock(e))this.setShowState(e,!1);else{this.updateInAppPromoDataShowCount();const t=e===o.kq.PORTRAIT,r=e===o.kq.LANDSCAPE;this.onClose({onlyLandscape:r,onlyPortrait:t})}}destroyAdv(e){var t,r;ps("Ya.Context.AdvManager.destroy",e),null==(r=null==(t=window.Ya)?void 0:t.Context)||r.AdvManager.destroy({blockId:e})}logAdvRequest(e,t){var r;this.clickDaemon=new se.U({app_id:this.props.appId,game_id:this.props.appId,tag:o.$H.STICKY});const a=this.hasBeenShownAtLeastOnce?ie.p_.REFRESH:ie.p_.ONSPOT;this.clickDaemon.tryOpen({provider:C.e.Yandex,reason:a});const s=this.clickDaemon.copy({blockType:e});t.clickDaemon=s,null==(r=t.setRequestClickDaemon)||r.call(t,s),s.demand({advBlockId:this.blockIds[e],reason:a,provider:C.e.Yandex,depth:0}),s.request()}onScriptError({onlyLandscape:e,onlyPortrait:t}){ps("window.Ya.Context.AdvManager.render is not defined"),this.onClose({onlyPortrait:t,onlyLandscape:e})}updateInAppPromoDataShowCount(){this.isInAppPromoAdvEnabled&&((0,za.E)("sticky"),this.overrideBlockIds())}showAdv(e){return us(this,null,function*(){var t,r,a;if(this.props.advHidden)return void this.props.onAdvShowed();yield this.scriptLoadPromiseWrapper.promise;const{isDesktopAdvLoaded:s,isPortraitAdvLoaded:i,isLandscapeAdvLoaded:n}=this.loadedFlags,{canShowDesktopAdv:l,canShowPortraitAdv:c,canShowLandscapeAdv:u}=this.props;if(!(null==(a=null==(r=null==(t=window.Ya)?void 0:t.Context)?void 0:r.AdvManager)?void 0:a.render))return this.onScriptError({onlyLandscape:e===o.kq.LANDSCAPE,onlyPortrait:e===o.kq.PORTRAIT}),void this.props.onAdvShowed();let h;switch(e){case o.kq.DESKTOP:l&&!s&&(h=this.desktopAdvOptions);break;case o.kq.DESKTOP_ADDITIONAL:h=this.desktopAdditionalAdvOptions;break;case o.kq.PORTRAIT:c&&!i&&d.default.isPortrait&&(h=this.portraitAdvOptions);break;case o.kq.LANDSCAPE:u&&!n&&d.default.isLandscape&&(h=this.landscapeAdvOptions);break;case o.kq.LANDSCAPE_ADDITIONAL:h=this.landscapeAdditionalAdvOptions}h&&(this.logAdvRequest(e,h),ps(`Ya.Context.AdvManager.render ${e}`,h),e===o.kq.DESKTOP_ADDITIONAL&&this.updateInAppPromoDataShowCount(),(0,Ga.Q$)({abtFlags:this.context.abt.flags,adOptions:h,methodName:Ga.xn.RENDER,onAdLoadFailed:()=>{var t;null==(t=null==h?void 0:h.clickDaemon)||t.responseEmpty(),this.onAdLoadFailed(e)}})),this.props.onAdvShowed()})}showEventsPromoBlock(){return us(this,null,function*(){this.props.advHidden||(ps("Show events promo block"),this.setState({shouldShowEventsPromoBlock:!0}),this.updateRefreshTimer(o.kq.DESKTOP))})}hideEventsPromoBlock(){ps("Hide events promo block"),this.setState({shouldShowEventsPromoBlock:!1})}loadAdvScript(){window.yaContextCb?this.onAdvScriptLoaded():(0,Ja.x)({id:"yandexads-context",src:this.context.yaAdsScript}).then(()=>{this.onAdvScriptLoaded()}).catch(()=>{this.onAdvScriptError()})}onAdvScriptLoaded(){var e,t,r;this.loadedScript=!0,this.scriptLoadPromiseWrapper.resolve(void 0),(null==(r=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:r.render)?this.initAdvStickyBlocks():(this.rejectTimeoutId=window.setTimeout(()=>{(0,ne.H)({block:oe.W.ADV_STICKY,message:"AdvStickyBanner error [yandex]: script failed to load"}),window.clearInterval(this.checkReadyIntervalId),this.onClose({error:"script failed to load"})},this.timeToLoadAdv),this.checkReadyIntervalId=window.setInterval(()=>{var e,t,r;void 0!==(null==(r=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:r.render)&&(window.clearInterval(this.checkReadyIntervalId),window.clearTimeout(this.rejectTimeoutId),this.initAdvStickyBlocks())},200))}setShowState(e,t){switch(e){case o.kq.DESKTOP_ADDITIONAL:this.setState({showDesktopAdditional:t});break;case o.kq.LANDSCAPE_ADDITIONAL:this.setState({showLandscapeAdditional:t})}}getAdvOptions(e,t){const r=e===o.kq.LANDSCAPE,a=e===o.kq.PORTRAIT,s=this.isAdditionalBlock(e),i=s?2:1,n=this,l=(0,Ya.V)(es.Je,this.context.location);let d=this.clickDaemon;var c,u;return{async:!0,blockId:t,clickDaemon:this.clickDaemon,pageNumber:i,disableRefresh:!0,extParams:(c=ds({},l?{google_aid:l}:{}),u={utm_source_service:"games","distr-id":this.props.appId,"game-distrib-stat-id":(0,Ka.Sn)()},as(c,ss(u))),renderTo:`${this.containerIds[e]}`,statId:(0,Ka.Sn)(),onError:function(o){ps(`onError code=${o.code}, text=${o.text}, type=${o.type}`);const l=(0,Ua.M)(o,{blockId:t,pageId:i});d.error(l),s||n.updateInAppPromoDataShowCount(),s?n.setShowState(e,!1):n.onClose({error:"WRONG_DOMAIN"===o.code?l:void 0,onlyPortrait:a,onlyLandscape:r,clickDaemon:d})},onRender:function(r){ps(`onRender ${t}`,r),d.response({productType:r.productType}),n.handleAdvRender(e,r.productType,d)},setRequestClickDaemon:e=>{d=e}}}canShowEventsPromoBlock(){var e;const{appPromos:t}=this.props;return this.refreshCounters.desktop===this.eventsPromoBlockRefreshNumber&&(this.state.isWaitingForEventsToLoad||!(null==t?void 0:t.error)&&Boolean(null==(e=null==t?void 0:t.promos)?void 0:e.length))}handleAdvRender(e,t,r){this.hasBeenShownAtLeastOnce=!0;const a=()=>{r&&r.show()};switch(e){case o.kq.DESKTOP_ADDITIONAL:a();break;case o.kq.DESKTOP:{this.loadedFlags.isDesktopAdvLoaded=!0,a();let e=!1;T.U_.includes(t)||this.state.showDesktopAdditional?this.updateInAppPromoDataShowCount():(this.additionalBlockTimeoutId=window.setTimeout(()=>{this.showAdv(o.kq.DESKTOP_ADDITIONAL)},T.fE),e=!0),this.setState({showDesktopAdditional:e,showSpinner:!1});break}case o.kq.PORTRAIT:this.setState({showSpinner:!1,isPortraitMediaAdType:"direct"!==t}),this.loadedFlags.isPortraitAdvLoaded=!0,a();break;case o.kq.LANDSCAPE:let e=!1;const s="direct"!==t;!this.additionalLandscapeBlockEnabled||this.state.showLandscapeAdditional||T.iv.includes(t)||(this.additionalBlockTimeoutId=window.setTimeout(()=>this.showAdv(o.kq.LANDSCAPE_ADDITIONAL),T.fE),e=!0),this.setState({showSpinner:!1,showLandscapeAdditional:e,isLandscapeMediaAdType:s}),this.loadedFlags.isLandscapeAdvLoaded=!0,r&&r.show();break;case o.kq.LANDSCAPE_ADDITIONAL:"direct"!==t&&this.setState({isAdditionalLandscapeMediaAdType:!0}),r&&r.show()}this.updateRefreshTimer(e)}onAdvScriptError(){this.scriptLoadPromiseWrapper.reject(void 0),(0,ne.H)({block:oe.W.ADV_STICKY,message:"AdvStickyBanner error [yandex]: script failed to load"}),this.onClose({error:"script failed to load"}),this.props.onAdvShowed()}onClose(e){const t=null==e?void 0:e.clickDaemon;t&&!t.hadEvent(ie.zL.REQUEST)&&t.error("Sticky banner close without any requests."),this.props.onClose(e),t?t.close(!1):this.clickDaemon.close(!1)}renderBanner(e,t,r,s){const{canShowPortraitAdv:i,canShowLandscapeAdv:n}=this.props,{isPortraitMediaAdType:l,isLandscapeMediaAdType:d,isAdditionalLandscapeMediaAdType:c,showDesktopAdditional:u,showLandscapeAdditional:h,showSpinner:p,shouldShowEventsPromoBlock:v}=this.state,m=(0,T.oi)(r,s),g=e===o.kq.LANDSCAPE||e===o.kq.LANDSCAPE_ADDITIONAL,y=e===o.kq.PORTRAIT,f=l&&y||d&&e===o.kq.LANDSCAPE||c&&e===o.kq.LANDSCAPE_ADDITIONAL,w=v||!u&&e===o.kq.DESKTOP_ADDITIONAL||!h&&e===o.kq.LANDSCAPE_ADDITIONAL||this.props.advHidden||y&&!i||g&&!n;return(0,a.jsx)("div",{className:hs({media:Boolean(f),[e]:t,border_round:Boolean(f),hidden:w,"white-bg":this.useWhiteBackgroundOnDesktop,"middle-layer-light":this.props.isMiddleLayerShownInGame&&!this.props.darkTheme}),id:this.containerIds[e],style:m,children:!g&&(0,a.jsx)(A.y,{className:hs("spinner",{hidden:!p}),position:"center",size:28,spinning:!0},`${e}-spinner`)},e)}renderEventsPromoBlock(){var e;if(!this.state.shouldShowEventsPromoBlock)return null;if(this.state.isWaitingForEventsToLoad)return(0,a.jsx)(A.y,{className:hs("spinner"),position:"center",size:28,spinning:!0});const t=(null==(e=this.props.appPromos)?void 0:e.promos)||[];return(0,a.jsx)(qa,{actionSource:Xa.zD.gameEvent,appId:Number(this.props.appId),appPromos:t,block:Qa.Q.STICKY_PROMO,className:hs("promos"),listType:es.co.STICKY_PROMO})}renderHeader(){const{advHidden:e,canShowDesktopAdv:t,hideAdvCloseButton:r,desktopAdvWidth:s,getText:i,wrapperRef:n}=this.props,{isHeaderEnabled:o,shouldShowEventsPromoBlock:l}=this.state,d=e||!t;if(null==n?void 0:n.current){const e={width:s,marginTop:o?-this.headerHeight:0};if(l)return e.height=this.headerHeight,(0,h.createPortal)((0,a.jsx)("div",{className:hs("desktop-game-news-banner-title"),style:e,children:i("game-news.banner.title")}),n.current);if(!r&&!d)return(0,h.createPortal)((0,a.jsx)("div",{className:hs("desktop-disable-ad-button-wrapper"),style:e,children:(0,u.v_)({on:"new_platform_product_purchase"})?(0,a.jsx)(B.P,{}):(0,a.jsx)(O.Z,{})}),n.current)}return null}render(){const{advHidden:e,canShowDesktopAdv:t,hideAdvCloseButton:r,desktopAdvWidth:s,isLandscapeSide:i,mobileAdvPortraitHeight:n,stickyBannerLocation:{desktop:l,mobileLandscape:d,mobilePortrait:c}}=this.props,{isHeaderEnabled:u,shouldShowEventsPromoBlock:h}=this.state;if(l){const i={width:s,marginTop:!u||r&&!h?0:-this.headerHeight,paddingTop:!r||h?this.headerHeight:0};return(0,a.jsxs)("div",{className:hs("desktop-wrapper",{hidden:e||!t,"with-disable-ad-button":!0,"middle-layer-light":this.props.isMiddleLayerShownInGame&&!this.props.darkTheme}),style:i,children:[this.renderHeader(),this.renderEventsPromoBlock(),this.renderBanner(o.kq.DESKTOP,l,{}),this.renderBanner(o.kq.DESKTOP_ADDITIONAL,l,{})]})}return(0,a.jsxs)(a.Fragment,{children:[c&&this.renderBanner(o.kq.PORTRAIT,c,{height:n,maxHeight:n}),d&&(0,a.jsxs)("div",{className:hs("landscape-wrapper",{[d]:!0}),style:ds({},this.landscapeWrapperStyles),children:[this.renderBanner(o.kq.LANDSCAPE,d,this.landscapeBlockStyles),!i&&this.renderBanner(o.kq.LANDSCAPE_ADDITIONAL,d,this.landscapeBlockStyles)]})]})}}const ms=(0,p.$j)(function(e){var t;return{advGameCanBeLoaded:e.advGameCanBeLoaded,appPromos:e.appPromos,darkTheme:(0,nt.Up)(e),getText:e.getText,isMiddleLayerShownInGame:null==(t=e.middleLayerInGameData)?void 0:t.show}})(vs);var gs=r(87026),ys=r(62305),fs=r(94365),ws=r(86508),bs=r(6759),ks=Object.defineProperty,As=Object.defineProperties,Ss=Object.getOwnPropertyDescriptors,Ps=Object.getOwnPropertySymbols,Is=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable,Es=(e,t,r)=>t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Cs=(e,t)=>{for(var r in t||(t={}))Is.call(t,r)&&Es(e,r,t[r]);if(Ps)for(var r of Ps(t))Ts.call(t,r)&&Es(e,r,t[r]);return e},Ds=(e,t)=>As(e,Ss(t)),Rs=(e,t,r)=>(Es(e,"symbol"!=typeof t?t+"":t,r),r),xs=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const _s=(0,b.M$)("AdvStickyBannerManager",b.XG.Adv),Os="adv-sticky-banner",Ls=({width:e})=>(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:`:root { --desktop-sticky-width: ${e}px; }`}});class Bs extends Q.P{constructor(e,t){super(e,t),Rs(this,"desktopAdvWidth",T.q5),Rs(this,"mobileAdvPortraitHeight",T.qi),Rs(this,"mobileAdvLandscapeHeight",T.qi),Rs(this,"mobileAdvSideLandscapeWidth",T.HZ),Rs(this,"intervalBetweenRefreshAd",qr.yR),Rs(this,"isAdvStickyBannerEnabled",!1),Rs(this,"minScreenWidthForDesktopAdv",T.ie),Rs(this,"headerSelector"),Rs(this,"middleLayerInGameSelector"),Rs(this,"isAdvStickyEnabledOnStartByExp",!1),Rs(this,"isStickyDisabledInFullscreenMode",!0),Rs(this,"minHeightToHidePortraitAdv"),Rs(this,"minHeightToHideLandscapeAdv"),Rs(this,"forcedToHideRelatedAdv",!0===(0,fe.RM)(this.context.abt.flags,we.Z.advStickyBannerForcedHideAd)),Rs(this,"adClosed",!1),Rs(this,"useHighPortraitBlockIds",!1),Rs(this,"isLandscapeSide",!1),Rs(this,"stickyBannerLocation",{desktop:null,mobileLandscape:null,mobilePortrait:null}),Rs(this,"services",[]),Rs(this,"isPublift"),Rs(this,"isAdsense"),Rs(this,"isGoogle"),Rs(this,"isNative"),Rs(this,"isParentWindow"),Rs(this,"isYandex"),Rs(this,"isGoogleExp",(0,Br.O_)(this.context.abt.flags)),Rs(this,"isYandexExp",(0,Br.MH)(this.context.abt.flags)),Rs(this,"stickyWaterfall",[]),Rs(this,"hasPromoFallback"),Rs(this,"onStickyBannerMessage",e=>xs(this,null,function*(){const{action:t,data:r}=e.data;"blur"===(null==r?void 0:r.reason)&&this.setState({isPageBlured:"hide"===t})})),Rs(this,"onExternalMessage",(e,t)=>xs(this,null,function*(){const{action:r}=e.data;switch(r){case"adv-show-sticky-banner":if(_s(`onExternalMessage: action: "${r}"`),this.adClosed=!1,!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:o.$R.ADV_IS_NOT_CONNECTED}});if(!this.canShowAdv())return void t({data:{stickyAdvIsShowing:!1,reason:o.$R.UNKNOWN}});this.initAdv(()=>{const e=this.state.canShowAdvStickyBanner?{}:{reason:o.$R.UNKNOWN};t({data:Cs({stickyAdvIsShowing:this.state.canShowAdvStickyBanner},e)})});break;case"adv-hide-sticky-banner":_s(`onExternalMessage: action: "${r}"`),this.adClosed=!0,this.hideAdv(),t({data:{stickyAdvIsShowing:!1}});break;case"adv-status-sticky-banner":{if(!this.isAdvStickyBannerEnabled)return void t({data:{stickyAdvIsShowing:!1,reason:o.$R.ADV_IS_NOT_CONNECTED}});const e=this.state.canShowAdvStickyBanner&&!this.state.advStickyBannerHidden;_s(`onExternalMessage: action: "${r}", stickyAdvIsShowing: ${e}`);const a=this.canShowAdv(!1,!1)||e?{}:{reason:o.$R.UNKNOWN};t({data:Cs({stickyAdvIsShowing:e},a)});break}}})),Rs(this,"handleVisibilityChange",()=>{"hidden"===(null==document?void 0:document.visibilityState)?this.setHideState(!0):this.initAdv()}),Rs(this,"handleFullscreenChange",()=>{this.props.isFullscreenActive?this.hideAdv():this.initAdv()}),Rs(this,"handleDesktopResize",()=>{window.innerWidth<=this.minScreenWidthForDesktopAdv?this.hideAdv():this.initAdv()}),Rs(this,"handleMobileResize",()=>{_s("handleMobileResize",window.innerWidth,window.innerHeight,T.rv),this.state.advStickyBannerHidden||!(0,T.JY)({forcedToHideRelatedAdv:this.forcedToHideRelatedAdv,minLandscapeHeight:this.minHeightToHideLandscapeAdv,minLandscapeWidth:this.isLandscapeSide?T.rv:void 0,minPortraitHeight:this.minHeightToHidePortraitAdv})?this.state.advStickyBannerHidden&&this.initAdv():this.hideAdv()}),Rs(this,"hideAdv",()=>{this.removeDefaultClasses(),_s("hideAdv"),this.setState({advStickyBannerHidden:!0,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInLandscape:!1,isGameFrameCanBeResizedInPortrait:!1}),ws.Z.removeResizeBlock(Os),this.removeBodyStickyResize()}),Rs(this,"handleCloseAdvWithCurrentProvider",e=>{this.handleCloseAdv(this.state.currentProvider,e)}),Rs(this,"handleCloseAdv",(e,t)=>{this.props.isAdDisabledBySubscription||!this.hasPromoFallback?(this.removeDefaultClasses(),N.Z.post({type:"sticky-manager",action:"on-hide"}),(null==t?void 0:t.onlyPortrait)&&(this.setState({isGameFrameCanBeResizedInPortrait:!1}),d.default.isPortrait&&(ws.Z.removeResizeBlock(Os),this.removeBodyStickyResize())),(null==t?void 0:t.onlyLandscape)&&(this.setState({isGameFrameCanBeResizedInLandscape:!1}),d.default.isLandscape&&(ws.Z.removeResizeBlock(Os),this.removeBodyStickyResize())),this.state.isGameFrameCanBeResizedInLandscape&&(null==t?void 0:t.onlyPortrait)||this.state.isGameFrameCanBeResizedInPortrait&&(null==t?void 0:t.onlyLandscape)||((0,h.flushSync)(()=>this.setState({advClosedByError:Boolean(null==t?void 0:t.error),canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:!1,isGameFrameCanBeResizedInPortrait:!1,isGameFrameCanBeResizedInLandscape:!1})),ws.Z.removeResizeBlock(Os),this.removeBodyStickyResize(),this.adClosed=!0)):e&&e!==this.state.currentProvider||this.setState({currentProvider:this.getNextProvider()})});const{gameSettings:{features:r,settings:a},gameInfo:{appId:s},request:{flags:i}}=this.context.playPageData,{stickyAdv:n}=(0,ct.HX)();var l;this.hasPromoFallback=(l=null==n?void 0:n.blocks,Object.values(l||{}).some(e=>e.waterfall.some(e=>e.provider===J.oO.PromoBlock))),this.headerSelector="minified"===e.headerType?".play-game-minified-header":".play-game-header",this.middleLayerInGameSelector=`.${ha.P}`;const{adv:c,stickyAdvDisabledOnStart:p}=(0,T.Lf)(a);this.isAdvStickyEnabledOnStartByExp=(0,T.KV)({isDesktop:!0,flags:i}),this.isAdvStickyBannerEnabled=!this.isParentWindow&&(this.isAdvStickyEnabledOnStartByExp||(0,T.uk)({adv:c,appId:s,isDesktop:!0,flags:i,orientation:null==r?void 0:r.orientation,blockedPlacements:this.context.advPartnerInfo.blockedPlacements})),this.isStickyDisabledInFullscreenMode=(0,u.v_)({off:"show_sticky_in_fullscreen_game_mode"});const v=(0,fe.$9)(i,we.Z.advStickyMinDesktopWidth);if(v&&(this.minScreenWidthForDesktopAdv=v),!c)return void(this.isAdvStickyBannerEnabled=!1);const m=(0,T.jx)({adv:c,flags:i,appId:s,orientation:null==r?void 0:r.orientation});this.state={advClosedByError:!1,advStickyBannerHidden:!this.canShowAdv(),canShowAdvStickyBanner:!1,isGameFrameCanBeResizedInDesktop:Boolean(m.desktop),isGameFrameCanBeResizedInLandscape:Boolean(m.mobileLandscape),isGameFrameCanBeResizedInPortrait:Boolean(m.mobilePortrait),isPageBlured:!1,currentProvider:null};{const e=this.isAdvStickyEnabledOnStartByExp?D.rq.RIGHT:m.desktop;this.stickyBannerLocation={desktop:e,mobilePortrait:null,mobileLandscape:null}}this.adClosed=p&&!this.isAdvStickyEnabledOnStartByExp}addBodyStickyReady(){document.body.classList.add(bs.S.ready)}addBodyStickyResize(){document.body.classList.add(bs.S.resize)}removeBodyStickyResize(){document.body.classList.remove(bs.S.resize)}canShowAdv(e=!0,t=!0){var r,a;const{abt:s,playPageData:i,advPartnerInfo:l}=this.context,{settings:d}=i.gameSettings,{adv:c}=(0,T.Lf)(d);if(!c)return!1;if((0,fs._G)())return!0;if((0,ys.W)(s.flags,o.By.STICKY,l.blockedPlacements))return!1;if(_s(`services = ${this.services}`),0===this.services.length)return!1;const u=this.isDisabledBySubscription();if(_s([`\nisAdDisabledBySubsciption = ${u}`,`\nadvDisabledByPartner = ${!this.props.advEnabledByPartner}`,`settings.adv = ${JSON.stringify(null==d?void 0:d.adv,null,2)}`].join("\n")),u||!this.props.advEnabledByPartner)return this.removeDefaultClasses(),!1;const h=n.parse(this.props.location.search.slice(1)),p="object"==typeof(v=(0,Ya.V)("utm_medium"))?v[0]:v;var v;const m=(0,Ya.V)("clid")||(null==(r=window.YandexGamesSDK)?void 0:r.clid);return _s(`params.clid = ${h.clid},\n\n            window.YandexGamesSDK.clid = ${null==(a=window.YandexGamesSDK)?void 0:a.clid},\n\n            clid = ${m},\n\n            utmMedium = ${p}\n        `),this.props.isFullscreenActive&&this.isStickyDisabledInFullscreenMode?(_s("Desktop on fullscreen mode"),e&&(0,ne.H)({block:oe.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop window on fullscreen mode",level:"info"}),!1):window.innerWidth<=this.minScreenWidthForDesktopAdv?(_s("Desktop width too narrow"),e&&(0,ne.H)({block:oe.W.ADV_STICKY,message:"AdvStickyBanner error: Desktop width too narrow",level:"info"}),!1):!(this.state.advClosedByError||t&&this.adClosed)}componentDidMount(){var e,t;const{allAdvBlocks:r,playPageData:a,abt:{flags:s},isGamesApp:i,isGamesLiteApp:n,isIOSGamesLiteApp:o,withWorldWideAdv:l}=this.context,{gameSettings:{settings:c}}=a,{adv:u,stickyAdvDisabledOnStart:h}=(0,T.Lf)(c);if(!u||!this.isAdvStickyBannerEnabled)return void this.removeDefaultClasses();const{stickyAdv:p,options:v}=(0,ct.HX)();(null==p?void 0:p.refreshInterval)&&(this.intervalBetweenRefreshAd=p.refreshInterval),(0,T.Ne)("canShow",{height:window.innerHeight,minScreenWidthForDesktopAdv:this.minScreenWidthForDesktopAdv,width:window.innerWidth}),this.services=(0,T.g)({advBlocks:r,flags:s,isGamesApp:i,isGamesLiteApp:n,isIOSGamesLiteApp:o,trafficSplitProvider:null==v?void 0:v.trafficSplitProvider,withWorldWideAdv:l}),this.isPublift=this.services.includes(C.e.PubliftZone),this.isAdsense=this.services.includes(C.e.Adsense),this.isGoogle=this.services.includes(C.e.Google),this.isNative=this.services.includes(C.e.Native),this.isParentWindow=this.services.includes(C.e.ParentWindow),this.isYandex=this.services.includes(C.e.Yandex),this.stickyWaterfall=function(e){const{flags:t,services:r,withPromo:a}=e,s=(0,fe.QR)(t,we.Z.advStickyBannerWaterfall);return Array.isArray(s)?s.filter(e=>e.provider).map(e=>e.provider):a?[...r,C.e.Promo]:r}({flags:s,services:this.services,withPromo:this.hasPromoFallback}),this.isNative&&!(0,gs.zg)(T.XK)||this.initAdvSizeParams(),this.initExperimentParams(),this.validateAdvSize();const{desktop:m,mobilePortrait:g,mobileLandscape:y}=this.stickyBannerLocation;if(document.body.classList.add("sticky-inited"),m){if(this.addBodyStickyReady(),!(null==(t=null==(e=u.sticky)?void 0:e.desktop)?void 0:t.right)&&!this.isAdvStickyEnabledOnStartByExp)return;return h&&!this.isAdvStickyEnabledOnStartByExp||this.initAdv(),this.initMessaging(),window.addEventListener("resize",this.handleDesktopResize),n||document.addEventListener("visibilitychange",this.handleVisibilityChange),void this.setState({currentProvider:this.getNextProvider()})}(g||y)&&(this.isLandscapeSide=y===D.Xn.LEFT||y===D.Xn.RIGHT,h||this.initAdv(),!this.isNative&&(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.mobileAdvSideLandscapeWidth)&&window.addEventListener("resize",this.handleMobileResize),d.default.addChangeListener(()=>{(this.minHeightToHidePortraitAdv||this.minHeightToHideLandscapeAdv||this.isNative)&&this.handleMobileResize(),this.isNative||this.state.advStickyBannerHidden||!this.state.canShowAdvStickyBanner||this.resizeMobileGameBlock()}),this.initMessaging(),n||document.addEventListener("visibilitychange",this.handleVisibilityChange)),this.addBodyStickyReady(),this.setState({currentProvider:this.getNextProvider()})}componentDidUpdate(e,t){e.isFullscreenActive!==this.props.isFullscreenActive&&this.isStickyDisabledInFullscreenMode&&this.handleFullscreenChange(),t.advStickyBannerHidden!==this.state.advStickyBannerHidden&&N.Z.post({type:"sticky-manager",action:this.state.advStickyBannerHidden?"on-hide":"on-show"}),this.props.advEnabledByPartner&&!e.advEnabledByPartner&&this.initAdv(),e.isAdDisabledBySubscription!==this.props.isAdDisabledBySubscription&&this.isDisabledBySubscription()&&this.state.canShowAdvStickyBanner&&this.handleCloseAdv(null)}get isFullscreenEnabled(){return Boolean(this.props.isFullscreenEnabled||c.w.available||(null==document?void 0:document[xa.Z.fullscreenEnabled]))}addDesktopResize(){if((0,u.v_)({on:"new_game_navigation"}))return;const e=-this.desktopAdvWidth,t={width:e};ws.Z.addResizeBlock(Os,{game:t,[`.${Ra.Ek}`]:{width:e-Ra.UG},[this.headerSelector]:t,".game-header":t,[this.middleLayerInGameSelector]:t}),this.addBodyStickyResize()}initContainerToDisplayAdv(){if(this.isNative)return;if(this.isParentWindow)return;const{desktop:e}=this.stickyBannerLocation;if(e)return this.addDesktopResize(),this.removeDefaultClasses(),void((0,u.v_)({on:"new_game_navigation"})&&N.Z.post({type:"sticky-manager",action:"on-show"}));this.resizeMobileGameBlock()}initMessaging(){N.Z.onAllMessages("adv-manager",this.onExternalMessage),(0,fe.bF)(this.context.abt.flags)&&N.Z.onInternalMessage("sticky-banner",this.onStickyBannerMessage)}initAdvSizeParams(){!(0,u.v_)({on:"new_game_navigation"})&&this.isAdsense&&(this.desktopAdvWidth=Math.max(this.desktopAdvWidth,Mt.K))}setPortraitHeightForHighDevices(e){var t,r;const a=null==(r=null==(t=e.mobile)?void 0:t.sticky_mobile_bottom_wide)?void 0:r.height;this.isYandex&&a?this.mobileAdvPortraitHeight=a:this.mobileAdvPortraitHeight=T.RH}setPortraitHeightForRegularDevices(e){var t,r;const a=null==(r=null==(t=e.mobile)?void 0:t.sticky_mobile_bottom)?void 0:r.height;a&&this.isYandex&&(this.mobileAdvPortraitHeight=a)}initExperimentParams(){const{flags:e}=this.context.abt,t=(0,fe.$9)(e,we.Z.advStickyBannerDesktopWidth),r=(0,fe.$9)(e,we.Z.advStickyBannerPortraitHeight),a=(0,fe.$9)(e,we.Z.advStickyBannerLandscapeHeight),s=(0,fe.$9)(e,we.Z.advStickyBannerLandscapeWidth),i=(0,fe.$9)(e,we.Z.advStickyBannerMinPortraitViewportHeight),n=(0,fe.$9)(e,we.Z.advStickyBannerMinLandscapeViewportHeight);t&&(this.desktopAdvWidth=t),r&&(this.mobileAdvPortraitHeight=r),a&&(this.mobileAdvLandscapeHeight=a),i&&(this.minHeightToHidePortraitAdv=i),n&&(this.minHeightToHideLandscapeAdv=n),s&&(this.mobileAdvSideLandscapeWidth=s)}validateAdvSize(){if(this.isParentWindow)return this.desktopAdvWidth=0,this.mobileAdvPortraitHeight=0,void(this.mobileAdvLandscapeHeight=0);this.desktopAdvWidth=Math.floor(Math.min(Math.max(this.desktopAdvWidth,T.Ic),T.q5)),T.RH<this.mobileAdvPortraitHeight&&(this.mobileAdvPortraitHeight=T.qi),T.VT<this.mobileAdvLandscapeHeight&&(this.mobileAdvLandscapeHeight=T.qi)}resizeMobileGameBlock(){const{mobilePortrait:e,mobileLandscape:t}=this.stickyBannerLocation,{isGameFrameCanBeResizedInPortrait:r,isGameFrameCanBeResizedInLandscape:a}=this.state;if(!r&&d.default.isPortrait||!a&&d.default.isLandscape)return ws.Z.removeResizeBlock(Os),this.removeBodyStickyResize(),void this.removeDefaultClasses();const s=this.isLandscapeSide?this.mobileAdvSideLandscapeWidth:this.mobileAdvLandscapeHeight,i=d.default.isPortrait?this.mobileAdvPortraitHeight:s;if(this.isLandscapeSide&&d.default.isLandscape){const e=t===D.Xn.LEFT?-i-T.gG:-i-2*T.gG;return ws.Z.addResizeBlock(Os,{game:Cs({width:e},t===D.Xn.LEFT?{left:i+T.gG}:{})}),this.removeDefaultClasses(),void this.addBodyStickyResize()}if(e===D.Xn.UPPER&&d.default.isPortrait||t===D.Xn.UPPER&&d.default.isLandscape){const e={top:i+T.gG,height:-i-T.gG};ws.Z.addResizeBlock(Os,Cs({game:e},d.default.isLandscape&&{[this.headerSelector]:e})),this.removeDefaultClasses(),this.addBodyStickyResize()}if(e===D.Xn.BOTTOM&&d.default.isPortrait||t===D.Xn.BOTTOM&&d.default.isLandscape){const e={height:-i-2*T.gG};ws.Z.addResizeBlock(Os,{game:e,[this.headerSelector]:e}),this.removeDefaultClasses(),this.addBodyStickyResize()}}isDisabledBySubscription(){return!!Boolean(this.props.userData.login)&&this.props.isAdDisabledBySubscription}initAdv(e){const t=this.canShowAdv();if(_s("initAdv"),t&&!this.adClosed){const{desktop:t,mobileLandscape:r,mobilePortrait:a}=this.stickyBannerLocation;this.setState({advStickyBannerHidden:!1,canShowAdvStickyBanner:!0,isGameFrameCanBeResizedInDesktop:Boolean(t),isGameFrameCanBeResizedInPortrait:Boolean(a),isGameFrameCanBeResizedInLandscape:Boolean(r)},()=>{this.initContainerToDisplayAdv(),null==e||e()})}else!t&&(0,u.v_)({on:"new_game_navigation"})&&N.Z.post({type:"sticky-manager",action:"on-hide"})}setHideState(e){this.setState({advStickyBannerHidden:e})}removeDefaultClasses(){var e;"function"==typeof(null==(e=ws.Z)?void 0:e.removeDefaultClass)&&ws.Z.removeDefaultClass(["sticky-desktop","sticky-mobile"])}renderContainer(){if(!this.isAdvStickyBannerEnabled)return null;if(!this.state.canShowAdvStickyBanner)return null;if(this.isParentWindow)return null;if(!this.props.advEnabledByPartner)return null;const{appId:e}=this.context.playPageData.gameInfo,{advStickyBannerHidden:t,isGameFrameCanBeResizedInDesktop:r,isGameFrameCanBeResizedInLandscape:s,isGameFrameCanBeResizedInPortrait:i,isPageBlured:n}=this.state,o={advHidden:n||t,appId:e,intervalBetweenRefreshAd:this.intervalBetweenRefreshAd,isPageBlured:n,isLandscapeSide:this.isLandscapeSide,mobileAdvLandscapeHeight:this.mobileAdvLandscapeHeight,mobileAdvPortraitHeight:this.mobileAdvPortraitHeight,mobileAdvSideLandscapeWidth:this.mobileAdvSideLandscapeWidth,stickyBannerLocation:this.stickyBannerLocation,useHighPortraitBlockIds:this.useHighPortraitBlockIds,onAdvShowed:this.removeDefaultClasses,onClose:this.handleCloseAdvWithCurrentProvider};if(this.isNative)return(0,a.jsx)(Da,Cs({},o));const l={canShowDesktopAdv:r,canShowLandscapeAdv:s,canShowPortraitAdv:i,desktopAdvWidth:this.desktopAdvWidth,hideAdvCloseButton:this.props.hideAdvCloseButton,wrapperRef:this.props.wrapperRef};return this.hasPromoFallback?this.renderNonClosableContainer(o,l):this.isPublift?(0,a.jsx)(it,Cs(Cs({},o),l)):this.isAdsense?(0,a.jsx)(me,Cs(Cs({},o),l)):this.isGoogle?this.isGoogleExp?(0,a.jsx)(Lr,Cs(Cs({},o),l)):(0,a.jsx)(ua,Ds(Cs(Cs({},o),l),{isPageBlured:n})):this.isYandex?this.isYandexExp?(0,a.jsx)(Lr,Cs(Cs({},o),l)):(0,a.jsx)(ms,Cs(Cs({},o),l)):null}renderNonClosableContainer(e,t){return this.state.currentProvider===C.e.PubliftZone?(0,a.jsx)(it,Cs(Cs({},e),t)):this.state.currentProvider===C.e.Adsense?(0,a.jsx)(me,Cs(Cs({},e),t)):this.state.currentProvider===C.e.Google?this.isGoogleExp?(0,a.jsx)(Lr,Cs(Cs({},e),t)):(0,a.jsx)(ua,Ds(Cs(Cs({},e),t),{isPageBlured:e.isPageBlured})):this.state.currentProvider===C.e.Yandex?this.isYandexExp?(0,a.jsx)(Lr,Cs(Cs({},e),t)):(0,a.jsx)(ms,Cs(Cs({},e),t)):this.state.currentProvider===C.e.Promo?(0,a.jsx)(Za,Cs(Cs({},e),t)):null}render(){return(0,a.jsxs)("div",{className:"sticky-banner-container",children:[this.renderContainer(),(0,a.jsx)(Ls,{width:this.desktopAdvWidth})]})}getNextProvider(){const{currentProvider:e}=this.state;if(!e)return this.stickyWaterfall[0];const t=this.stickyWaterfall.indexOf(e)+1;return t>=this.stickyWaterfall.length?this.stickyWaterfall[0]:this.stickyWaterfall[t]}}const Ns=(0,l.E)((0,p.$j)(function(e){return{advEnabledByPartner:e.advPartnerInfo.advEnabledByPartner,isAdDisabledBySubscription:(0,v.Ak)(e),isFullscreenActive:e.ui.isFullscreenActive,isFullscreenEnabled:e.ui.isFullscreenEnabled,userData:e.userData}})(Bs));var js=r(90387);const Ms=i().memo(({hideAdvCloseButton:e,headerType:t,wrapperRef:r})=>(0,js.O)()?null:(0,a.jsx)(Ns,{headerType:t,hideAdvCloseButton:e,wrapperRef:r}))},25742:(e,t,r)=>{r.d(t,{Z:()=>be});var a=r(57627),s=r(72936),i=r(87363),n=r.n(i),o=r(17936),l=r(45682),d=r(74495),c=r(91435),u=Object.defineProperty,h=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,m=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))p.call(t,r)&&m(e,r,t[r]);if(h)for(var r of h(t))v.call(t,r)&&m(e,r,t[r]);return e};const y={currentShow:null},f=(0,i.createContext)({dispatch:()=>{},state:y}),w=()=>(0,i.useContext)(f).state,b=()=>(0,i.useContext)(f).dispatch,k=()=>(0,d.HX)().ingameAdv;r(66287);var A=r(36329),S=r(27987),P=r(74952),I=r(79483),T=r(86174),E=r(61283),C=r(77314),D=r(39138),R=r(43770),x=r(4522),_=r(17332),O=r(28250),L=r(60617),B=r(27390);const N="ingame-adv-block-renderer-critical-game-module__hidden--gNeAu";var j=Object.defineProperty,M=Object.defineProperties,H=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,Z=(e,t,r)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,q=(e,t)=>{for(var r in t||(t={}))F.call(t,r)&&Z(e,r,t[r]);if($)for(var r of $(t))W.call(t,r)&&Z(e,r,t[r]);return e},G=(e,t)=>M(e,H(t));const z=[I.oO.GoogleBlock],U=(0,i.forwardRef)(({provider:e,waterfallItem:t,onClick:r,onClose:l,onError:c,onRequest:u,onResponse:h,onShow:p,onFailed:v},m)=>{const g="ingame_banner_"+n().useId(),y=(0,i.useRef)(null),[f,w]=(0,i.useState)(null),b=(0,i.useRef)(null),{abt:{flags:k},location:j}=(0,C.b)(),M=(0,D.T)(),H=(0,i.useMemo)(()=>({retries:(0,T.Mi)(k),usePlaceholder:(0,L.Sf)(k),useLoader:(0,L.Z0)(k),controlsDelay:(0,L.sQ)(k),disableAdButtonEnabled:(0,L.RM)(k,B.Z.disableAdButton)||!1}),[k]),[$,F]=(0,i.useState)({isVisible:!1,showControls:!1}),W=(0,i.useCallback)(e=>{F(t=>G(q({},t),{isVisible:e}))},[]);(0,i.useImperativeHandle)(m,()=>({toggleTempRendererState:()=>{}}),[]),(0,i.useEffect)(()=>{var a;return a=function*(){var a,s,i;if((0,o._y)("IngameAdv | Create slot",t,e,y.current,!t||!e||!y.current),t&&e&&y.current&&((0,I.Qq)(t)||(0,d.W8)(t)))try{(0,o._y)("IngameAdv | Actually create slot",g,t),W(!0);const n=(0,d.W8)(t)?null!=(s=null==(a=t.blockIds.desktop)?void 0:a.blockID)?s:"":t.blockId;let l=b.current=yield e.createSlot({blockId:n,divId:g,size:[],location:j,lazyLoad:!1});if(!l)return;let c=0,v=!0;do{null==u||u({slot:l,retry:c});const t=yield e.preloadSlot({slot:l,flags:k});w("render"in t?t.render:null),null==h||h({slot:l,isEmpty:t.isEmpty},{payloadProductType:"productType"in t?null!=(i=t.productType)?i:"none":"unknown"}),t.isEmpty?(yield(0,O.D)(R.TE),c+=1):v=!1}while(e.supportsRetries&&v&&z.includes(e.providerName)&&c<H.retries);if(v)throw new P.l;F(e=>G(q({},e),{showControls:!0})),yield e.showSlot(l),null==p||p({slot:l}),e.setClickEventListener(l,()=>null==r?void 0:r({slot:l}))}catch(e){W(!1),e instanceof E.lu&&e.params.isEmpty||null==c||c({error:e,slot:null}),null==v||v({error:e})}},new Promise((e,t)=>{var r=e=>{try{i(a.next(e))}catch(e){t(e)}},s=e=>{try{i(a.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);i((a=a.apply(undefined,null)).next())}),()=>{(0,o._y)("IngameAdv | Renderer clear"),b.current&&e&&(e.destroySlot(b.current),b.current=null)}},[r,g,k,j,c,v,u,h,p,H,e,W,t]);const Z=(0,i.useCallback)(()=>{(0,o._y)("IngameAdv | onCloseButtonClick"),W(!1),b.current&&e&&e.destroySlot(b.current),null==l||l({wasShown:!0,slot:null})},[e,W,l]),U=(0,i.useCallback)(()=>{(0,_.Z)()},[]),V=(0,i.useCallback)(()=>{(0,o._y)("IngameAdv | onProviderRendererClose"),W(!1),b.current&&e&&e.destroySlot(b.current),null==l||l({wasShown:!0,slot:null})},[e,W,l]),K=0===H.controlsDelay||$.showControls;return(0,a.jsxs)("div",{className:(0,x.E)("ingame-adv-block-renderer-critical-game-module__container--iphcg",!f&&"ingame-adv-block-renderer-critical-game-module__background--lYdn0",!1,$.isVisible?"visible":N),"data-testid":"adv-fullscreen-container",children:[f&&n().cloneElement(f,{advType:s.$H.INTERSTITIAL,isVisible:$.isVisible,onClose:V}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,x.E)("ingame-adv-block-renderer-critical-game-module__desktopClose--JbUFR",K?void 0:N),"data-testid":"adv-fullscreen-close-button",onClick:Z}),H.useLoader&&(0,a.jsx)(S.y,{className:(0,x.E)("ingame-adv-block-renderer-critical-game-module__spinner--YCUw3",K?N:void 0),position:"center",size:32,spinning:!0},"landscape-spinner"),(0,a.jsx)("div",{className:(0,x.E)("ingame-adv-block-renderer-critical-game-module__block--MfkRS"),children:(0,a.jsx)("div",{id:g,ref:y})})]}),H.disableAdButtonEnabled?(0,a.jsxs)("div",{className:(0,x.E)("ingame-adv-block-renderer-critical-game-module__touchControls--hOiCr",K?void 0:N),children:[H.disableAdButtonEnabled&&(0,a.jsx)(A.z,{"data-testid":"adv-fullscreen-close-button",size:40,view:"secondary",onClick:U,children:M("header.popup.disable.ads")}),(0,a.jsx)(A.z,{"data-testid":"adv-fullscreen-close-button",size:40,view:"primary",onClick:Z,children:M("adv.close")})]}):null]})});var V=r(21798),K=r(64831);const Y=Date.now(),X=[],J=(0,i.memo)(()=>{var e;const t=k(),r=w(),n=b(),d=r.currentShow;(0,i.useEffect)(()=>{var e;if(!d||d.status!==I.mb.WaitStart)return;let a=null==(e=null==t?void 0:t[d.tag])?void 0:e.waterfall;if(a=null==a?void 0:a.filter(e=>!(e.startDelayMs&&Date.now()-Y<e.startDelayMs)),!a||0===a.length)return d.showStartedCallback(),d.advLogger.fail(`No available waterfall item for tag ${d.tag}`),void n({currentShow:null});Object.assign(d,{status:I.mb.Started,waterfallList:a}),n(r)},[d,t,r,n]);const c=(0,i.useCallback)(({retry:e})=>{null==d||d.advLogger.request({retry:e})},[d]),u=(0,i.useCallback)(({isEmpty:e})=>{e?null==d||d.advLogger.responseEmpty():null==d||d.advLogger.response()},[d]),h=(0,i.useCallback)(({error:e})=>{(0,o._y)("IngameAdv | Error | ",e),null==d||d.advLogger.error(e.message)},[d]),p=(0,i.useCallback)(()=>{null==d||d.advLogger.click()},[d]),v=(0,i.useCallback)(()=>{null==d||d.advLogger.show(),(null==d?void 0:d.tag)===s.$H.REWARDED?(0,E.UW)(l.fB.RewardedVideoCallbackOpen()):(0,E.UW)(l.fB.AdvCallbackOpen())},[d]),m=(0,i.useCallback)(()=>{null==d||d.advLogger.close(),(null==d?void 0:d.tag)===s.$H.REWARDED?(0,E.UW)(l.fB.RewardedVideoCallbackClose()):(0,E.UW)(l.fB.AdvCallbackClose({wasShown:(null==d?void 0:d.advLogger.hadEvent(K.zL.SHOW))||!1})),n({currentShow:null})},[d,n]),g=(0,i.useCallback)((e,t)=>{if((0,o._y)("IngameAdv | onWaterfallNext",e),t){const t=()=>d?d.waterfallList.indexOf(e):0;null==d||d.advLogger.waterfall({advBlockId:(0,I.Qq)(e)?e.blockId:"unknown",provider:e.provider,depth:t(),reason:K.p_.WATERFALL})}else null==d||d.advLogger.demand({advBlockId:(0,I.Qq)(e)?e.blockId:"unknown",provider:e.provider})},[d]),y=(0,i.useCallback)((e,t)=>{(0,o._y)("IngameAdv | WaterfallFailed",e,t),null==d||d.advLogger.fail(String(e)),n({currentShow:null})},[d,n]);return(0,a.jsx)(V.Z,{alwaysRender:!0,waterfallList:null!=(e=null==d?void 0:d.waterfallList)?e:X,onClick:p,onClose:m,onError:h,onRequest:c,onResponse:u,onShow:v,onWaterfallFailed:y,onWaterfallNext:g,children:(0,a.jsx)(U,{})})});class Q extends Error{constructor(){super("Cannot open the advertisement. Try again later.")}}var ee=r(2592),te=Object.defineProperty;class re extends Error{constructor(e){const t=(r=e)<ee.WT?`${r} ms`:r%ee.WT!==0?`${Math.floor(r/ee.WT)} ${r%ee.WT} ms`:r/ee.WT+" s";var r,a,s;super("Fullscreen ad skipped: too frequent requests"),((e,t,r)=>{t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(a="intervalBetweenAds")?a+"":a,s),this.intervalBetweenAds=t}}class ae extends Error{constructor(){super("Another ad already opened.")}}class se extends Error{constructor(){super("Adv disabled for this user.")}}var ie=r(78825),ne=r(3465);var oe=r(80913);var le=r(50678),de=r(13949),ce=Object.defineProperty,ue=Object.defineProperties,he=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable,ge=(e,t,r)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ye=(e,t)=>{for(var r in t||(t={}))ve.call(t,r)&&ge(e,r,t[r]);if(pe)for(var r of pe(t))me.call(t,r)&&ge(e,r,t[r]);return e},fe=(e,t)=>ue(e,he(t));const we=()=>{throw new Error("Show start callback already called.")},be=(ke=()=>{const{playPageData:{gameInfo:{appId:e}}}=(0,i.useContext)(le.Z),t=k(),r=w(),n=b();(0,i.useEffect)(()=>{var e;(e=>{if(!e)return;const t=e.findIndex(e=>e.provider===I.oO.PromoBlock&&"onboarding_block"===e.blockId);-1!==t&&((0,oe.Q)()||(e.splice(t,1),(0,o._y)("IngameAdv | Onboarding Promo waterfall item removed.")))})(null==(e=null==t?void 0:t[s.$H.INTERSTITIAL])?void 0:e.waterfall),(0,o._y)("IngameAdv | Manager init",t)},[t]);const d=(()=>{var e,t,r;const{isReady:a}=(0,ne.s)(),n=k(),o=w(),[d,c]=(0,i.useState)(!1),[u,h]=(0,i.useState)(-1),p=null!=(t=null==(e=null==n?void 0:n[s.$H.INTERSTITIAL])?void 0:e.intervalBetweenAds)?t:6e4,v=Boolean(o.currentShow&&o.currentShow.status!==I.mb.Created),m=(null==(r=null==n?void 0:n[s.$H.INTERSTITIAL])?void 0:r.disabledReason)||null;return(0,i.useEffect)(()=>{v&&p>0&&h(e=>(clearTimeout(e),window.setTimeout(()=>{h(-1)},p)))},[v,p]),(0,i.useEffect)(()=>{var e;m&&m===s.Jm.SUBSCRIPTION&&(e=m,ie.Z.postToChild(l.fB.SetDisabledState({reason:e,value:null!==e})))},[m]),(0,i.useEffect)(()=>{var e;if("undefined"==typeof window)return;const t=(null==(e=null==n?void 0:n[s.$H.INTERSTITIAL])?void 0:e.firstShowDelay)||null;if(!t)return void c(!1);c(!0);const r=window.setTimeout(()=>{c(!0)},t);return()=>{window.clearTimeout(r)}},[n]),(0,i.useMemo)(()=>{const e=v?new ae:a?null:new Q;return{[s.$H.INTERSTITIAL]:m?new se:e||(d?new Q:-1!==u?new re(p):null),[s.$H.REWARDED]:e||null}},[v,u,m,d,a,p])})(),c=(0,i.useCallback)(()=>{var e;const r=Boolean(null==(e=null==t?void 0:t[s.$H.INTERSTITIAL])?void 0:e.disabledReason);return(0,o._y)("IngameAdv | onAdvDisabledStatus",r),r},[t]),u=(0,i.useCallback)((t,r)=>{(0,o._y)("IngameAdv | onAdvShowRequest",t);const a=new de.U({tag:t,app_id:e,game_id:e});if(a.tryOpen({reason:K.p_.ONSPOT}),d[t]instanceof Error&&!(d[t]instanceof Q)){const e=d[t];return r({data:{error:e}}),void(e instanceof re?a.skip(e.message,{intervalBetweenAds:e.intervalBetweenAds}):a.fail(String(e)))}n({currentShow:{advLogger:a,tag:t,status:I.mb.Created,showStartedCallback:r,waterfallList:[]}})},[e,d,n]);return(0,i.useEffect)(()=>{const e=r.currentShow;if(!e||e.status!==I.mb.Created||d[e.tag]instanceof Error)return;e.showStartedCallback();const t=fe(ye({},e),{status:I.mb.WaitStart,showStartedCallback:we});(0,o._y)("IngameAdv | Show waiting to start",t),n(fe(ye({},r),{currentShow:t}))},[d,r,n]),(({onAdvDisabledStatus:e,onAdvShowRequest:t})=>{const r=(0,i.useRef)({onAdvDisabledStatus:()=>!1,onAdvShow:()=>(0,o._y)("IngameAdv | Called not initialized onAdvShow")});(0,i.useMemo)(()=>{r.current.onAdvDisabledStatus=e,r.current.onAdvShow=t},[e,t]),(0,i.useEffect)(()=>{const e=(e,t)=>{switch(o._y.spoiler(e,t)("IngameAdv | Received adv message",e.data.action),e.data.action){case"adv-show-fullscreen":r.current.onAdvShow(s.$H.INTERSTITIAL,t);break;case"adv-show-rewarded-video":r.current.onAdvShow(s.$H.REWARDED,t);break;case"get-disabled-state":t({data:{value:r.current.onAdvDisabledStatus()}})}};return ie.Z.onExternalMessage("adv-manager",e,{withHistory:!0}),()=>{ie.Z.offExternalMessage("adv-manager",e)}},[])})({onAdvDisabledStatus:c,onAdvShowRequest:u}),(0,a.jsx)(J,{})},e=>{const[t,r]=(0,i.useReducer)(c.Z,y);return(0,a.jsx)(f.Provider,{value:{state:t,dispatch:r},children:(0,a.jsx)(ke,g({},e))})});var ke},22854:(e,t,r)=>{r.d(t,{t:()=>l});var a=r(72936),s=r(30707),i=r(20966),n=r(97731),o=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const l=()=>o(void 0,null,function*(){"undefined"!=typeof window&&(yield(0,s.BA)(e=>o(void 0,null,function*(){var t,r;try{const s=e.getConfig("userSync"),i=e.installedModules.includes("yandexBidAdapter"),n=null!=(r=null==(t=null==s?void 0:s.userIds)?void 0:t.some(e=>e.name===a.Fd.NOVATIQ))&&r;i&&n&&"function"==typeof e.refreshUserIds&&(yield e.refreshUserIds({submoduleNames:[a.Fd.NOVATIQ]}))}catch(e){(0,i.H)({block:n.W.ADV,message:"Error updating userId via user id sub-modules"},e)}})))})},8431:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r(73571).Z},23193:(e,t,r)=>{r.d(t,{Z:()=>g});var a=r(57627),s=r(43774),i=r(36329),n=r(63904),o=r.n(n),l=r(87363),d=r(93335),c=r(38225),u=r(96533),h=r(39138),p=r(61712),v=r(45310);const m=o().with("disable-ad-button"),g=()=>{const e=(0,c.T)(),t=(0,h.T)(),r=(0,c.C)(e=>{var t;return Boolean(null==(t=e.middleLayerInGameData)?void 0:t.show)}),n=(0,c.C)(u.Up),o=(0,c.C)(e=>e.ui.isFullscreenActive),g=(0,s.v_)({on:"new_game_navigation"}),y=(0,l.useCallback)(()=>{var t;e((0,d.Lu)({isVisible:!0})),(0,p.U4)({},{borrowParams:{adv:{sticky:{disableAdButtonClick:{size:"long"}}}}}),g&&(null==(t=window.clickdaemonLog)||t.call(window,"disable_ad_button_click",{}))},[e,g]),f=(0,s.v_)({on:"new_game_navigation"}),w=(0,s.v_)({on:"new_game_desktop_header"});let b=w?32:24;return f&&(b=40),o&&w?null:(0,a.jsx)("div",{className:m({"new-navigation":f,"new-header":w}),children:!(0,v.I)()&&(0,a.jsx)(i.z,{className:m("button",{"middle-layer-light":r&&!n}),"data-testid":"disable-ad-button",rounded:w&&!f,size:b,view:f||w?"secondary":"primary",onClick:y,children:t("no-ads.disable.text")})})}},95694:(e,t,r)=>{r.d(t,{Z:()=>W});var a=r(57627),s=r(86200),i=r(60362),n=r(63904),o=r.n(n),l=r(87363),d=r(93335),c=r(38225),u=r(2592);i.ur.GameReady;const h={"adv-show-fullscreen":{messageType:"adv-manager",hideReason:"advertisement"},[i.ur.GameReady]:{messageType:"game-measuring",hideReason:"gameReady"}},p=[i.ur.GameInit,i.ur.GameReady,i.ur.GameReadyForce],v=()=>["adv-show-fullscreen",i.ur.GameReady],m=10*u.WT,g=e=>()=>e?Date.now()-e:null;var y=r(78825),f=r(84791),w=r(87125);const b=(0,w.M$)("SplashScreen",w.XG.Dev);var k=r(43774),A=r(27987),S=r(77314),P=r(39138),I=r(71592),T=r(74516),E=r(17034),C=Object.defineProperty,D=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,_=(e,t,r)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const O=o().with("preloading-content"),L=({onClick:e,iconSize:t,withBlur:r=!0})=>{var s;const i=(0,S.b)(),n=(0,P.T)()("common.loading"),{playPageData:o,isSlowCountry:d,cdnUrl:c}=i,u=null==(s=o.gameData)?void 0:s.media,h=(0,l.useRef)(null),[p]=function(e,t){const[r,a]=(0,l.useState)(!1),s=()=>{a(!0)};return(0,l.useEffect)(()=>{var a,i;!r&&(null==(a=null==e?void 0:e.current)?void 0:a.complete)&&(t&&(0,I.bS)(t,null==(i=null==e?void 0:e.current)?void 0:i.src),s())}),[s,r]}(h,"splash-screen"),v=d?T.KL.default84x84:t||T.KL.pjpg128x128,m=(0,T.Jn)(u||{},((e,t)=>{for(var r in t||(t={}))R.call(t,r)&&_(e,r,t[r]);if(D)for(var r of D(t))x.call(t,r)&&_(e,r,t[r]);return e})({size:v},(0,E.R)(d)?{cdnUrl:c}:{}));if(!u)return(0,a.jsx)(A.y,{size:46,spinning:!0});const g={filter:r?`drop-shadow(0px 0px 70px ${u.icon.mainColor})`:void 0,backgroundColor:(0,T.jl)(u,{size:v})};return(0,a.jsx)("div",{className:O(),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{alt:o.gameTitle,className:O("game-icon",{clickable:Boolean(e)}),crossOrigin:"anonymous",fetchPriority:"high",loading:"eager",ref:h,src:m,style:g,title:o.gameTitle,onClick:e,onLoad:p}),(0,a.jsx)("div",{className:O("text"),children:n})]})})};var B=r(3465),N=r(34083),j=r(60617),M=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const H=o().with("game-loader"),$=()=>{y.Z.post({type:"splash",action:"set-was-closed"})},F=()=>{const e=(0,S.b)(),{abt:{flags:t},playPageData:r}=e,{setIsReady:s}=(0,B.s)(),{isLoadingDelayPassed:n,shouldDelayLoading:o}=(({onTimeoutEndCallback:e,playPageData:t})=>{var r;const a=null==(r=null==t?void 0:t.gameData)?void 0:r.slowdown,[s,i]=(0,l.useState)(!a),n=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(a)return n.current=setTimeout(()=>{i(!0),n.current=null,null==e||e()},a),()=>{n.current&&clearTimeout(n.current)}},[a,e]),a||!(0,k.v_)({on:"game_load_slowdown.first_visit"})&&!(0,k.v_)({on:"game_load_slowdown.visited"})||null==e||e(),{isLoadingDelayPassed:s,shouldDelayLoading:Boolean(a)}})({onTimeoutEndCallback:$,playPageData:r}),u=(0,c.T)(),[A,P]=(0,l.useState)(!1),[I,T]=(0,l.useState)(null),E=(0,l.useRef)(null),C=(0,l.useCallback)(()=>{T("click")},[]),D=(0,j.Rg)(t),R=(0,l.useRef)(null),{hideGameLoaderCallback:x}=(()=>{const e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!w.HQ)return;e.current=Date.now();const t=g(e.current),r=e=>{b("onGameMeasuringEvent",e.data.action)};return y.Z.onExternalMessage("game-measuring",r),(0,f.EE)(()=>b("waitTTI",t())),(0,f.UQ)(()=>b("waitAllTTI",t())),()=>{y.Z.offInternalMessage("game-measuring",r)}},[]),{mountedTime:e,hideGameLoaderCallback:t=>{const r=g(e.current)();b(`Splash screen hide by ${t}. elapsed time: ${r}`)}}})(),_=(0,l.useCallback)(()=>M(void 0,null,function*(){const e=new Promise(e=>M(void 0,null,function*(){y.Z.onExternalMessage("game-measuring",t=>{p.includes(t.data.action)&&e(t.data.action)}),(0,f.UQ)(()=>e("waitAllTTI")),(yield(0,N.y)())&&(0,f.EE)(()=>e("waitTTI"))})),t=new Promise(e=>{(0,f.EE)(()=>e("waitTTI"))}),[r]=yield Promise.all([e,t]);return r}),[]);return(0,l.useEffect)(()=>{A&&u((0,d.zu)(!0))},[u,A]),(0,l.useEffect)(()=>{var e,t,r,a,s;if(o&&n)return void T("timeout from backend");const l=v(),d=null==(s=null==(a=null==(r=null==(t=null==(e=window.earlyEvents)?void 0:e.messages)?void 0:t.find(e=>{var t,r;return l.includes(null==(r=null==(t=e.data)?void 0:t.originalEvent)?void 0:r.action)}))?void 0:r.data)?void 0:a.originalEvent)?void 0:s.action;d&&n?T(h[d].hideReason):l.includes(i.ur.GameReady)&&n&&_().then(e=>{T(e)})},[_,n,o]),(0,l.useEffect)(()=>{if(!A&&n){const e=["adv-manager","game-measuring"],t=v(),r=e=>{const{action:r}=e.data;t.includes(r)&&T(h[r].hideReason)};return y.Z.onAllMessages(e,r),()=>{R.current&&y.Z.offAllMessages(e,r)}}},[A,n]),(0,l.useEffect)(()=>{A&&E.current&&clearTimeout(E.current)},[A]),(0,l.useEffect)(()=>{E.current=setTimeout(()=>{T("timeout"),E.current=null},m)},[r.gameInfo.appId]),(0,l.useEffect)(()=>{!R.current&&I&&n&&(R.current=I,y.Z.post({type:"document-events",action:"hide-splash-screen"}),s(!0),setTimeout(()=>{P(!0),x(I)},250))},[I,t,s,x,n]),A?null:(0,a.jsx)("div",{className:H({hidden:Boolean(I),transparent:D}),"data-type":"game-loader",onClick:C,children:(0,a.jsx)(L,{})})},W=()=>(0,s.$)()?(0,a.jsx)(F,{}):null},87345:(e,t,r)=>{r.d(t,{Z:()=>w});var a=r(57627),s=r(89131),i=r(36329),n=r(63904),o=r.n(n),l=r(87363),d=r(30928),c=r(50678),u=r(55990),h=r(4522),p=r(55222),v=r(36850),m=Object.defineProperty,g=(e,t,r)=>(((e,t,r)=>{t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const y=o().with("game-play-button");class f extends l.Component{constructor(){super(...arguments),g(this,"handleClick",e=>{const{onClick:t}=this.props;(0,v.D)(()=>{t(e)})})}render(){const{url:e,mix:t,size:r,disabled:s,buttonTextKey:n,getText:o,iconLeft:l,text:d}=this.props,{oneTabPWA:c}=this.context,v=Boolean(e),m=v?e:void 0,g=(0,h.E)(y({size:r}),t);return(0,a.jsx)(i.z,{className:g,"data-guard-accept":"play_button",disabled:s,href:m,iconLeft:l&&(0,a.jsx)(u.Z,{type:l}),size:40,target:(0,p.AO)({oneTabPWA:c}),type:v?"link":void 0,view:"primary",onClick:this.handleClick,children:d||o(n)})}}g(f,"defaultProps",{disabled:!1,onClick:()=>{},mix:""}),g(f,"contextType",c.Z);const w=(0,s.E)((0,d.$j)(function(e){return{buttonTextKey:`common.play.vertical-${e.vertical.verticalName}`,getText:e.getText}})(f))},95523:(e,t,r)=>{r.d(t,{E6:()=>s,Oe:()=>n,Tp:()=>i,XB:()=>a});var a=(e=>(e.DEBUG="debug",e.ERROR="error",e.INFO="info",e.WARN="warn",e))(a||{});const s=1e4,i=200,n=10},88866:(e,t,r)=>{r.d(t,{Z:()=>m});var a=r(57627),s=r(36329),i=r(63904),n=r.n(i),o=r(87363),l=r(30928),d=r(74344),c=r(95523),u=Object.defineProperty,h=(e,t,r)=>(((e,t,r)=>{t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const p=n().with("message-box");class v extends o.PureComponent{constructor(){super(...arguments),h(this,"state",{destroyed:!1,visible:!1}),h(this,"destroyTimer"),h(this,"hidingTimer"),h(this,"openingTimer"),h(this,"handleClick",()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onClick)||t.call(e)}),h(this,"onSnooze",()=>{var e,t;this.toggleVisibility(!1),null==(t=(e=this.props).onSnooze)||t.call(e)})}componentDidMount(){const{autohide:e}=this.props;this.openingTimer=window.setTimeout(()=>this.toggleVisibility(!0),c.Oe),e&&(this.hidingTimer=window.setTimeout(()=>this.toggleVisibility(!1),c.E6))}componentWillUnmount(){window.clearTimeout(this.openingTimer),this.hidingTimer&&window.clearTimeout(this.hidingTimer),this.destroyTimer&&window.clearTimeout(this.destroyTimer)}toggleVisibility(e){var t,r;this.setState({visible:e}),e||(null==(r=(t=this.props).onClose)||r.call(t),this.destroyTimer=window.setTimeout(()=>{this.setState({destroyed:!0})},c.Tp))}renderSnoozeButton(){return this.props.onSnooze?(0,a.jsxs)(s.z,{className:p("snooze"),rounded:!0,size:24,view:"secondary",onClick:this.onSnooze,children:["ðŸ˜´ ",(0,a.jsx)("span",{className:p("snooze-title"),children:this.props.getText("common.hide").toLowerCase()})]}):null}renderCloseButton(){return this.props.withCloseButton?(0,a.jsx)(d.Z,{type:"popup",onClick:this.handleClick}):null}renderContent(){return(0,a.jsx)("div",{className:p("content"),onClick:this.handleClick,children:this.props.children})}render(){const{level:e=c.XB.INFO}=this.props,{destroyed:t,visible:r}=this.state;return t?null:(0,a.jsxs)("div",{className:p({level:e,visible:r}),children:[this.renderSnoozeButton(),this.renderCloseButton(),this.renderContent()]})}}const m=(0,l.$j)(function(e){return{getText:e.getText}})(v)},86174:(e,t,r)=>{r.d(t,{Hc:()=>u,Mi:()=>d,ZJ:()=>i,ck:()=>c,k4:()=>o,uK:()=>l,uy:()=>n});var a=r(60617),s=r(27390);function i(e){return!1===(0,a.RM)(e,s.Z.enablePreloadNativeFullscreen)}function n(e){return!1===(0,a.RM)(e,s.Z.enablePreloadNativeFullscreenOnStart)}function o(e){return!1===(0,a.RM)(e,s.Z.enablePreloadNativeRewarded)}function l(e){return!1===(0,a.RM)(e,s.Z.enablePreloadNativeRewardedOnStart)}const d=e=>{var t;return null!=(t=(0,a.$9)(e,s.Z.advGoogleInterstitialRetries))?t:2},c=e=>{var t;return null!=(t=(0,a.$9)(e,s.Z.advGoogleRewardedRetries))?t:0},u=e=>{var t;return null!=(t=(0,a.RM)(e,s.Z.advGoogleInstreamResponsiveContainer))&&t}},61283:(e,t,r)=>{r.d(t,{lu:()=>ae,KW:()=>me,Sn:()=>ye,fl:()=>ge,$3:()=>J,ss:()=>ne,tq:()=>ie,dh:()=>le,mx:()=>oe,el:()=>ue,TE:()=>de,zw:()=>ee,PS:()=>te,uD:()=>he,g5:()=>ce,ey:()=>U,UW:()=>ve,SW:()=>Q,R4:()=>V,J4:()=>re,U2:()=>Y,gp:()=>pe,WL:()=>X});var a=r(45682),s=r(83243),i=r(66287),n=r(58780),o=r(59459),l=r(83592),d=r(78825),c=Object.defineProperty,u=Object.defineProperties,h=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,g=(e,t,r)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))v.call(t,r)&&g(e,r,t[r]);if(p)for(var r of p(t))m.call(t,r)&&g(e,r,t[r]);return e},f=(e,t)=>u(e,h(t));function w(e){if(!(e instanceof Error))try{e=new Error(String(e))}catch(t){e=new Error("Unknown error object")}return f(y({},JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))),{stack:e.stack,name:e.name})}const b={gamesApp:{worldWide:72e3,default:12e4},web:{worldWide:6e4,default:6e4}};var k=r(32221),A=r(72936),S=r(60971),P=r(83959),I=r(61712),T=r(99083),E=r(20966),C=r(29513),D=r(97731),R=r(60617),x=r(27390),_=r(99251),O=r(33376),L=r(50337),B=Object.defineProperty,N=Object.defineProperties,j=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,F=(e,t,r)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,W=(e,t)=>{for(var r in t||(t={}))H.call(t,r)&&F(e,r,t[r]);if(M)for(var r of M(t))$.call(t,r)&&F(e,r,t[r]);return e},Z=(e,t)=>N(e,j(t)),q=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const G=-90,z=90;function U(e){console.warn("There is no partnerID: partnerId provides only on link in console. If you opened link from console then accept agreement in admin panel"),(0,I.U4)({},{borrowParams:{advPartnerErrorData:{appId:e},errorText:"Empty partnerId"}})}function V(){const e=(0,k.Z)({url:(0,_.e)().href,removed:["a_delay"]});window.history.replaceState(null,document.title,e)}function K(){(0,o.q)("sendAdvClickGoal"),(0,I.NF)({},O.Ji.ADV_CLICK,{advType:"game",sdkVersion:2})}function Y(e,t){d.Z.post({type:"adv-debug-info",action:"set-debug-adv-block",data:{type:e,id:t}})}function X(){d.Z.post({type:"adv-debug-info",action:"show-debug-info"})}function J(e,t,r){var a;const i=null!=(a=(0,R.mn)(r,`adv-blocks:${t}`))?a:(0,R.mn)(r,"adv-blocks");return i&&"object"==typeof i?i.desktop&&"object"==typeof i.desktop||i.mobile&&"object"==typeof i.mobile||i.native&&"object"==typeof i.native?(0,s.T)(e,W(W(W({},i.desktop&&{desktop:i.desktop}),i.mobile&&{mobile:i.mobile}),i.native&&{native:i.native})):((0,E.H)({block:D.W.ADV},new Error(`Invalid "adv-blocks" experiment format:', ${i}`)),e):e}function Q(e){if((0,T.qo)()){const t=e.style;t.width=`${window.innerWidth}px`,t.height=`${window.innerHeight}px`}const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`);const r=window.pageYOffset;return window.scroll(0,0),r}function ee(){function e(){const e=window.orientation;e===z?document.documentElement.style.removeProperty("--iphone-bangs-adv-padding-left"):document.documentElement.style.setProperty("--iphone-bangs-adv-padding-left","0"),e===G?document.documentElement.style.setProperty("--iphone-bangs-padding-right","0.8"):document.documentElement.style.setProperty("--iphone-bangs-padding-right","0")}e(),i.default.addChangeListener(e)}function te(){d.Z.post({type:"adv-debug-info",action:"hide-debug-info"})}function re(e,t){const r=t.querySelector(`.${e.modalContent}`);if(r){const e=r.firstElementChild;e&&e.addEventListener("click",K,!0)}}class ae extends Error{constructor(e,t={isEmpty:!1,isFinal:!1,wasShown:!1}){super(e),this.params=t}}function se(e){try{return String(e.message||e).substring(0,100)}catch(e){}return""}function ie(e,t){return(...r)=>{try{if("function"!=typeof e)throw new Error("fn must be a function");return e(...r)}catch(e){(0,E.H)({block:D.W.ADV,additional:{origError:se(e)},message:t},e)}}}function ne(e){const{advElement:t,type:r,flags:a,appId:s,isIOS:i}=e,o=a[`no_click_${r}:${s}`]||a[`no_click_${r}`]||(i?100:0);if(!o)return;if(!t)return void(0,E.H)({block:D.W.ADV},new Error("Cannot place no click overlay - advElement is null"));const l=document.createElement("div");l.className=n.kn.noClickOverlay,t.appendChild(l),setTimeout(()=>{t.removeChild(l)},o)}function oe(e,t,r){const a=(0,R.$9)(t,x.Z.newAdvInterval);return"number"==typeof a?a:!S.XK&&parseInt(e||"0",10)||((s={withWorldWideAdv:Boolean(r),isGamesApp:(0,T.VP)()}).isGamesApp?s.withWorldWideAdv?b.gamesApp.worldWide:b.gamesApp.default:s.withWorldWideAdv?b.web.worldWide:b.web.default);var s}function le(e){if(e){const t=parseInt(e,10)||0;if(t>0)return t}const t=(0,P.V)("utm_source");return t&&["adv","google","yandex"].includes(t)?C.JH:0}function de(e){return`play-modal_view-type_${e}`}function ce(e,t){!function(e){const{error:t}=e;if(function(e){return e&&"object"==typeof e&&"getMessage"in e&&"function"==typeof e.getMessage&&"getErrorCode"in e&&"function"==typeof e.getErrorCode}(t)){const r=`AdError ${t.getErrorCode()}`;null!=e.additional||(e.additional={}),e.additional.message=t.getMessage(),e.error=new Error(r)}}(t);const{additional:r,name:a,error:s,tag:i}=t;(0,E.H)({block:D.W.ADV,prefix:`${n.yt}: `,additional:{adv:Z(W({},r),{name:a,service:e.serviceName,tag:i})}},s)}function ue(e){return`${n.kn.modal}_${e}`}function he(e,t,r){var a;const s=null!=(a=t.getTimeoutExtraTime(l.QA.ServiceInit,r))?a:0;let i=(0,R.$9)(e,x.Z.adScriptInitTimeout)||3500+s;const n=(0,R.$9)(e,`adv_${t.serviceName}_init_timeout`);return void 0!==n&&(i=n+s,s&&(0,o.q)(`Note: Service ${t.serviceName} added extra init timeout: ${s} (total: ${i})`)),i}function pe(e,t,r,a){var s;const i=null!=(s=r.getTimeoutExtraTime(t===A.$H.INTERSTITIAL?l.QA.ShowFullscreen:l.QA.ShowRewarded,a))?s:0;let d=(t===A.$H.INTERSTITIAL?n.hL:n.UG)+i;const c=(0,R.$9)(e,`adv_${r.serviceName}_show_timeout`);return void 0!==c&&(d=c+i,i&&(0,o.q)(`Note: Service ${r.serviceName} added extra showAdv timeout: ${i} (total: ${d})`)),d}function ve(e){d.Z.postToChild(e),d.Z.post(Z(W({},e),{action:`debug-action-${e.action}`}))}function me(e,t){(0,R.bF)(t)&&e.addCallbacks({onOpen:()=>{(0,o.q)("hide sticky banner"),d.Z.post({type:"sticky-banner",action:"hide",data:{reason:"blur"}})},onClose:()=>{(0,o.q)("show sticky banner"),d.Z.post({type:"sticky-banner",action:"show",data:{reason:"blur"}})}})}function ge(e,t,r){return q(this,null,function*(){if(t!==A.$H.REWARDED)return;const s=(0,L.AK)(r);if(!s.isAndroid||s.isStandalone)return;const n=yield d.Z.post(a.Vo.GetState()),{screenOrientationWasLocked:o}=n.data;if(o)return;const l=()=>{i.default.unlock().catch(()=>{})};e.addCallbacks({onOpen:()=>{i.default.lock().catch(()=>{})},onClose:l,onError:l})})}function ye(e,t){switch(t){case A.$H.INTERSTITIAL:e.addCallbacks({onOpen:()=>ve(a.fB.AdvCallbackOpen()),onClose:e=>ve(a.fB.AdvCallbackClose({wasShown:e})),onError:e=>ve(a.fB.AdvCallbackError({fromMethod:"showFullScreenAdv",error:w(e)}))});break;case A.$H.REWARDED:e.addCallbacks({onOpen:()=>ve(a.fB.RewardedVideoCallbackOpen()),onRewarded:()=>ve(a.fB.RewardedVideoCallbackRewarded()),onClose:()=>ve(a.fB.RewardedVideoCallbackClose()),onError:e=>ve(a.fB.RewardedVideoCallbackError({error:w(e),fromMethod:"onError"}))})}}},1415:(e,t,r)=>{r.d(t,{I:()=>s});var a=r(83959);function s(){return"no"===(0,a.V)("header")}},22097:(e,t,r)=>{r.d(t,{Z:()=>fo});var a=r(57627),s=r(63904),i=r.n(s),n=r(87363),o=r(38225),l=r(94713),d=r(50678),c=r(78825),u=Object.defineProperty,h=(e,t,r)=>(((e,t,r)=>{t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const p=i().with("adv-debug-info");let v="",m="";class g extends d.P{constructor(e){super(e),h(this,"services"),h(this,"switchDebugInfo",()=>{var e,t;const{isOverlayVisible:r}=this.state,{appId:a}=this.props;if(this.setState(e=>({isOverlayVisible:!e.isOverlayVisible})),r)return;const s=[`Ð’ÐµÑ€ÑÐ¸Ñ SDK: ${window.appData.version}`,`Ð ÐµÐºÐ»Ð°Ð¼Ð°: ${v} - ${m}`,`Ð­ÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ñ‹: ${JSON.stringify(window.appData.abt.flags,null,2)}`,`UserAgent: ${navigator.userAgent}`,`AppID: ${a}`],i=`https://forms.yandex-team.ru/surveys/73978/?${[`answer_short_text_644835=${encodeURIComponent("ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ñ Ñ€ÐµÐºÐ»Ð°Ð¼Ð¾Ð¹")}`,`answer_long_text_644836=${encodeURIComponent("\n\n===== Ð¾Ñ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:\n"+s.join("\n"))}`].join("&")}`,n=()=>{var e;const t="Ð›Ð¾Ð³Ð¸ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸:\n\n"+(null==(e=window.metrikaLogs)?void 0:e.data.map(e=>`${e.type}${e.goal?` ${e.goal}`:""} - ${JSON.stringify(e.data)}`).slice().reverse().join("\n\n"))||0;this.setState({metrikaLogsText:t}),navigator.clipboard.writeText(s.join("\n")+"\n\n"+t)};n(),window.metrikaLogs.onUpdate=n,null==(t=null==(e=null==window?void 0:window.Ya)?void 0:e.Rum)||t.logEventString("adv","butterfly manual report",{additional:s}),this.setState({logs:s,linkHref:i})}),this.state={isVisible:!1,isOverlayVisible:!1,linkHref:"",logs:[],metrikaLogsText:""}}componentDidMount(){this.initMessaging()}initMessaging(){c.Z.onInternalMessage("adv-debug-info",e=>{const{action:t}=e.data;switch(t){case"show-debug-info":this.setState({isVisible:!0});break;case"hide-debug-info":this.hide();break;case"set-debug-adv-block":v=e.data.data.type,m=e.data.data.id}})}hide(){window.metrikaLogs.onUpdate=void 0,this.setState({isVisible:!1})}render(){const{logs:e,metrikaLogsText:t,isVisible:r,isOverlayVisible:s,linkHref:i}=this.state,{isDevFeaturesEnabled:n}=this.props;return n&&r?(0,a.jsxs)("div",{className:p(),children:[(0,a.jsx)("button",{className:p("button"),onClick:this.switchDebugInfo,children:"ðŸž"}),s&&(0,a.jsxs)("div",{className:p("overlay"),onClick:this.switchDebugInfo,children:[(0,a.jsx)("div",{className:p("clipboard-notice"),children:"Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² Ð±ÑƒÑ„ÐµÑ€ Ð¾Ð±Ð¼ÐµÐ½Ð°"}),(0,a.jsx)("div",{className:p("data"),children:e.join("\n")}),(0,a.jsx)("a",{href:i,target:"_blank",children:"Ð¢Ð¸ÐºÐµÑ‚ Ð² StarTrek"}),(0,a.jsx)("div",{className:p("metrika-logs"),children:t})]})]}):null}}const y=g;var f=r(62036),w=r(74495),b=r(72936),k=r(45682),A=r(60362),S=r(69278),P=r(18216),I=r(12883),T=r(65962),E=r(79483),C=r(36329),D=r(27987),R=r(89957),x=r(1415),_=r(77314),O=r(39138),L=r(4522),B=r(36850),N=r(17332),j=r(60617);const M="FullscreenBlock-critical-game-module__container--dQ6v3",H="FullscreenBlock-critical-game-module__hidden--j6iR2";var $=Object.defineProperty,F=Object.defineProperties,W=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,z=(e,t,r)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,U=(e,t)=>{for(var r in t||(t={}))q.call(t,r)&&z(e,r,t[r]);if(Z)for(var r of Z(t))G.call(t,r)&&z(e,r,t[r]);return e},V=(e,t)=>F(e,W(t));const K="fullscreenBlock_container",Y="fullscreenBlock_block";function X(e){return""===e?K:`${K}_${e}`}function J(e){return""===e?Y:`${Y}_${e}`}const Q={big:"FullscreenBlock-critical-game-module__blockBigPaddings--h7bsT",default:"FullscreenBlock-critical-game-module__blockDefaultPaddings--UNAc4",unset:"FullscreenBlock-critical-game-module__blockNoPaddings--DFpDl",small:"FullscreenBlock-critical-game-module__blockSmallPaddings--JNCeW"},ee=({advManager:e})=>{var t,r,s;const i=(0,O.T)(),{abt:{flags:o}}=(0,_.b)(),{options:l}=(0,w.HX)(),d=(0,n.useMemo)(()=>{var e,t;return{usePlaceholder:null!=(e=(0,j.tK)(o))?e:(0,j.Sf)(o),useLoader:(0,j.Z0)(o),controlsDelay:null!=(t=(0,j.Bl)(o))?t:(0,j.sQ)(o)}},[o]),u=(0,n.useRef)([]),h=(0,n.useRef)(null),[p,v]=(0,n.useState)({isVisible:!1,loadedProviderBlock:null,showControls:!1,isHeaderEnabled:!(0,x.I)(),callbacks:{},visibleChange:!1}),[m,g]=(0,n.useState)([""]),[y,f]=(0,n.useState)(m[0]),b=(0,n.useCallback)(()=>{v(e=>V(U({},e),{isVisible:!1,loadedProviderBlock:null,callbacks:{}})),f("")},[]),k=(0,n.useCallback)(()=>{var e,t;(0,R.D)(),null==(t=(e=p.callbacks).onClose)||t.call(e),b()},[b,p.callbacks]),A=(0,n.useCallback)(e=>{"Escape"===e.key&&p.isVisible&&(0,B.D)(()=>{k()})},[p.isVisible,k]),S=(0,n.useCallback)((e,t)=>{const{action:r,data:a}=e.data;switch(r){case"show":{const{onOpen:e,onClose:r}=a;v(t=>V(U({},t),{isVisible:!0,visibleChange:!0,showControls:!1,callbacks:{onOpen:e,onClose:r}})),t();break}case"show-block":{const{blockName:e}=a;f(()=>(t(),X(e)));break}case"hide":const{blockName:e}=null!=a?a:{};if(e&&y!==X(e))break;b();break;case"add-block":{const{blockName:e}=a;if(m.includes(e))return void t();g(r=>(u.current.push(t),[...r,e]));break}case"show-controls":v(e=>V(U({},e),{showControls:!0}));break;case"is-visible":t({data:{isVisible:p.isVisible}});break;case"slot-loaded":v(e=>V(U({},e),{loadedProviderBlock:a.blockName})),t();break;case"remove":{const{blockName:e}=a;g(t=>t.filter(t=>t!==e)),t();break}}},[m,y,b,p.isVisible]);(0,n.useEffect)(()=>(window.addEventListener("keydown",A),c.Z.onInternalMessage("adv-fullscreen-block",S),()=>{window.removeEventListener("keydown",A),c.Z.offInternalMessage("adv-fullscreen-block",S),h.current&&clearTimeout(h.current)}),[A,S]),(0,n.useEffect)(()=>{var e,t;p.isVisible&&p.visibleChange&&(null==(t=(e=p.callbacks).onOpen)||t.call(e),d.controlsDelay<1||(v(V(U({},p),{showControls:!1,visibleChange:!1})),h.current=window.setTimeout(()=>{v(e=>V(U({},e),{showControls:!0}))},d.controlsDelay)))},[d.controlsDelay,p]),(0,n.useEffect)(()=>{u.current.length&&(u.current.forEach(e=>{e()}),u.current.length=0)},[m]);const P=(0,n.useCallback)(()=>{(0,B.D)(()=>{k()})},[k]),I=(0,n.useCallback)(()=>{(0,N.Z)()},[]),T=e.isDisableAdButtonEnabled,E=0===d.controlsDelay||p.showControls,$=(0,j.Hr)(e.flags),F=null!=(t=(0,j.J0)(o))?t:(0,j.Rw)(o),W=null==(s=null==(r=e.allAdvBlocks.publift)?void 0:r.interstitial)?void 0:s.blockId,Z="publift"===(null==l?void 0:l.trafficSplitProvider)&&W?{"data-fuse":W}:null;return(0,a.jsxs)("div",{className:(0,L.E)(M,void 0,p.isVisible?"visible":H,$?void 0:"FullscreenBlock-critical-game-module__adsenseDefaultStyles--flcyg"),"data-testid":"adv-fullscreen-container",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,L.E)("FullscreenBlock-critical-game-module__desktopClose--yzM_U",E?void 0:H),"data-testid":"adv-fullscreen-close-button",onClick:P}),d.useLoader&&(0,a.jsx)("div",{className:(0,L.E)("FullscreenBlock-critical-game-module__spinner--z0MF2",E?H:void 0),children:(0,a.jsx)(D.y,{position:"center",size:32,spinning:!0},"landscape-spinner")}),m.map(e=>{const t=X(e);return(0,a.jsx)("div",{className:(0,L.E)("FullscreenBlock-critical-game-module__block--aQF38",Q[F],d.usePlaceholder?"FullscreenBlock-critical-game-module__placeholder--BnKP9":void 0,y===t?void 0:H,J(e),e===p.loadedProviderBlock?`${Y}_loaded`:void 0),children:(0,a.jsx)("div",U({id:t},Z))},t)})]}),T?(0,a.jsxs)("div",{className:(0,L.E)("FullscreenBlock-critical-game-module__touchControls--jHD08",E?void 0:H),children:[T&&(0,a.jsx)(C.z,{"data-testid":"adv-fullscreen-close-button",size:40,view:"secondary",onClick:I,children:i("header.popup.disable.ads")}),(0,a.jsx)(C.z,{"data-testid":"adv-fullscreen-close-button",size:40,view:"primary",onClick:P,children:i("adv.close")})]}):null]})};var te=r(61283),re=r(87125);const ae=(0,re.M$)("AdvAdsense",re.XG.Adv,{background:"#0c6c09"});var se=Object.defineProperty,ie=(e,t,r)=>(((e,t,r)=>{t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class ne{constructor(e,t){var r,a,s,i;this.service=e,ie(this,"rules"),ie(this,"initTime",Date.now()),ie(this,"lastShowedTimeByTag",{[b.$H.INTERSTITIAL]:-1,[b.$H.REWARDED]:-1}),ie(this,"skipsCounterByTag",{[b.$H.INTERSTITIAL]:0,[b.$H.REWARDED]:0}),ie(this,"guardApplyTime"),this.initGuardApplyHandler();const{flags:n}=this.advManager,{checksCountCommon:o,showIntervalByTagMs:l,checksCountByTag:d,initDelayMs:c,guardDelayMs:u,showIntervalCommonMs:h}=null!=t?t:{};this.rules={showIntervalByTagMs:this.getRuleValue(f.LQ,l,0),showIntervalCommonMs:null!=(a=null!=(r=(0,f.OF)(this.service.serviceName,n))?r:h)?a:0,initDelayMs:this.getRuleValue(f.vp,c,0),guardDelayMs:this.getRuleValue(f.ro,u,0),checksCountByTag:this.getRuleValue(f.YS,d,0),checksCountCommon:null!=(i=null!=(s=(0,f.g3)(this.service.serviceName,n))?s:o)?i:0}}get advManager(){return this.service.advManager}get skipsCounter(){return this.skipsCounterByTag[b.$H.INTERSTITIAL]+this.skipsCounterByTag[b.$H.REWARDED]}get lastShowedTime(){return Math.max(this.lastShowedTimeByTag[b.$H.INTERSTITIAL],this.lastShowedTimeByTag[b.$H.REWARDED])}getSkipReason({tag:e}){const t=this.calculateSkipReason({tag:e});return t&&this.skipsCounterByTag[e]++,t}calculateSkipReason({tag:e}){const{showIntervalCommonMs:t,showIntervalByTagMs:r,checksCountCommon:a,checksCountByTag:s,initDelayMs:i,guardDelayMs:n}=this.rules;return i[e]&&this.getTimeDiff(this.initTime)<i[e]?"init_delay":n[e]&&this.guardApplyTime&&this.getTimeDiff(this.guardApplyTime)<n[e]?"guard_delay":r[e]&&this.getTimeDiff(this.lastShowedTimeByTag[e])<r[e]?"show_interval_by_tag":t&&this.getTimeDiff(this.lastShowedTime)<t?"show_interval_common":s[e]&&this.skipsCounterByTag[e]<s[e]?"show_calls_by_tag":a&&this.skipsCounter<a?"show_calls_common":null}getTimeDiff(e,t){return Math.abs((e||0)-(null!=t?t:Date.now()))}getRuleValue(e,t,r){var a,s,i,n;const{flags:o}=this.advManager;return{[b.$H.INTERSTITIAL]:null!=(s=null!=(a=e(b.$H.INTERSTITIAL,this.service.serviceName,o))?a:null==t?void 0:t[b.$H.INTERSTITIAL])?s:r,[b.$H.REWARDED]:null!=(n=null!=(i=e(b.$H.REWARDED,this.service.serviceName,o))?i:null==t?void 0:t[b.$H.REWARDED])?n:r}}initGuardApplyHandler(){return e=this,t=function*(){yield Promise.all([this.advManager.guardClosedPromiseWrapper.promise,this.advManager.splashScreenPromise.promise]).then(()=>this.guardApplyTime=Date.now())},new Promise((r,a)=>{var s=e=>{try{n(t.next(e))}catch(e){a(e)}},i=e=>{try{n(t.throw(e))}catch(e){a(e)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,i);n((t=t.apply(e,null)).next())});var e,t}resetShowTimer(e){this.lastShowedTimeByTag[e]=Date.now()}}var oe=r(83592),le=r(71592),de=Object.defineProperty,ce=(e,t,r)=>(((e,t,r)=>{t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const ue=(0,re.M$)("AdvService",re.XG.Adv);class he{constructor(e,t,r,a){this.advManager=e,this.options=t,this.serviceName=r,ce(this,"initPromise",new S.Z),ce(this,"initTime",Date.now()),ce(this,"canShowController"),this.canShowController=new ne(this,a)}getAdvBlockId(e,t,r){return"invalid_block"}getWaterfallItem(e){var t,r;return null!=(r=null==(t=this.advManager.waterfallQueue[e])?void 0:t.find(e=>e.provider===this.serviceName))?r:null}isTagActive(e){return this.options.tags[e]!==oe.pP.Skip}isTagWaterfall(e){return this.options.tags[e]!==oe.pP.Onspot}onServiceLoaded(){this.initPromise.resolve(),ue(`Service ${this.serviceName} loaded.`),(0,le.s4)("play_adv_service_init",Date.now()-this.initTime,!0,{"-additional":encodeURIComponent(JSON.stringify({advtype:this.serviceName,options:this.options}))})}onServiceError(e){let t=null!=e?e:new Error("Service not initialized: Unhandled undefined error (safe)");e instanceof Error&&(e.message=`Service not initialized: ${e.message}`),(0,te.g5)(this,{error:t,additional:{error:e}}),this.initPromise.reject(t)}getTimeoutExtraTime(e,t){}checkCanShow(e,t){return r=this,a=function*(){const t=this.canShowController.getSkipReason({tag:e});return t?(ue(`[${this.serviceName}] Skip service by reason: ${t}`),oe.Kc.Next):oe.Kc.Ok},new Promise((e,t)=>{var s=e=>{try{n(a.next(e))}catch(e){t(e)}},i=e=>{try{n(a.throw(e))}catch(e){t(e)}},n=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,i);n((a=a.apply(r,null)).next())});var r,a}get hasFullscreenAdv(){var e;return null==(e=this.advManager.advUsedBlocks.fullscreen)||e}get hasRewarderdAdv(){var e;return null==(e=this.advManager.advUsedBlocks.rewarded)||e}showRewardedVideo(e){return Promise.reject()}resetShowTimer(e){this.canShowController.resetShowTimer(e)}cancelShow(e){}}var pe=r(23160),ve=r(96344),me=r(2592),ge=Object.defineProperty,ye=(e,t,r)=>(((e,t,r)=>{t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),fe=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});class we extends he{constructor(e,t){var r,a,s;const{serviceName:i}=t;if(![pe.e.Adsense,pe.e.AdsenseResponsive].includes(i))throw new Error(`Invalid service name: ${i}, kind of 'adsense' expected.`);super(e,t,i),ye(this,"provider"),ye(this,"rewardedProvider"),ye(this,"isResponsive",!1),ye(this,"clientId"),ye(this,"slotId"),this.isResponsive=i===pe.e.AdsenseResponsive;const n=null==(r=e.waterfallQueue)?void 0:r[b.$H.INTERSTITIAL].find(e=>e.provider===pe.e.AdsenseResponsive),{clientId:o,slotId:l}=(0,oe.hk)(n)?n:null!=(s=null==(a=e.allAdvBlocks.adsense)?void 0:a.interstitial)?s:{};this.clientId=null!=o?o:"invalid_block",this.slotId=null!=l?l:"invalid_block",this.init()}init(){return fe(this,null,function*(){try{const e=this.isTagActive(b.$H.INTERSTITIAL),t=this.isTagActive(b.$H.REWARDED),[r,a]=yield Promise.all([e?yield(0,T.l)(this.isResponsive?E.oO.AdsenseResponsive:E.oO.AdsenseBlock):null,t?yield(0,T.l)(E.oO.AdsenseRewarded):null]);e&&r&&(this.provider=r,yield(0,ve.b)({querySelector:`.${M}`,interval:100,rejectTimeout:1500}),yield c.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.serviceName},timeout:me.WT})),t&&a&&(this.rewardedProvider=a),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}getTimeoutExtraTime(e,t){switch(e){case oe.QA.ServiceInit:return 3*me.WT;case oe.QA.ShowFullscreen:return 5*me.yR}return super.getTimeoutExtraTime(e,t)}getAdvBlockId(e,t){switch(e){case b.$H.INTERSTITIAL:return this.isResponsive?this.slotId:this.clientId;case b.$H.REWARDED:return"adsense_rewarded"}return super.getAdvBlockId(e,t)}showFullscreenAdv({callbacks:e,clickDaemon:t,reason:r}){return new Promise((a,s)=>fe(this,null,function*(){try{const{serviceName:i,isResponsive:n,clientId:o}=this,l=this.provider;if(!l)return void s(new Error("Adsense provider not loaded."));const d=this.getAdvBlockId(b.$H.INTERSTITIAL,r);let u,h=!1;n&&(yield c.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:i},timeout:me.WT}),yield c.Z.post({type:"adv-fullscreen-block",action:"show",data:{onClose:()=>{h&&e.onClose(h),u&&l.destroySlot(u)}}})),e.onOpen(!1),t.request({advBlockId:d}),ae("Create slot",d,o,X(i)),u=yield l.createSlot({adFormat:"auto",blockId:d,clientId:o,divId:X(i),height:window.innerHeight-192,width:window.innerWidth-144});const{isEmpty:p,slot:v}=yield l.preloadSlot({slot:u});if(p)throw t.responseEmpty(),new te.lu("Slot is empty",{isEmpty:!0});t.response(),h=!0,(0,j.Hr)(this.advManager.flags)&&c.Z.post({type:"adv-fullscreen-block",action:"slot-loaded",data:{blockName:i},timeout:me.WT}),yield l.showSlot(v),t.show(),n||e.onClose(!0),a()}catch(e){s(e)}}))}showRewardedVideo({callbacks:e,clickDaemon:t,reason:r}){return new Promise((a,s)=>fe(this,null,function*(){try{const{clientId:i,rewardedProvider:n}=this;if(!n)return void s(new Error("Provider not loaded."));const o=this.getAdvBlockId(b.$H.REWARDED,r);let l,d=!1;t.request({advBlockId:o}),ae("Create rewarded slot",o,i),l=yield n.createSlot({blockId:o});const{isEmpty:c,slot:u}=yield n.preloadSlot({slot:l});if(c)throw t.responseEmpty(),new te.lu("Slot is empty",{isEmpty:!0});t.response(),a();const{waitForView:h}=yield n.showSlot(u);d=!0,e.onOpen(!0);const{isDismissed:p}=yield h;p||e.onRewarded(),e.onClose(d)}catch(e){s(e)}}))}cancelShow(e){e===b.$H.INTERSTITIAL&&c.Z.post({type:"adv-fullscreen-block",action:"hide",data:{blockName:this.serviceName}})}}var be=(e=>(e.Display="display",e.Interstitial="interstitial",e.Midroll="interstitial",e.Preroll="interstitial",e.Rewarded="rewarded",e))(be||{}),ke=(e=>(e.SDK_ERROR="SDK_ERROR",e.SDK_GAME_PAUSE="SDK_GAME_PAUSE",e.SDK_GAME_START="SDK_GAME_START",e.SDK_GDPR_TARGETING="SDK_GDPR_TARGETING",e.SDK_GDPR_THIRD_PARTY="SDK_GDPR_THIRD_PARTY",e.SDK_GDPR_TRACKING="SDK_GDPR_TRACKING",e.SDK_LB_LOGIN="SDK_LB_LOGIN",e.SDK_READY="SDK_READY",e.SDK_REWARDED_WATCH_COMPLETE="SDK_REWARDED_WATCH_COMPLETE",e.SDK_SHW_LB="SDK_SHW_LB",e))(ke||{}),Ae=r(59459),Se=r(83959),Pe=r(20966),Ie=r(70619),Te=r(97731);const Ee=(e,t)=>{e.show(),null==t||t()},Ce=(e,t,r)=>{if("viewed"===e)return void t.response();const a=["error"].includes(e);t.responseEmpty(),r(new te.lu(`Azerion returned ${e} status`,{isEmpty:!a}))};var De=Object.defineProperty,Re=(e,t,r)=>(((e,t,r)=>{t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),xe=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});let _e=null;var Oe=Object.defineProperty,Le=(e,t,r)=>(((e,t,r)=>{t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Be=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())}),Ne=r(96997),je=r(58780),Me=r(86174),He=r(63169),$e=r(66287),Fe=Object.defineProperty,We=(e,t,r)=>(((e,t,r)=>{t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class Ze{constructor(e){this.adsManager=e,We(this,"isComplete",!1),We(this,"readyPromise",new S.Z),We(this,"startedPromise",new S.Z),We(this,"showPromise",new S.Z),We(this,"onAdLog",e=>{e.getAdData().adError.getErrorCode()===google.ima.AdError.ErrorCode.AUTOPLAY_DISALLOWED&&(this.isComplete=!0,this.destroy(new Error("Video autoplay disallowed")))}),We(this,"onAdFetchError",()=>{this.isComplete=!0,this.destroy(new Error("Ad fetch error"))}),We(this,"onAdError",e=>{this.isComplete=!0,this.destroy(e.getError())}),We(this,"onAdLoaded",()=>{this.readyPromise.resolve()}),We(this,"onAdStarted",()=>{this.startedPromise.resolve()}),We(this,"onAdComplete",()=>{this.isComplete||(this.isComplete=!0,this.showPromise.resolve())}),We(this,"destroy",e=>{this.readyPromise.reject(e),this.showPromise.reject(e),this.startedPromise.reject(e)}),We(this,"start",()=>{try{this.adsManager.start()}catch(e){return e}}),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError),this.adsManager.addEventListener("adBreakFetchError",this.onAdFetchError),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onAdLog),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded),this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted),this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAdComplete),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete),this.readyPromise.promise.catch(()=>{}),this.startedPromise.promise.catch(()=>{}),this.showPromise.promise.catch(()=>{})}}var qe=r(99883),Ge=r(81098),ze=r(77301),Ue=r(13949),Ve=r(64831),Ke=r(27390),Ye=Object.defineProperty,Xe=(e,t,r)=>(((e,t,r)=>{t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Je=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Qe=(0,re.M$)("GoogleInstreamPrerender",re.XG.Adv,{background:"#d486f2"});class et{constructor(e,t){this.service=e,this.adContainer=t,Xe(this,"videoPlayer",document.createElement("video")),Xe(this,"adDisplayContainer"),Xe(this,"adsLoader"),Xe(this,"adsManager"),Xe(this,"currentAdLoading"),Xe(this,"currentAdvLogger",new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:b.$H.INTERSTITIAL})),Xe(this,"currentShow"),Xe(this,"isHeaderEnabled"),Xe(this,"isResponsiveContainer"),Xe(this,"createAdDisplayContainer",()=>{this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.videoPlayer),this.adContainer.addEventListener("click",this.adContainerClick)}),Xe(this,"adContainerClick",()=>{this.adsManager&&this.adsManager.resume()}),Xe(this,"initAdsLoader",()=>{this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1)}),Xe(this,"onAdError",e=>{var t;const r=e.getError();Qe(r.getMessage()),null==(t=this.currentAdLoading)||t.reject(r),this.currentAdLoading=void 0,this.resetSDK()}),Xe(this,"resetSDK",()=>{var e,t,r;Qe("resetting sdk state"),null==(e=this.adsManager)||e.destroy(),null==(t=this.adsLoader)||t.contentComplete(),null==(r=this.adsLoader)||r.destroy(),this.initAdsLoader(),this.currentShow=void 0}),Xe(this,"onAdsManagerLoaded",e=>{var t;Qe("ad manager loaded");const r=new google.ima.AdsRenderingSettings;r.enablePreloading=!(0,j.Rb)(this.service.advManager.flags),this.adsManager=e.getAdsManager(this.videoPlayer,r),this.currentShow=new Ze(this.adsManager);const{width:a,height:s}=this.getRendererSize();this.adsManager.init(a,s,google.ima.ViewMode.NORMAL),this.currentAdvLogger.response(),null==(t=this.currentAdLoading)||t.resolve(),this.currentAdLoading=void 0}),Xe(this,"setRendererSize",({width:e,height:t})=>{c.Z.post({type:"instream-fullscreen-render",action:"set-size",data:{width:e,height:t}})}),Xe(this,"getRendererSize",()=>{const e=this.isHeaderEnabled?-32:0,t=($e.default.isLandscape,e),r={width:window.innerWidth-4+0,height:window.innerHeight+t};return He.BG.find(({width:e,height:t})=>e<=r.width&&t<=r.height)||r}),Xe(this,"onResizeHandler",()=>Je(this,null,function*(){var e;let t;this.isResponsiveContainer?t=(yield c.Z.post(k.KT.GetSize({tag:b.$H.INTERSTITIAL}))).data:(t=this.getRendererSize(),this.setRendererSize(t)),null==(e=this.adsManager)||e.resize(t.width,t.height,google.ima.ViewMode.NORMAL)})),this.videoPlayer.setAttribute("playsinline","true"),this.isHeaderEnabled=!(0,x.I)(),this.isResponsiveContainer=(0,Me.Hc)(e.advManager.flags),this.createAdDisplayContainer(),this.initAdsLoader(),this.setRendererSize(this.getRendererSize()),$e.default.addChangeListener(this.onResizeHandler),window.addEventListener("resize",this.onResizeHandler),window.setTimeout(()=>{this.prefetchAd()},He.g*je.j2)}prefetchAd(){var e;(0,j.Rb)(this.service.advManager.flags)||(this.loadAd(Ve.p_.PRELOAD),null==(e=this.currentAdLoading)||e.promise.catch(e=>{var t;Qe("prefetching failed",e),e.getErrorCode()===google.ima.AdError.ErrorCode.VAST_NO_ADS_AFTER_WRAPPER?this.currentAdvLogger.responseEmpty():this.currentAdvLogger.error((null==(t=null==e?void 0:e.getMessage)?void 0:t.call(e))||e)}))}loadAd(e){if(Qe(`asked to load an ad for ${e}`),this.currentAdLoading||this.currentShow)return;this.currentAdLoading=new S.Z,this.currentAdvLogger=new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:b.$H.INTERSTITIAL});const t=new google.ima.AdsRequest,{advManager:r}=this.service,a=this.service.getAdvBlockId(),s=(0,j.mn)(r.flags,Ke.Z.advGoogleInstreamParams);t.adTagUrl=(0,Ge.l)({appID:r.appId,blockId:a},s),t.pageUrl=(0,ze.I)();const i=this.getRendererSize();t.linearAdSlotWidth=t.nonLinearAdSlotWidth=i.width,t.linearAdSlotHeight=t.nonLinearAdSlotHeight=i.height,t.forceNonLinearFullSlot=!0,this.currentAdvLogger.request({advBlockId:a,provider:pe.e.GoogleInstream,reason:e}),this.adsLoader.requestAds(t)}getAdToShow(){return Je(this,null,function*(){if(Qe("got call to show ads"),this.currentShow||(this.currentAdLoading?Qe("ad is already loading, waiting for it"):(Qe("dont have any ad ready, trying to load it"),this.loadAd(Ve.p_.ONSPOT)),yield this.currentAdLoading.promise),this.adDisplayContainer.initialize(),Qe("ad display container initialized!"),!this.currentShow)throw new Error("there is no current show, that should not happen");Qe("ad data is ready, returning");const e=this.currentShow;return{advLogger:this.currentAdvLogger,showPromise:e.showPromise.promise.finally(()=>{this.resetSDK()}).catch(()=>{}),readyPromise:e.readyPromise.promise,startedPromise:e.startedPromise.promise,destroy:()=>e.destroy(),startAd:()=>{const t=e.start();if(t)throw Qe("error starting an ad"),(0,Pe.H)({block:Te.W.ADV,additional:{adv:{service:this.service.serviceName}}},t),e.destroy(),t;(0,qe.AB)(this.adContainer,"interstitial-slot-google-instream")}}})}}var tt=r(26765),rt=r(99251),at=Object.defineProperty,st=(e,t,r)=>(((e,t,r)=>{t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),it=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const nt=(0,re.M$)("GoogleInstream",re.XG.Adv,{background:"#d486f2"});var ot=r(4328),lt=r(27637),dt=Object.defineProperty,ct=(e,t,r)=>(((e,t,r)=>{t in e?dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),ut=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const ht=[2*me.WT,2*me.WT,2*me.WT],pt=15*me.WT,vt=(0,re.M$)("GoogleInstream",re.XG.Adv,{background:"#d486f2"}),mt="undefined"!=typeof document&&(0,f.vV)(window.appData.abt.flags)?class extends he{constructor(e,t){super(e,t,pe.e.GoogleInstream,{initDelayMs:{[b.$H.INTERSTITIAL]:He.g,[b.$H.REWARDED]:He.g}}),ct(this,"provider",null),ct(this,"maxRetries",(0,Me.Mi)(this.advManager.flags)),ct(this,"preloadSlots",{}),ct(this,"showRewardedVideo",()=>ut(this,null,function*(){return Promise.reject("Not implemented")})),this.init()}init(){return ut(this,null,function*(){try{this.provider=yield(0,T.l)(E.oO.GoogleInstream),this.preloadBanner({reason:Ve.p_.PRELOAD,tag:b.$H.INTERSTITIAL}).catch(e=>{(0,te.g5)(this,{error:e})}),this.onServiceLoaded()}catch(e){vt(e),this.onServiceError(e)}})}getTimeoutExtraTime(e){if(e===oe.QA.ServiceInit)return 5*me.WT}getAdvBlockId(e,t){var r,a,s;return null!=(s=e===b.$H.REWARDED?null==(r=this.advManager.allAdvBlocks.instream)?void 0:r.rewarded:null==(a=this.advManager.allAdvBlocks.instream)?void 0:a.interstitial)?s:Ne.L}preloadBanner(e){return ut(this,arguments,function*({logger:e,reason:t,tag:r}){var a;const s=this.preloadSlots[r];if(s)return t!==Ve.p_.PRELOAD&&s.cancelRetry(),e&&(e.bindRequest(s.logger),s.logger=e),s.preloadPromise;const i=new S.Z;try{const s=this.provider;if(!s)throw new Error("Provider not loaded.");let n=0,o=!0,l=t!==Ve.p_.PRELOAD;const d=this.preloadSlots[r]={cancelRetry:()=>{l=!0},logger:null!=e?e:new Ue.U({tag:r,app_id:this.advManager.appId,game_id:this.advManager.appId}),preloadPromise:i.promise,cleanup:()=>{d.cancelRetry(),delete this.preloadSlots[r],vt(`${r} banner cleared.`)}},c=yield s.createSlot({appId:this.advManager.appId,blockId:this.getAdvBlockId(r,t)});do{if(n>0&&(yield(0,ot.D)(null!=(a=ht[n])?a:ht[ht.length-1]),l))throw new te.lu(lt.XO.REQUEST_CANCELED,{isEmpty:!1});d.logger.request({advBlockId:c.blockId,reason:t,retry:n,provider:this.serviceName}),(yield Promise.race([s.preloadSlot({flags:this.advManager.flags,slot:c}),(0,ot.D)(pt).then(()=>{throw new te.lu(lt.XO.RESPONSE_TIMEOUT,{isEmpty:!1})})])).isEmpty?(d.logger.responseEmpty(),n++):(o=!1,d.logger.response())}while(o&&n<=this.maxRetries);if(o)throw new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:!0});i.resolve(c)}catch(e){i.state===S.W.Pending&&i.reject(e)}return i.promise})}showFullscreenAdv(e){return ut(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,initialTag:a}){return new Promise((s,i)=>ut(this,null,function*(){try{const i=this.provider;if(!i)throw new Error("Provider not loaded.");const n=yield this.preloadBanner({tag:b.$H.INTERSTITIAL,reason:r,logger:t});s();try{const{closePromise:t}=yield i.showSlot(n,a);e.onOpen(!0);const{wasRewarded:r}=yield t;a===b.$H.REWARDED&&r&&e.onRewarded(),e.onClose(!0)}catch(t){throw e.onClose(!1),(0,te.g5)(this,{error:t,tag:a}),t}}catch(e){i(e)}}))})}cancelShow(e){var t;e===b.$H.INTERSTITIAL&&(null==(t=this.preloadSlots[e])||t.cleanup())}onShowAdvFinished({tag:e}){var t;switch(e){case b.$H.INTERSTITIAL:{null==(t=this.preloadSlots[e])||t.cleanup();const r=(this.canShowController.rules.showIntervalByTagMs[e]||this.canShowController.rules.showIntervalCommonMs||this.advManager.minIntervalBetweenAds)*je.j2;if(r<=0)return;window.setTimeout(()=>{this.preloadBanner({tag:b.$H.INTERSTITIAL,reason:Ve.p_.PRELOAD}).catch(e=>{(0,te.g5)(this,{error:e})})},r);break}}}}:class extends he{constructor(e,t){super(e,t,pe.e.GoogleInstream,{initDelayMs:{[b.$H.INTERSTITIAL]:He.g,[b.$H.REWARDED]:He.g},showIntervalByTagMs:(0,qe.$M)()}),st(this,"adContainer"),st(this,"adPrerender"),this.init()}getAdvBlockId(){var e,t;return null!=(t=null==(e=this.advManager.allAdvBlocks.instream)?void 0:e.interstitial)?t:Ne.L}init(){return it(this,null,function*(){try{let e;if(yield(0,Ie.x)({id:"ima",src:(0,tt.y)({fullUrl:(0,rt.e)().href})}),(0,Me.Hc)(this.advManager.flags))e="advBlock_"+pe.e.GoogleInstream+"_"+b.$H.INTERSTITIAL;else{const{data:t}=yield c.Z.post({action:"update-block-id",data:{blockId:"advBlock_"+pe.e.GoogleInstream},type:"instream-fullscreen-render",timeout:1e3});e=t.blockId}const t=yield(0,ve.b)({querySelector:`#${e}`,interval:100,rejectTimeout:1500});google.ima.settings.setLocale(this.advManager.lang),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.adContainer=t,this.adPrerender=new et(this,this.adContainer),this.onServiceLoaded()}catch(e){nt(e),(0,Pe.H)({block:Te.W.ADV,additional:{adv:{service:this.serviceName}}},e),this.onServiceError(e)}})}showFullscreenAdv({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>it(this,null,function*(){var s;try{let a=yield this.adPrerender.getAdToShow();const{advLogger:i,startAd:n,destroy:o,showPromise:l,readyPromise:d,startedPromise:u}=a;i&&t.bindRequest(i);const h=(0,qe.Q0)(7e3,()=>{throw nt("Timer cutoff!"),o(),new Error("Video ad cutoff by timer")});nt("waiting for ad to be ready"),yield h(d),nt("ad ready, playing");let p=!1;l.catch(()=>{}).finally(()=>{var t;null==(t=e.onClose)||t.call(e,p),(0,Me.Hc)(this.advManager.flags)?c.Z.post(k.KT.Hide({tag:b.$H.INTERSTITIAL})):c.Z.post({type:"instream-fullscreen-render",action:"hide"})}),nt("calling manager to start ad"),n(),(0,Me.Hc)(this.advManager.flags)?c.Z.post(k.KT.Show({tag:b.$H.INTERSTITIAL})):c.Z.post({type:"instream-fullscreen-render",action:"show"}),null==(s=e.onOpen)||s.call(e),p=!0,nt("waiting for playback to start"),yield h(u),r(),nt("ad playback started"),yield l}catch(e){a(e)}}))}showRewardedVideo(){return it(this,null,function*(){return Promise.reject(new Error("Not implemented exception!"))})}onShowAdvFinished({tag:e}){switch(e){case b.$H.INTERSTITIAL:{if(!this.adPrerender)return;const t=(this.canShowController.rules.showIntervalByTagMs[e]||this.canShowController.rules.showIntervalCommonMs)-this.advManager.minIntervalBetweenAds*je.j2;if(t<=0)return;window.setTimeout(()=>{this.adPrerender.prefetchAd()},t);break}}}};var gt=r(84910);const yt=(0,re.M$)("GoogleManual",re.XG.Adv,{background:"#0c6c09"});var ft=Object.defineProperty,wt=(e,t,r)=>(((e,t,r)=>{t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),bt=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const kt=[2*me.WT,2*me.WT,2*me.WT],At=15*me.WT;var St=r(43197),Pt=r(87026),It=r(29513);const Tt={[It.y_.YANDEX]:{fullscreenBlockFlag:Ke.Z.nativeFullscreenBlock,rewardedBlockFlag:Ke.Z.nativeRewardedBlock},[It.y_.APPODEAL]:{fullscreenBlockFlag:Ke.Z.nativeAppodealFullscreenBlock,rewardedBlockFlag:Ke.Z.nativeAppodealRewardedBlock},[It.y_.APPLOVIN]:{fullscreenBlockFlag:Ke.Z.nativeApplovinFullscreenBlock,rewardedBlockFlag:Ke.Z.nativeApplovinRewardedBlock},[It.y_.DEFAULT]:{fullscreenBlockFlag:Ke.Z.nativeFullscreenBlock,rewardedBlockFlag:Ke.Z.nativeRewardedBlock}};function Et(e){return t=this,r=arguments,a=function*({advBlocks:e,flags:t,residenceInfo:r}){var a,s,i,n,o,l,d,c,u,h,p,v;let m=It.y_.DEFAULT,g=(null==(s=null==(a=e.native)?void 0:a.native_interstitial)?void 0:s.blockID)||"",y=(null==(n=null==(i=e.native)?void 0:i.native_rewarded)?void 0:n.blockID)||"";if(!Boolean(null==r?void 0:r.EU)){if((0,Pt.zg)("22.1.2.848")&&(m=(0,j.di)(t,Ke.Z.mediation)||m,g=(0,j.di)(t,Ke.Z.nativeFullscreenBlock)||g,y=(0,j.di)(t,Ke.Z.nativeRewardedBlock)||y,(0,j.sE)(t))){const e=null!=(d=yield null==(l=null==(o=window.yandex)?void 0:o.ads)?void 0:l.getLibraries())?d:[];m=1===e.length?e[0].name:It.y_.DEFAULT;const r=Tt[m];g=(0,j.di)(t,r.fullscreenBlockFlag)||g,y=(0,j.di)(t,r.rewardedBlockFlag)||y}(null==(c=window.clientMetadata)?void 0:c.isOnlyRsyaAd)&&(g=(null==(h=null==(u=e.native)?void 0:u.native_rsya_interstitial)?void 0:h.blockID)||"",y=(null==(v=null==(p=e.native)?void 0:p.native_rsya_rewarded)?void 0:v.blockID)||"",m=It.y_.DEFAULT)}return{mediation:m,fullscreenBlock:g,rewardedBlock:y}},new Promise((e,s)=>{var i=e=>{try{o(a.next(e))}catch(e){s(e)}},n=e=>{try{o(a.throw(e))}catch(e){s(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,n);o((a=a.apply(t,r)).next())});var t,r,a}const Ct="R-V-5320861-1",Dt="R-V-5356156-1",Rt=e=>e.split("-V-")[1].split("-")[0];function xt(e,t){return"string"==typeof e&&/R-V-[0-9]+-[0-9]/.test(e)?Rt(e):(console.info(`[Native adv TV] Using fallback block ${t}`),Rt(t))}const _t=(0,re.M$)("NativeAdv",re.XG.Adv);let Ot;var Lt=r(79092),Bt=r(11391),Nt=Object.defineProperty,jt=Object.getOwnPropertySymbols,Mt=Object.prototype.hasOwnProperty,Ht=Object.prototype.propertyIsEnumerable,$t=(e,t,r)=>t in e?Nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ft=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Wt=[];function Zt(e,t){return new Promise((r,a)=>{Wt.push({type:e,operation:t,resolve:r,reject:a}),1===Wt.length&&function(){Ft(this,null,function*(){for(;Wt.length>0;){const{operation:e,resolve:t,reject:r}=Wt[0];try{t(yield e())}catch(e){r(e)}Wt.splice(0,1)}})}()})}var qt=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())}),Gt=Object.defineProperty,zt=(e,t,r)=>(((e,t,r)=>{t in e?Gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Ut=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Vt="Ad request completed successfully, but there are no ads available",Kt=3*me.WT,Yt=3*me.WT;var Xt=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Jt=(0,re.M$)("AdvPromo",void 0,{background:"#0c6c09"});class Qt extends he{constructor(e,t,r=pe.e.Promo){super(e,t,r),this.onServiceLoaded()}getAdvBlockId(e,t){return"onboarding_promo"}showFullscreenAdv(e){return Xt(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,depth:a}){return new Promise((s,i)=>Xt(this,null,function*(){Jt.spoiler(r,a)("showFullscreenAdv",e),t.request(),c.Z.post({type:"adv-promo-block",action:"show",data:{advTag:b.$H.INTERSTITIAL,reason:r,onError:e=>{"Promo chunk wasnt loaded"===e.message?(t.error(e.message),s()):i(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response(),e.onOpen(),s()},onClose:()=>{e.onClose()}}})}))})}showRewardedVideo(e){return Xt(this,arguments,function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>Xt(this,null,function*(){Jt("showRewardedVideo",e),t.request(),c.Z.post({type:"adv-promo-block",action:"show",data:{advTag:b.$H.REWARDED,onError:e=>{a(new Error(`PromoBlock error ${e.message}`))},onOpen:()=>{t.response(),e.onOpen(),r()},onRewarded:()=>{e.onRewarded()},onClose:()=>{e.onClose()}}})}))})}}var er=r(80913),tr=Object.defineProperty,rr=Object.getPrototypeOf,ar=Reflect.get,sr=(e,t,r)=>ar(rr(e),r,t);class ir extends Qt{constructor(e,t){var r;super(e,t,pe.e.OnboardingPromo),((e,t,r)=>{t in e?tr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(r="isNonWaterfallPromoTimeoutReady")?r+"":r,!1),setTimeout(()=>{this.isNonWaterfallPromoTimeoutReady=!0},er.q)}checkCanShow(e,t){return r=this,a=function*(){return e===b.$H.REWARDED?sr(ir.prototype,this,"checkCanShow").call(this,e,t):this.isOnboardingPromoReady()?(0,er.Q)()?sr(ir.prototype,this,"checkCanShow").call(this,e,t):oe.Kc.NextRemove:oe.Kc.Next},new Promise((e,t)=>{var s=e=>{try{n(a.next(e))}catch(e){t(e)}},i=e=>{try{n(a.throw(e))}catch(e){t(e)}},n=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,i);n((a=a.apply(r,null)).next())});var r,a}isOnboardingPromoReady(){const{firstShowGuard:e}=this.advManager;return this.isNonWaterfallPromoTimeoutReady&&e.canShowAdv()}}const nr="GameEvents";var or=Object.defineProperty;class lr{constructor(){var e;((e,t,r)=>{t in e?or(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(e="listeners")?e+"":e,[]),window.addEventListener("message",e=>{e.data.source===nr&&this.processEvent(e)})}addListener(e){return this.listeners.push(e),()=>{this.removeListener(e)}}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}processEvent(e){const{responseToId:t}=e.data;for(let r of this.listeners)r.messageId&&r.messageId!==t||r.fn(e.data)&&this.removeListener(r)}}function dr({action:e,payload:t,responseToId:r,type:a}){const s=`${Date.now()}-${Math.random()}`;return window.parent.postMessage({action:e,id:s,payload:t,responseToId:r,source:nr,type:a,ver:1},"*"),s}var cr=Object.defineProperty,ur=Object.getPrototypeOf,hr=Reflect.get,pr=(e,t,r)=>(((e,t,r)=>{t in e?cr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),vr=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const mr=(0,re.M$)("AdvParentWindow",void 0,{background:"#0c6c09"});class gr extends he{constructor(e,t){if(super(e,t,pe.e.ParentWindow),pr(this,"parentWindowApiIsAlive"),pr(this,"messageListener"),window===window.parent)return this.parentWindowApiIsAlive=!1,void this.onServiceError(new Error("No parent window"));this.messageListener=new lr,this.onServiceLoaded(),this.addStartLivenessListener()}addStartLivenessListener(){const e=dr({action:"ping",type:"liveness"}),t=this.messageListener.addListener({fn:e=>{const{action:t,payload:a,type:s}=e;switch(s){case"liveness":"pong"===t&&(window.clearTimeout(r),this.parentWindowApiIsAlive=!0);break;case"error":this.parentWindowApiIsAlive=!1,mr("error",e);break;default:this.parentWindowApiIsAlive=!1,mr(`[${Date.now()}] Unknown message "${s}:${t}", payload = ${JSON.stringify(a)}`)}return!0},messageId:e}),r=window.setTimeout(()=>{t(),this.parentWindowApiIsAlive=!1},2e3)}getAdvBlockId(e,t){return"parent_window"}checkCanShow(e,t){return vr(this,null,function*(){return void 0===this.parentWindowApiIsAlive?oe.Kc.Next:this.parentWindowApiIsAlive?(r=gr.prototype,a=this,hr(ur(r),"checkCanShow",a)).call(this,e,t):oe.Kc.NextRemove;var r,a})}showFullscreenAdv(e){return vr(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,depth:a}){return new Promise((s,i)=>vr(this,null,function*(){mr.spoiler(r,a)("showFullscreenAdv",e),t.request();const n=dr({action:"showInterstitial",type:"adv"}),o=this.messageListener.addListener({fn:r=>{const{action:a,payload:n,type:o}=r;switch(o){case"adv":if("showInterstitial"===a)switch(window.clearTimeout(l),mr("showInterstitial callback",r),n.status){case"close":return e.onClose(),!0;case"empty":return t.responseEmpty(),i(new te.lu(je.qS,{isEmpty:!0})),!0;case"error":return t.error(n.error||""),i(new Error(`ParentWindow error ${n.error||""}`)),!0;case"open":case"start":break;case"show":t.response(),e.onOpen(),s();break;default:mr(`Unknown payload.status = "${n.status}"`)}break;case"error":return window.clearTimeout(l),mr("error",r),i(new Error(`ParentWindow error ${n.error||""}`)),!0;default:mr(`[${Date.now()}] Unknown message "${o}:${a}", payload = ${JSON.stringify(n)}`)}return!1},messageId:n}),l=window.setTimeout(()=>{o(),this.parentWindowApiIsAlive=!1,i(new Error("showInterstitial is not started"))},5e3)}))})}showRewardedVideo(e){return vr(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,depth:a}){return new Promise((s,i)=>vr(this,null,function*(){mr.spoiler(r,a)("showRewardedVideo",e),t.request();const n=dr({action:"showRewarded",type:"adv"}),o=this.messageListener.addListener({fn:r=>{const{action:a,payload:n,type:o}=r;switch(o){case"adv":if("showRewarded"===a)switch(window.clearTimeout(l),mr("showRewarded callback",r),n.status){case"close":return e.onClose(),!0;case"empty":return t.responseEmpty(),i(new te.lu(je.qS,{isEmpty:!0})),!0;case"error":return t.error(n.error||""),i(new Error(`ParentWindow error ${n.error||""}`)),!0;case"open":case"start":break;case"rewarded":e.onRewarded();break;case"show":t.response(),e.onOpen(),s();break;default:mr(`Unknown payload.status = "${n.status}"`)}break;case"error":return window.clearTimeout(l),mr("error",r),i(new Error(`ParentWindow error ${n.error||""}`)),!0;default:mr(`[${Date.now()}] Unknown message "${o}:${a}", payload = ${JSON.stringify(n)}`)}return!1},messageId:n}),l=window.setTimeout(()=>{o(),this.parentWindowApiIsAlive=!1,i(new Error("showRewarded is not started"))},5e3)}))})}}var yr=r(4545),fr=Object.defineProperty,wr=Object.defineProperties,br=Object.getOwnPropertyDescriptors,kr=Object.getOwnPropertySymbols,Ar=Object.prototype.hasOwnProperty,Sr=Object.prototype.propertyIsEnumerable,Pr=(e,t,r)=>t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ir=(e,t)=>{for(var r in t||(t={}))Ar.call(t,r)&&Pr(e,r,t[r]);if(kr)for(var r of kr(t))Sr.call(t,r)&&Pr(e,r,t[r]);return e},Tr=(e,t)=>wr(e,br(t)),Er=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())}),Cr=r(48903),Dr=r(43774),Rr=r(97435),xr=r(17936);const _r=(0,re.M$)("AdvPrebidTGO",re.XG.Adv,{background:"#0c6c09"});var Or=r(22854),Lr=r(76476),Br=r(70516),Nr=Object.defineProperty,jr=(e,t,r)=>(((e,t,r)=>{t in e?Nr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Mr=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});class Hr{constructor(e){this.service=e,jr(this,"slot"),jr(this,"waitForSlotReady"),jr(this,"retries",0),jr(this,"waitForSlotViewable"),jr(this,"onSlotRenderEnded"),jr(this,"onImpressionViewable"),this.retries=(0,Me.Mi)(e.advManager.flags),(0,Lr.bT)(e=>{e.pubads().addEventListener("slotRenderEnded",e=>{var t;e.slot===this.slot&&(null==(t=this.onSlotRenderEnded)||t.call(this,e))}).addEventListener("impressionViewable",e=>{var t;e.slot===this.slot&&(null==(t=this.onImpressionViewable)||t.call(this,e))})})}defineSlot(e){return(0,Lr.bT)(t=>{const r=(0,Br.iv)(this.service.advManager.flags);_r(`defineSlot. filteredSizes=[${r.join(",")}]`);const a=t.defineSlot(this.service.getAdvBlockId(b.$H.INTERSTITIAL,e),r,X(this.service.serviceName));if(!a)throw new Error(lt.XO.NO_SLOT);return a.addService(t.pubads()),a.retry=0,t.enableServices(),a})}preload(e){return Mr(this,arguments,function*({reason:e=Ve.p_.PRELOAD,depth:t,clickDaemon:r,beforeRequest:a}){let s=this.retries;if(void 0!==t&&(this.waitForSlotReady&&this.slot&&(_r.tag("Retry")("Skip retry, due showAdv call"),this.slot.retry=1/0),s=0),this.waitForSlotReady)return this.waitForSlotReady.promise;_r.spoiler(this)("Preload interstitial slot");const i=new S.Z;this.waitForSlotReady=i;const n=new S.Z;return this.waitForSlotViewable=n,this.slot?this.slot.retry=0:(yield c.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.service.serviceName},timeout:me.WT}),this.slot=yield this.defineSlot(e)),a&&(yield a()),r||(r=new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:b.$H.INTERSTITIAL})),r.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$H.INTERSTITIAL,e),reason:e}),this.onSlotRenderEnded=t=>Mr(this,null,function*(){if(i.state===S.W.Pending){if(t.isEmpty)return null==r||r.responseEmpty(),t.slot.retry<s?(_r.tag("Retry")(`Retrying request, ${t.slot.retry+1} of ${this.retries}`),null==r||r.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$H.INTERSTITIAL,e),reason:e}),t.slot.retry++,yield(0,Or.t)(),void googletag.pubads().refresh([this.slot])):(i.resolve({isEmpty:!0,clickDaemon:r}),delete this.waitForSlotReady,void delete this.waitForSlotViewable);r.response(),i.resolve({isEmpty:!1,clickDaemon:r}),(0,gt.o)(t.slot,"interstitial-banner-google")}else _r("Ignore slot response, preload canceled.")}),this.onImpressionViewable=()=>{n.resolve()},yield(0,Or.t)(),googletag.pubads().refresh([this.slot]),this.waitForSlotReady.promise})}show(){return Mr(this,null,function*(){if(!this.waitForSlotViewable)throw new Error("Call Preload.show() before preload()");_r.spoiler(this)("Show interstitial slot"),yield c.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:this.service.serviceName}}),yield this.waitForSlotViewable.promise,delete this.waitForSlotReady,delete this.waitForSlotViewable})}cancel(){var e,t;_r("Cancel preload promises"),null==(e=this.waitForSlotReady)||e.resolve({isEmpty:!1,clickDaemon:null}),null==(t=this.waitForSlotViewable)||t.resolve(),delete this.waitForSlotReady,delete this.waitForSlotViewable}}var $r=r(60037),Fr=Object.defineProperty,Wr=(e,t,r)=>(((e,t,r)=>{t in e?Fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Zr=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const qr={slotRenderEnded:"onSlotRenderEnded",rewardedSlotReady:"onRewardedSlotReady",rewardedSlotGranted:"onRewardedSlotGranted",rewardedSlotClosed:"onRewardedSlotClosed"};class Gr{constructor(e){this.service=e,Wr(this,"slot"),Wr(this,"waitForSlotReady"),Wr(this,"retries"),Wr(this,"onOrientationChange"),Wr(this,"onSlotRenderEnded"),Wr(this,"onRewardedSlotReady"),Wr(this,"onRewardedSlotGranted"),Wr(this,"onRewardedSlotClosed"),this.retries=(0,Me.ck)(this.service.advManager.flags),(0,Lr.bT)(()=>{const e=googletag.pubads();for(const t in qr)e.addEventListener(t,e=>{var r;const{slot:a}=e;a===this.slot&&(null==(r=this[qr[t]])||r.call(this,e))})}),$e.default.addChangeListener(()=>{var e;null==(e=this.onOrientationChange)||e.call(this)})}defineSlot({retry:e}){return(0,Lr.bT)(()=>{const t=googletag.defineOutOfPageSlot(this.service.getAdvBlockId(b.$H.REWARDED),googletag.enums.OutOfPageFormat.REWARDED);if(!t)throw new Error(lt.XO.NO_SLOT);return t.addService(googletag.pubads()),t.retry=e,t})}preload(){return Zr(this,arguments,function*({depth:e,clickDaemon:t,reason:r=Ve.p_.PRELOAD,providerLoaderName:a}={}){if(this.waitForSlotReady)return this.retries&&this.slot&&void 0!==e&&(_r.tag(["Retry","Rewarded"])("Skip retry, due showAdv call"),this.slot.retry=0),this.waitForSlotReady.promise;_r.spoiler(this)("Preload rewarded slot");const s=new S.Z;this.waitForSlotReady=s;const i=new S.Z;let n,o=!1,l=!1;try{t||(t=new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:b.$H.REWARDED})),this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:void 0===e?this.retries:0}),t.request({advBlockId:this.service.getAdvBlockId(b.$H.REWARDED,r),provider:this.service.serviceName,reason:r});const d=(e=0)=>Zr(this,null,function*(){this.slot&&googletag.destroySlots([this.slot]),this.slot=yield this.defineSlot({retry:e}),null==t||t.request({advBlockId:this.service.getAdvBlockId(b.$H.REWARDED,r),reason:r}),googletag.pubads().refresh([this.slot])});this.onOrientationChange=()=>{if(_r.spoiler("orientationChange",l),o&&l&&this.slot)return googletag.destroySlots([this.slot]),i.resolve({wasShown:o,wasRewarded:l}),void delete this.waitForSlotReady;delete this.waitForSlotReady,d(0)},this.onSlotRenderEnded=e=>{if(e.isEmpty)return null==t||t.responseEmpty(),this.retries&&e.slot.retry?(_r.tag(["Retry","Interstitial"])(`Retrying request, ${this.retries-e.slot.retry+1} of ${this.retries}`),void d(e.slot.retry-1)):(s.resolve({clickDaemon:t,isEmpty:!0}),delete this.waitForSlotReady,void(o&&i.resolve({wasShown:o,wasRewarded:l})));null==t||t.response(),(0,gt.o)(e.slot,`ingame-banner-${b.$H.REWARDED}-${null!=a?a:E.Po.Google}`)},this.onRewardedSlotReady=e=>{if(o)return(0,$r.M)(e.slot),void e.makeRewardedVisible();s.resolve({isEmpty:!1,clickDaemon:t,waitForShow:t=>(n=t,o=!0,(0,$r.M)(e.slot),e.makeRewardedVisible(),i.promise)})},this.onRewardedSlotGranted=()=>{var e;null==(e=null==n?void 0:n.onRewarded)||e.call(n),l=!0},this.onRewardedSlotClosed=()=>{i.resolve({wasShown:!0,wasRewarded:l}),delete this.waitForSlotReady},googletag.pubads().refresh([this.slot])}catch(e){(0,te.g5)(this.service,{error:e})}return this.waitForSlotReady.promise})}show(){return Zr(this,null,function*(){})}cancel(){var e,t;_r("Cancel rewarded preload"),null==(e=this.waitForSlotReady)||e.resolve({isEmpty:!1}),delete this.waitForSlotReady,this.slot&&(null==(t=googletag.destroySlots)||t.call(googletag,[this.slot]))}}var zr=r(30707),Ur=r(23202),Vr=r(33376),Kr=Object.defineProperty,Yr=Object.defineProperties,Xr=Object.getOwnPropertyDescriptors,Jr=Object.getOwnPropertySymbols,Qr=Object.prototype.hasOwnProperty,ea=Object.prototype.propertyIsEnumerable,ta=(e,t,r)=>t in e?Kr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ra=(e,t,r)=>(ta(e,"symbol"!=typeof t?t+"":t,r),r),aa=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const sa="ca-pub-7899932632484219";var ia=Object.defineProperty,na=(e,t,r)=>(((e,t,r)=>{t in e?ia(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),oa=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())}),la=r(27713);function da(){c.Z.post({type:"play-game-header",action:"hide"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),r=document.querySelector(".menu__overlay");e&&(e.style.display="none"),r&&(r.style.top="0px"),t&&(t.style.top="0px")}function ca(){if((0,x.I)())return;c.Z.post({type:"play-game-header",action:"show"});const e=document.querySelector(".header-container"),t=document.querySelector(".stack"),r=document.querySelector(".menu__overlay");e&&(e.style.display=""),r&&(r.style.top=""),t&&(t.style.top="")}var ua=Object.defineProperty;class ha{constructor(){var e,t;((e,t,r)=>{t in e?ua(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(e="promise")?e+"":e,t)}ready(){return(0,Ae.q)("[adv.prerender] ready"),this.promise}}var pa=Object.defineProperty,va=(e,t,r)=>(((e,t,r)=>{t in e?pa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class ma extends ha{constructor(e){super(),this.service=e,va(this,"consecutivePreloadFails",0),va(this,"finalRetryFailureTime",0),va(this,"debugLog"),this.debugLog=(0,re.M$)(`[RetryablePrerender ${this.service.serviceName}]`,re.XG.Adv)}retryPreloading(e,t){return this.debugLog("Checking ability to retry"),this.finalRetryFailureTime&&Math.abs(Date.now()-this.finalRetryFailureTime)<=this.consecutivePreloadFailsInterval?(this.debugLog(`Skip: Retries timeout of ${this.consecutivePreloadFailsInterval} milliseconds not yet reached`),!1):(this.finalRetryFailureTime&&(this.debugLog("Resetting retry timer"),this.finalRetryFailureTime=0,this.consecutivePreloadFails=0),this.consecutivePreloadFails>=this.maxConsecutiveRetries?(this.debugLog("Skip: Consecutive preload failures exceeded the maximum retries"),this.finalRetryFailureTime=Date.now(),!1):(this.consecutivePreloadFails++,this.debugLog(`Retrying. Attempt: ${this.consecutivePreloadFails}`),this.next(e,new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:t})).then(r=>{r.hasContent&&!r.err?this.consecutivePreloadFails=0:this.retryPreloading(e,t)}),!0))}get maxConsecutiveRetries(){var e;return null!=(e=(0,j.$9)(this.service.advManager.flags,Ke.Z.advDevPreloadRetries))?e:4}get consecutivePreloadFailsInterval(){var e;return null!=(e=(0,j.$9)(this.service.advManager.flags,Ke.Z.advDevPreloadRetriesSeqInterval))?e:5e4}}const ga={modal:"modal",rewardedVideo:"rewarded_video",modalVisible:"modal_visible",modalVisiblePreroll:"modal_visible_preroll",modalMedia:"modal__media",modalClose:"modal__close",modalBottom:"modal__bottom",modalButton:"modal__button",modalButtonClose:"modal__button_close",modalButtonDisableAdv:"modal__button_disable_adv",fullscreenButtonTop:"fullscreen_button_top",modalAdvCountdown:"modal__advCountdown",modalAdvCountdownCircle:"modal__advCountdownCircle",modalContent:"modal_content",modalContentOld:"modal__content_old",mobileCloseButton:"mobile_close_button",modalRewarded:"modal__rewarded",modalDesktopCountdown:"modal__desktop_countdown",modalWrap:"modal__wrap",modalContentSearchApplication:"modal__content_search-application",modalCloseSearchApplication:"modal__close_search-application",yandexAdaptive:"yandex-adaptive",withNativeClose:"with-native-close"},ya=20;var fa=r(61712),wa=r(27172);const ba=(0,re.M$)("YandexAdv",[re.XG.Adv],{background:"#d7bc29"});function ka(){return Object.keys(ga).reduce((e,t)=>(e[t]=`play-yandex-${ga[t]}`,e),{})}function Aa(e,t,r){const a=e[`${t}SearchApplication`];return`${e[t]} ${r?a:""}`}function Sa(){var e,t,r;(0,fa.U4)({},{borrowParams:{adv:{yaContextScriptLoad:Boolean(null==(r=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:r.render)}}})}function Pa({advBlocks:e,deviceType:t,reason:r,waterfallItem:a}){var s,i,n,o,l,d;if(a&&"blockId"in a)return a.blockId;if((0,St.x)())return r===Ve.p_.START_FULLSCREEN?je.EC.start_fullscreen:je.EC.fullscreen;if(t===wa.n.desktop){const t=e.desktop;return r===Ve.p_.START_FULLSCREEN?null!=(o=null!=(n=null==(s=null==t?void 0:t.start_fullscreen)?void 0:s.blockID)?n:null==(i=null==t?void 0:t.fullscreen)?void 0:i.blockID)?o:"":null!=(d=null==(l=null==t?void 0:t.fullscreen)?void 0:l.blockID)?d:""}return function({advBlocks:e,reason:t}){var r,a,s,i,n,o;const l=e.mobile;if(!l)return"";let d=l.fullscreen;return t===Ve.p_.START_FULLSCREEN?(d=null!=(r=l.start_fullscreen)?r:d,d=$e.default.isLandscape?null!=(a=l.start_fullscreen_landscape)?a:d:null!=(s=l.start_fullscreen_portrait)?s:d):d=$e.default.isLandscape?null!=(i=l.fullscreen_landscape)?i:d:null!=(n=l.fullscreen_portrait)?n:d,null!=(o=null==d?void 0:d.blockID)?o:""}({advBlocks:e,reason:r})}function Ia({advBlocks:e,deviceType:t}){var r,a,s,i,n,o;return(0,St.x)()?je.EC.rewarded:t===wa.n.desktop?null!=(s=null==(a=null==(r=e.desktop)?void 0:r.rewarded)?void 0:a.blockID)?s:"":null!=(o=null==(n=null==(i=e.mobile)?void 0:i.rewarded)?void 0:n.blockID)?o:""}function Ta(){var e,t,r,a;const s=null==(a=null==(r=null==(t=null==(e=window.Ya)?void 0:e.Context)?void 0:t.AdvManager)?void 0:r.getPlatform)?void 0:a.call(r);return null!=s?s:"desktop"}function Ea(){return"touch"===Ta()?"mobile":"desktop"}var Ca=r(56005),Da=Object.defineProperty,Ra=Object.getOwnPropertySymbols,xa=Object.prototype.hasOwnProperty,_a=Object.prototype.propertyIsEnumerable,Oa=(e,t,r)=>t in e?Da(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class La extends Error{constructor({type:e,text:t,code:r},a,s={}){var i;super(),Oa(this,"symbol"!=typeof(i="additional")?i+"":i,undefined),this.message=`${a}: err.code=${r}`,this.additional=((e,t)=>{for(var r in t||(t={}))xa.call(t,r)&&Oa(e,r,t[r]);if(Ra)for(var r of Ra(t))_a.call(t,r)&&Oa(e,r,t[r]);return e})({adv:{text:null==t?void 0:t.substr(0,100),code:r,type:e}},s)}}var Ba=r(71801),Na=r(68401),ja=r(89491),Ma=Object.defineProperty,Ha=Object.defineProperties,$a=Object.getOwnPropertyDescriptors,Fa=Object.getOwnPropertySymbols,Wa=Object.prototype.hasOwnProperty,Za=Object.prototype.propertyIsEnumerable,qa=(e,t,r)=>t in e?Ma(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ga=(e,t)=>{for(var r in t||(t={}))Wa.call(t,r)&&qa(e,r,t[r]);if(Fa)for(var r of Fa(t))Za.call(t,r)&&qa(e,r,t[r]);return e},za=(e,t)=>Ha(e,$a(t)),Ua=(e,t,r)=>(qa(e,"symbol"!=typeof t?t+"":t,r),r);class Va extends ma{constructor(e,t,r){super(e),Ua(this,"yandexAdvService"),Ua(this,"_previousReason",Ve.p_.PRELOAD),Ua(this,"previousPageNumber",0),this.yandexAdvService=e;const{advBlocks:a}=e.advManager;ba(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(a,null,"\t")}`),ba(`[adv.prerender] reason = ${t}`),e.savedPageYOffset=(0,te.SW)(e.advContainer),this.promise=new Promise((e,a)=>{this.next(t,r).then(e).catch(a)})}get previousReason(){return this._previousReason}next(e=this._previousReason,t){ba("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:r}=this,{advBlocks:a,deviceType:s}=r.advManager;return this.promise=new Promise((r,i)=>{this.previousPageNumber+=1;const n=Pa({advBlocks:a,deviceType:s,reason:e});ba(`[adv.prerender] advBlockId = ${n}`),c.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:n,pageNumber:this.previousPageNumber},timeout:1e3}).then(({data:e})=>{const{blockId:t}=e;return(0,ve.b)({querySelector:`#${t}`,interval:100,rejectTimeout:1500})}).then(a=>{this.renderYaAdv(r,i,{advBlockId:n,reason:e,renderTo:a.id,clickDaemon:t})}).catch(e=>{r({hasContent:!1,err:e})})}).catch(e=>({hasContent:!1,err:e})),this.promise}renderYaAdv(e,t,{advBlockId:r,clickDaemon:a,reason:s,renderTo:i}){var n,o,l,d,u;ba("[adv.prerender] renderYaAdv");const{flags:h,isAdvDisabled:p}=this.yandexAdvService.advManager;null==(o=(n=this.yandexAdvService).destroyAdv)||o.call(n);try{if(p)return void e({hasContent:!1,noRequest:!0});if(!(null==(u=null==(d=null==(l=window.Ya)?void 0:l.Context)?void 0:d.AdvManager)?void 0:u.render))throw new Error("window.Ya.Context.AdvManager.render is not defined");const{appId:t,deviceId:n}=this.yandexAdvService.advManager,o=this.previousPageNumber%ya;(0,te.U2)("Ð Ð¡Ð¯ fullscreen",`${o}`),s===Ve.p_.WATERFALL?a.request():a.request({advBlockId:r,provider:this.yandexAdvService.serviceName,reason:s});const v=Ga(za(Ga({},(0,St.x)()?{type:"fullscreen",platform:"desktop"}:{}),{async:!0,blockId:r,disableRefresh:!0,extParams:za(Ga({},n?{google_aid:n}:{}),{utm_source_service:"games","distr-id":t,"game-distrib-stat-id":(0,ja.Sn)()}),pageNumber:o,renderTo:i,statId:(0,ja.Sn)(),lazyLoad:!1,onError:t=>{var s,n;ba("[adv.prerender] onError");const l=(0,Na.M)(t,{blockId:r,pageId:o});(0,Pe.H)({additional:Ga({advBlockId:r,pageId:o,renderTo:i},"CONTAINER_NOT_FOUND"===t.code&&Math.random()<.1?{html:null==(n=null==(s=(0,Ba._)("aab-adv"))?void 0:s.innerHTML)?void 0:n.slice(0,1e3)}:{}),block:Te.W.ADV,prefix:je.yt},new La(t,"Callback onError in fullscreen")),e({hasContent:!1,err:new Error(l),clickDaemon:a})},onRender:()=>{(0,St.x)()&&window.focus(),a.response(),this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:r})},e({hasContent:!0,clickDaemon:a})}}),(0,St.x)()?{onClose:()=>{(0,B.D)(()=>{c.Z.post({type:"yandex-adv-service",action:"close-adv"})})}}:{}),m=()=>{null==a||a.responseEmpty(),e({hasContent:!1,clickDaemon:a})};ba("[adv.prerender] Preload fullscreen ad - AdvManager.render"),(0,Ca.Q$)({abtFlags:h,adOptions:v,methodName:Ca.xn.RENDER,onAdLoadFailed:m})}catch(e){t(e)}}}var Ka=Object.defineProperty,Xa=Object.defineProperties,Ja=Object.getOwnPropertyDescriptors,Qa=Object.getOwnPropertySymbols,es=Object.prototype.hasOwnProperty,ts=Object.prototype.propertyIsEnumerable,rs=(e,t,r)=>t in e?Ka(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,as=(e,t)=>{for(var r in t||(t={}))es.call(t,r)&&rs(e,r,t[r]);if(Qa)for(var r of Qa(t))ts.call(t,r)&&rs(e,r,t[r]);return e},ss=(e,t)=>Xa(e,Ja(t)),is=(e,t,r)=>(rs(e,"symbol"!=typeof t?t+"":t,r),r);class ns extends ha{constructor(e,t,r){super(),this.yandexAdvService=e,is(this,"_previousReason",Ve.p_.PRELOAD),is(this,"previousPageNumber",0),is(this,"isProcessing",!1);const{advBlocks:a}=e.advManager;ba(`[adv.prerender] yandex init with advBlocks = ${JSON.stringify(a,null,"\t")}`),ba(`[adv.prerender] startReason = ${t}`),e.savedPageYOffset=(0,te.SW)(e.advContainer),this.promise=new Promise((e,a)=>{this.next(t,r).then(e).catch(a)})}get previousReason(){return this._previousReason}next(e=this._previousReason,t,r){var a;ba("[adv.prerender] next"),this._previousReason!==e&&(this._previousReason=e);const{yandexAdvService:s}=this,{advBlocks:i}=s.advManager;return null==(a=s.destroyAdv)||a.call(s),ba("[adv.prerender] isProcessing =",this.isProcessing),this.promise=new Promise((a,s)=>{this.isProcessing=!0,this.previousPageNumber+=1;const n=Pa({advBlocks:i,deviceType:Ea(),reason:e,waterfallItem:null==r?void 0:r.waterfallItem});ba(`[adv.prerender] advBlockId = ${n}`),c.Z.post({type:"yandex-fullscreen-render",action:"update-block-id",data:{blockId:n,pageNumber:this.previousPageNumber},timeout:1e3}).then(({data:e})=>{const{blockId:t}=e;return(0,ve.b)({querySelector:`#${t}`,interval:100,rejectTimeout:1500})}).then(r=>{this.renderYaAdv(a,s,{advBlockId:n,reason:e,renderTo:r.id,clickDaemon:t})}).catch(e=>{a({hasContent:!1,err:e})})}).catch(e=>(this.isProcessing=!1,{hasContent:!1,err:e})),this.promise}renderYaAdv(e,t,{advBlockId:r,clickDaemon:a,reason:s,renderTo:i}){var n,o,l,d,c;ba("[adv.prerender] renderYaAdv");const{isAdvDisabled:u,flags:h}=this.yandexAdvService.advManager;let p=e;null==(o=(n=this.yandexAdvService).destroyAdv)||o.call(n);try{if(u)return void p({hasContent:!1,noRequest:!0});if(!(null==(c=null==(d=null==(l=window.Ya)?void 0:l.Context)?void 0:d.AdvManager)?void 0:c.preload)){const e="window.Ya.Context.AdvManager.preload is not defined";throw a.error(e),new Error(e)}(0,te.U2)("Ð Ð¡Ð¯ fullscreen",`${r}/${this.previousPageNumber%ya}`),s===Ve.p_.WATERFALL?a.request():a.request({advBlockId:r,provider:this.yandexAdvService.serviceName,reason:s});let e,t=!1;const n=new Promise(t=>e=t);let o=!1;const{appId:v,deviceId:m}=this.yandexAdvService.advManager,g=this.previousPageNumber%ya,y={async:!0,blockId:r,disableRefresh:!0,extParams:ss(as({},m?{google_aid:m}:{}),{utm_source_service:"games","distr-id":v,"game-distrib-stat-id":(0,ja.Sn)()}),lazyLoad:!1,pageNumber:g,platform:Ta(),renderTo:i,statId:(0,ja.Sn)(),type:"fullscreen",onClose:()=>{ba("[adv.prerender] onClose"),this.isProcessing=!1,o=!1,this.yandexAdvService.hideFullscreenAdv(t)},onError:e=>{ba("[adv.prerender] onError"),this.isProcessing=!1,o=!1;const t=String(e.text);(0,Pe.H)({block:Te.W.ADV,additional:{advBlockId:r,pageId:g},prefix:je.yt},new La(e,"Callback onError in fullscreen")),p({hasContent:!1,err:new Error(t),clickDaemon:a})},onPreload:t=>{ba("[adv.prerender] onPreload",p),o=!0,a.response(),p({showPrerenderedAd:()=>(ba("[adv.prerender] showPrerenderedAd"),t(),n),clickDaemon:a}),p=e},onRender:()=>{if(ba("[adv.prerender] onRender; isPreloaded =",o),!o)return ba("[adv.prerender] Called `onRender` before `onPreload`. Abort. Call `onAdLoadFailed`."),(0,Pe.H)({block:Te.W.ADV},new Error("Adv Fullscreen: Called `onRender` before `onPreload`")),void f();this.yandexAdvService.destroyAdv=()=>{var e,t;this.yandexAdvService.destroyAdv=void 0,ba("[adv.prerender] yandexAdvService.destroyAdv called"),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:r})},t=!0,p({hasContent:!0,clickDaemon:a})}},f=()=>{ba("[adv.prerender] onAdLoadFailed"),a.responseEmpty(),this.isProcessing=!1,o=!1,p({hasContent:!1,clickDaemon:a})};ba("[adv.prerender] Preload fullscreen ad - AdvManager.preload"),(0,Ca.Q$)({abtFlags:h,adOptions:y,methodName:Ca.xn.PRELOAD,onAdLoadFailed:f})}catch(e){t(e)}}}var os=r(78447),ls=r(24231),ds=r(99083),cs=Object.defineProperty,us=Object.defineProperties,hs=Object.getOwnPropertyDescriptors,ps=Object.getOwnPropertySymbols,vs=Object.prototype.hasOwnProperty,ms=Object.prototype.propertyIsEnumerable,gs=(e,t,r)=>t in e?cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ys=(e,t)=>{for(var r in t||(t={}))vs.call(t,r)&&gs(e,r,t[r]);if(ps)for(var r of ps(t))ms.call(t,r)&&gs(e,r,t[r]);return e},fs=(e,t)=>us(e,hs(t)),ws=(e,t,r)=>(gs(e,"symbol"!=typeof t?t+"":t,r),r),bs=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const ks=["direct","media-smart","media-image","media-creative","video-smart","auto-video-irect","video-creative","video-motion","media-creative-survey","video-creative-survey"];class As{constructor(e,t){this.yandexAdvService=e,ws(this,"preloadedRewardedVideo"),ws(this,"pageNumber",0),ws(this,"onClose"),ws(this,"isYandexSearchApp"),this.isYandexSearchApp=(0,ds.qo)()}next(e){const{flags:t}=this.yandexAdvService.advManager;t[Ke.Z.preloadRewardedVideo]&&(this.preloadedRewardedVideo=this.preloadRewardedVideo())}getOnCloseOptionForTV(){return(0,St.x)()?{onClose:()=>{this.yandexAdvService.getClickDaemon(b.$H.REWARDED).close(),this.hideVideoAdv(),"function"==typeof this.onClose&&this.onClose()}}:{}}preloadRewardedVideo(){const{appId:e,deviceId:t}=this.yandexAdvService.advManager,r=this.yandexAdvService.getAdvBlockId(b.$H.REWARDED);let a=()=>{},s=()=>{};const i=new Promise((e,t)=>{a=e,s=t}),n=new Promise(i=>bs(this,null,function*(){var n,o,l;try{const s=yield c.Z.post({type:"yandex-rewarded-render",action:"update-block-id",data:{blockId:r},timeout:1e3}),{data:{blockId:d}}=s,u=yield(0,ve.b)({querySelector:`#${d}`,interval:100,rejectTimeout:1500});if(!(null==(l=null==(o=null==(n=window.Ya)?void 0:n.Context)?void 0:o.AdvManager)?void 0:l.preload))throw new Error("window.Ya.Context.AdvManager.preload is not defined");ba("[adv.rerender] Preload rewarded video - AdvManager.preload");const h=ys(fs(ys({},(0,St.x)()?{type:"rewarded",platform:"desktop"}:{}),{async:!0,blockId:r,disableRefresh:!0,extParams:fs(ys({},t?{google_aid:t}:{}),{utm_source_service:"games","distr-id":e,"game-distrib-stat-id":(0,ja.Sn)()}),pageNumber:this.pageNumber,renderTo:u.id,statId:(0,ja.Sn)(),onError:(e={})=>{(0,Pe.H)({block:Te.W.ADV,prefix:je.yt},new La(e,"Callback onError in rewarded"))},onRender:e=>{e?e.product||(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data.product")):(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data")),ba("[adv.rerender] Render preloaded rewarded"),a({hasContent:!0,productType:e.productType})},onPreload:e=>i({showRewardedCallback:e})}),this.getOnCloseOptionForTV()),p=()=>{(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: no content")),i({}),a({hasContent:!1})};(0,Ca.Q$)({advTag:b.$H.REWARDED,abtFlags:this.yandexAdvService.advManager.flags,adOptions:h,methodName:Ca.xn.PRELOAD,onAdLoadFailed:p})}catch(e){i({}),s(e)}}));return function(){return n.then(({showRewardedCallback:e})=>(null==e||e(),i))}}resizeAdv(){this.yandexAdvService&&(this.yandexAdvService.savedPageYOffset=(0,te.SW)(this.yandexAdvService.advContainer))}hideVideoAdv(){var e,t,r,a,s;const{advManager:i}=this.yandexAdvService,{deviceType:n}=i,o=(0,St.x)()?je.EC.rewarded:null!=(r=null==(t=null==(e=i.getAdvBlocksByCurrentPlatform())?void 0:e.rewarded)?void 0:t.blockID)?r:"";(0,te.PS)(),n!==wa.n.desktop&&ca(),c.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),window.removeEventListener("resize",this.resizeAdv),window.scroll(0,this.yandexAdvService.savedPageYOffset),null==(s=null==(a=window.Ya)?void 0:a.Context)||s.AdvManager.destroy({blockId:o}),this.yandexAdvService.preloadRewardedAdv(Ve.p_.PRELOAD)}renderFakeRewarded({advBlockId:e,clickDaemon:t,onRewardedForTV:r,previousRewardedPageNumber:a,reason:s}){const{advManager:i}=this.yandexAdvService,{appId:n,deviceId:o}=i;return new Promise((i,l)=>bs(this,null,function*(){var d,u,h;try{if(!(null==(h=null==(u=null==(d=window.Ya)?void 0:d.Context)?void 0:u.AdvManager)?void 0:h.render))throw new Error("window.Ya.Context.AdvManager.render is not defined");t.request({advBlockId:e,reason:s,provider:this.yandexAdvService.serviceName});const p=yield c.Z.post({type:"yandex-rewarded-render",action:"update-block-id",data:{blockId:e},timeout:1e3}),{data:{blockId:v}}=p,m=yield(0,ve.b)({querySelector:`#${v}`,interval:100,rejectTimeout:1500}),g=a%ya;(0,te.U2)("Ð Ð¡Ð¯ rewarded",`${e}/${g}`),(0,te.WL)();const y=ys(ys(fs(ys({},(0,St.x)()?{type:"rewarded"}:{}),{async:!0,blockId:e,disableRefresh:!0,extParams:fs(ys({},o?{google_aid:o}:{}),{utm_source_service:"games","distr-id":n,"game-distrib-stat-id":(0,ja.Sn)()}),lazyLoad:!1,pageNumber:g,renderTo:m.id,statId:(0,ja.Sn)(),onError:(e={})=>{l(new La(e,"Callback onError in rewarded"))},onRender:e=>{(0,St.x)()&&window.focus(),e?e.product||(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data.product")):(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data")),(0,os._)({renderTo:m.id,testId:`ingame-banner-${b.$H.REWARDED}-${this.yandexAdvService.serviceName}`}),t.response(),i({hasContent:!0,productType:e.productType})}}),(0,St.x)()?{onRewarded:r}:{}),this.getOnCloseOptionForTV()),f=()=>{(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: no content")),i({hasContent:!1})};(0,Ca.Q$)({advTag:b.$H.REWARDED,abtFlags:this.yandexAdvService.advManager.flags,adOptions:y,methodName:Ca.xn.RENDER,onAdLoadFailed:f})}catch(e){l(e)}}))}showRewardedVideo({callbacks:e,clickDaemon:t}){const{onOpen:r,onRewarded:a,onClose:s}=e,i=Boolean(this.isYandexSearchApp),{advManager:n,cssClasses:o}=this.yandexAdvService,{deviceType:l,viewType:d,flags:u}=n,h=this.yandexAdvService.getAdvBlockId(b.$H.REWARDED),p=document.querySelector(`.${o.rewardedVideo}`),v=Number(u[Ke.Z.rewardedVideoTimeout]);let m;this.onClose=s,m=!isNaN(v)&&v>0?v:20;let g=m;return window.addEventListener("resize",this.resizeAdv),l!==wa.n.desktop&&da(),(d===je.xd.fullscreen||i)&&this.resizeAdv(),new Promise((e,r)=>{this.pageNumber=((this.pageNumber||0)+1)%ya;const s=()=>{(u[Ke.Z.preloadRewardedVideo]?this.preloadedRewardedVideo.bind(this):this.renderFakeRewarded.bind(this))({advBlockId:h,clickDaemon:t,onRewardedForTV:(0,St.x)()?e=>{!0===e&&(null==a||a())}:void 0,previousRewardedPageNumber:this.pageNumber,reason:Ve.p_.ONSPOT}).then(e).catch(r)};window.yaContextCb?(window.yaContextCb.push(s),ba("[adv.rerender] new rewarded render on")):s()}).then(({hasContent:e,productType:t})=>{var i;if(ba(`[adv.rerender] hasContent = ${e}, productType = ${t}`),!e)throw(0,ls.Cj)(n.waterfallQueue[b.$H.REWARDED],pe.e.Promo)||null==a||a(),new Error(je.Iy);t&&ks.includes(t)&&(m=7,g-=13),c.Z.post({type:"yandex-rewarded-render",action:"show-rewarded",data:{seconds:g}}).then(e=>{this.hideVideoAdv(),!(0,St.x)()&&e.data.isRewarded&&(null==a||a()),null==s||s()});const l=(null==(i=this.yandexAdvService.advManager.context.uatraits)?void 0:i.OSFamily)===la.k.IOS;(0,te.ss)({advElement:document.querySelector(`#yandex_rtb_rewarded_${h}`),type:b.$H.REWARDED,flags:n.flags,appId:n.appId,isIOS:l}),(0,te.J4)(o,p),null==r||r()}).catch(e=>{throw this.hideVideoAdv(),e})}}var Ss=Object.defineProperty,Ps=Object.defineProperties,Is=Object.getOwnPropertyDescriptors,Ts=Object.getOwnPropertySymbols,Es=Object.prototype.hasOwnProperty,Cs=Object.prototype.propertyIsEnumerable,Ds=(e,t,r)=>t in e?Ss(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rs=(e,t)=>{for(var r in t||(t={}))Es.call(t,r)&&Ds(e,r,t[r]);if(Ts)for(var r of Ts(t))Cs.call(t,r)&&Ds(e,r,t[r]);return e},xs=(e,t)=>Ps(e,Is(t)),_s=(e,t,r)=>(Ds(e,"symbol"!=typeof t?t+"":t,r),r),Os=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Ls=["media-creative-reach","media-image","media-creative","video-creative"];class Bs{constructor(e,t){this.yandexAdvService=e,_s(this,"advContainer",null),_s(this,"currentProductType",""),_s(this,"pageNumber",0),$e.default.addChangeListener(()=>{this.rerenderAdv()})}next(){}rerenderAdv(){var e,t;const r=this.getAdvBlockId();if(!this.yandexAdvService.isRewardedShowing||Ls.includes(this.currentProductType))return;null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:r});const a=this.yandexAdvService.getClickDaemon(b.$H.REWARDED);this.showRewardedVideo({callbacks:this.yandexAdvService.showAdvCallbacks[b.$H.REWARDED],clickDaemon:a,reason:Ve.p_.PRELOAD,tag:b.$H.REWARDED,initialTag:b.$H.REWARDED,depth:0})}getAdvBlockId(){const{advManager:e}=this.yandexAdvService,{advBlocks:t}=e;return Ia({advBlocks:t,deviceType:Ea()})}hideRewarded(){var e,t,r,a;const{advManager:s}=this.yandexAdvService,{deviceType:i,flags:n}=s,o=this.getAdvBlockId();(0,te.PS)(),i!==wa.n.desktop&&ca(),c.Z.post({type:"yandex-rewarded-render",action:"hide-rewarded"}),null==(t=null==(e=window.Ya)?void 0:e.Context)||t.AdvManager.destroy({blockId:o}),!1!==(0,j.RM)(n,Ke.Z.rewardedPCodeAdvPreloadFs)&&(null==(a=null==(r=this.yandexAdvService.getAdvBlocksByPcodePlatform())?void 0:r.fullscreen)?void 0:a.renderer)===b.bW.PCODE&&this.yandexAdvService.preloadFullscreenAdv(Ve.p_.PRELOAD)}renderRewarded({advBlockId:e,previousRewardedPageNumber:t,callbacks:r,clickDaemon:a}){const{advManager:s}=this.yandexAdvService,{flags:i}=s;return new Promise((s,n)=>Os(this,null,function*(){var o,l,d;try{if(!(null==(d=null==(l=null==(o=window.Ya)?void 0:o.Context)?void 0:l.AdvManager)?void 0:d.render))throw new Error("window.Ya.Context.AdvManager.render is not defined");a.request({advBlockId:e,reason:Ve.p_.ONSPOT,provider:this.yandexAdvService.serviceName});const c=t%ya;(0,te.U2)("Ð Ð¡Ð¯ rewarded",`${e}/${c}`),(0,te.WL)();const{appId:u,deviceId:h}=this.yandexAdvService.advManager,p={async:!0,blockId:e,disableRefresh:!0,extParams:xs(Rs({},h?{google_aid:h}:{}),{utm_source_service:"games","distr-id":u,"game-distrib-stat-id":(0,ja.Sn)()}),lazyLoad:!1,pageNumber:c,platform:Ta(),statId:(0,ja.Sn)(),type:"rewarded",onError:(e={})=>{n(new La(e,"Callback onError in rewarded"))},onClose:()=>{var e;this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,this.hideRewarded(),null==(e=r.onClose)||e.call(r)},onRewarded:e=>{e&&r.onRewarded&&r.onRewarded()},onRender:t=>{t?t.product||(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data.product")):(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: there is no data")),(0,os._)({blockId:e,testId:`ingame-banner-${b.$H.REWARDED}-${this.yandexAdvService.serviceName}`}),a.response(),s({hasContent:!0,productType:t.productType})}},v=()=>{(0,Pe.H)({block:Te.W.ADV},new Error("Adv Rewarded: no content")),s({hasContent:!1})};(0,Ca.Q$)({advTag:b.$H.REWARDED,abtFlags:i,adOptions:p,methodName:Ca.xn.RENDER,onAdLoadFailed:v})}catch(e){n(e)}}))}showRewardedVideo({callbacks:e,clickDaemon:t,depth:r}){const{onRewarded:a,onOpen:s}=e,{advManager:i,cssClasses:n}=this.yandexAdvService,{deviceType:o}=i,l=this.getAdvBlockId();return this.advContainer=document.querySelector(`.${n.rewardedVideo}`),o!==wa.n.desktop&&da(),this.yandexAdvService.isRewardedShowing=!0,new Promise((a,s)=>Os(this,null,function*(){this.pageNumber=((this.pageNumber||0)+1)%ya,window.yaContextCb?(window.yaContextCb.push(()=>{this.renderRewarded({advBlockId:null!=l?l:"",previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:r,clickDaemon:t}).then(a).catch(s)}),ba("new rewarded render on")):this.renderRewarded({advBlockId:null!=l?l:"",previousRewardedPageNumber:this.pageNumber,callbacks:e,depth:r,clickDaemon:t}).then(a).catch(s)})).then(({hasContent:e,productType:t})=>{if(ba(`[adv.rerender] hasContent = ${e}, productType = ${t}`),!e)throw(0,ls.Cj)(i.waterfallQueue[b.$H.REWARDED],pe.e.Promo)||null==a||a(),new Error(je.Iy);c.Z.post({type:"yandex-rewarded-render",action:"show-rewarded"}),this.currentProductType=t||"",null==s||s()}).catch(e=>{throw this.hideRewarded(),this.currentProductType="",this.yandexAdvService.isRewardedShowing=!1,e})}}var Ns=r(66490),js=Object.defineProperty,Ms=(e,t,r)=>(((e,t,r)=>{t in e?js(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Hs=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});r(10767);var $s=r(58894),Fs=Object.defineProperty,Ws=(e,t,r)=>(((e,t,r)=>{t in e?Fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Zs=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())}),qs=r(50206),Gs=Object.defineProperty,zs=(e,t,r)=>(((e,t,r)=>{t in e?Gs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),Us=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});class Vs extends he{constructor(e,t){const{serviceName:r}=t;super(e,t,r),zs(this,"provider"),zs(this,"rewardedProvider"),this.init()}init(){return Us(this,null,function*(){try{const e=this.isTagActive(b.$H.INTERSTITIAL),t=this.isTagActive(b.$H.REWARDED),[r,a]=yield Promise.all([e?yield(0,T.l)(E.oO.AnymindBlock):null,t?yield(0,T.l)(E.oO.AnymindRewarded):null]);this.provider=r,this.rewardedProvider=a,yield c.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.serviceName},timeout:me.WT}),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}getAdvBlockId(e,t){var r;return(null==(r=this.getWaterfallItem(e))?void 0:r.blockId)||super.getAdvBlockId(e,t)}getTimeoutExtraTime(e,t){return e===oe.QA.ServiceInit?3*me.WT:super.getTimeoutExtraTime(e,t)}showFullscreenAdv({callbacks:e,clickDaemon:t,reason:r}){return new Promise((a,s)=>Us(this,null,function*(){try{const{provider:s,serviceName:i}=this;if(!s)throw new Error("Provider not loaded.");const n=this.getAdvBlockId(b.$H.INTERSTITIAL,r);let o,l=!1;yield c.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:i},timeout:me.WT}),yield c.Z.post({type:"adv-fullscreen-block",action:"show",data:{onClose:()=>{l&&e.onClose(l),o&&s.destroySlot(o)}}}),e.onOpen(!1),t.request({advBlockId:n});const d=X(i);o=yield s.createSlot({blockId:n,divId:d,existingSlotBehaviour:qs.z.UsePrevious,size:(0,Br.iv)(this.advManager.flags)});const{isEmpty:u,slot:h}=yield s.preloadSlot({slot:o});if(u)throw t.responseEmpty(),new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:u});t.response(),l=!0,a(),yield s.showSlot(h),t.show(),yield c.Z.post({type:"adv-fullscreen-block",action:"show-controls",data:{blockName:i}})}catch(e){s(e)}}))}showRewardedVideo(e){return Us(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r}){return new Promise((a,s)=>Us(this,null,function*(){try{const{rewardedProvider:s}=this;if(!s)throw new Error("Provider not loaded.");const i=this.getAdvBlockId(b.$H.REWARDED,r);let n;t.request({advBlockId:i}),n=yield s.createSlot({blockId:i});const{isEmpty:o,slot:l}=yield s.preloadSlot({slot:n});if(o)throw t.responseEmpty(),new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:o});a(),e.onOpen(!0);const{wasRewarded:d}=yield s.showSlot(l);d&&e.onRewarded(),e.onClose(!0)}catch(e){s(e)}}))})}cancelShow(e){e===b.$H.INTERSTITIAL&&c.Z.post({type:"adv-fullscreen-block",action:"hide"})}}var Ks=Object.defineProperty,Ys=Object.getPrototypeOf,Xs=Reflect.get,Js=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Qs=(0,re.M$)("AvdEventsPromo",void 0,{background:"#0c6c09"});class ei extends he{constructor(e,t){var r,a;super(e,t,pe.e.EventsPromo),((e,t,r)=>{t in e?Ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(r="lang")?r+"":r,a),this.lang=e.context.playPageData.request.lang,this.onServiceLoaded()}getAdvBlockId(e,t){return"events_promo"}checkCanShow(e,t){return Js(this,null,function*(){const r=yield(a=ei.prototype,s=this,Xs(Ys(a),"checkCanShow",s)).call(this,e,t);var a,s;return r!==oe.Kc.Ok?r:(yield function(e,t,r){return a=this,s=function*(){const a=(0,ot.D)(r).then(()=>t);return Promise.race([e,a])},new Promise((e,t)=>{var r=e=>{try{n(s.next(e))}catch(e){t(e)}},i=e=>{try{n(s.throw(e))}catch(e){t(e)}},n=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,i);n((s=s.apply(a,null)).next())});var a,s}(this.checkCanShowInternal(),!1,100))?oe.Kc.Ok:oe.Kc.NextRemove})}checkCanShowInternal(){return Js(this,null,function*(){try{const{data:{canShow:e}}=yield c.Z.post({type:"adv-events-promo-block",action:"check-if-can-show"});return e}catch(e){return!1}})}showFullscreenAdv(e){return Js(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,depth:a}){return new Promise((s,i)=>Js(this,null,function*(){Qs.spoiler(r,a)("showFullscreenAdv",e),t.request(),c.Z.post({type:"adv-events-promo-block",action:"show",data:{advTag:b.$H.INTERSTITIAL,reason:r,onError:e=>{"Events promo chunk wasnt loaded"===e.message?(t.error(e.message),s()):i(new Error(`EventsPromoBlock error ${e.message}`))},onOpen:()=>{t.response(),e.onOpen(),s()},onClose:()=>{e.onClose()}}})}))})}}const ti=(0,re.M$)("PubliftAdvService",re.XG.Adv);var ri=Object.defineProperty,ai=(e,t,r)=>(((e,t,r)=>{t in e?ri(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),si=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});class ii{constructor(e,t){var r;this.service=e,this.provider=t,ai(this,"slot"),ai(this,"waitForSlot"),ai(this,"maxRetries"),ai(this,"refreshCounter",0),this.maxRetries=null!=(r=(0,j.$9)(e.advManager.flags,Ke.Z.advPubliftInterstitialPreloadRetries))?r:2}get blockName(){return`${this.service.serviceName}_${this.refreshCounter}`}preload(e){return si(this,arguments,function*({reason:e=Ve.p_.PRELOAD,clickDaemon:t,initialTag:r,depth:a}){if(ti.spoiler(this)("Preload interstitial slot"),t||(t=new Ue.U({app_id:this.service.advManager.appId,game_id:this.service.advManager.appId,tag:b.$H.INTERSTITIAL})),this.waitForSlot)return yield this.waitForSlot.promise;let s=0,i=void 0===a?this.maxRetries:0;const n=new S.Z;for(this.waitForSlot=n;s<=i;)try{if(this.slot||(this.refreshCounter++,yield(0,ve.b)({querySelector:`.${M}`,interval:100,rejectTimeout:1500}),yield c.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.blockName},timeout:me.WT}),this.slot=yield this.provider.createSlot({testId:`${r}-banner-${this.provider.providerLoaderName}`,blockId:this.service.getAdvBlockId(b.$H.INTERSTITIAL,e),divId:X(this.blockName)})),t.request({provider:this.service.serviceName,advBlockId:this.service.getAdvBlockId(b.$H.INTERSTITIAL,e),reason:e,retry:s>0?s:void 0}),(yield this.provider.preloadSlot({slot:this.slot})).isEmpty){if(t.responseEmpty(),s<this.maxRetries){yield this.destroySlot(),s++;continue}return yield this.destroySlot(),n.resolve({isEmpty:!0,clickDaemon:t}),delete this.waitForSlot,n.promise}return t.response(),this.waitForSlot.resolve({isEmpty:!1,slot:this.slot,clickDaemon:t}),this.waitForSlot.promise}catch(e){return s<this.maxRetries&&(t.error(e),yield this.destroySlot(),s++),n.resolve({isEmpty:!0,clickDaemon:t}),delete this.waitForSlot,n.promise}return n.promise})}show(){return si(this,null,function*(){var e;if(!(null==(e=this.waitForSlot)?void 0:e.promise)||!this.slot)throw new Error("Call Preload.show() before preload()");ti.spoiler(this)("Show interstitial slot"),yield c.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:this.blockName}}),yield this.slot.showPromise.promise,delete this.waitForSlot})}destroySlot(){return si(this,null,function*(){this.slot&&(yield this.provider.destroySlot(this.slot),delete this.slot,yield c.Z.post({type:"adv-fullscreen-block",action:"remove",data:{blockName:this.blockName}}))})}}var ni=Object.defineProperty,oi=(e,t,r)=>(((e,t,r)=>{t in e?ni(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),li=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const di={adsense:we,adsense_responsive:we,anymind_block:Vs,anymind_manual:Vs,anymind_rewarded:Vs,azerion:class extends he{constructor(e,t){super(e,t,pe.e.Azerion),Re(this,"closeWithLog",(e,t,r)=>{e.close(),null==t||t(r)}),Re(this,"rewardWithLog",(e,t)=>{e.rewarded(),null==t||t()}),Re(this,"onOpenAdvTs"),Re(this,"showFullscreenAdv",({callbacks:e,clickDaemon:t})=>new Promise((r,a)=>{var s,i,n;t.request({advBlockId:this.getAdvBlockId(b.$H.INTERSTITIAL)}),_e={onOpen:()=>{Ee(t,e.onOpen),this.onOpenAdvTs=Date.now()},onError:e=>{(0,Ae.q)("[Azerion] showFullscreenAdv error",e),Ce("error",t,a)},onClose:()=>{const r=void 0!==this.onOpenAdvTs&&Date.now()-this.onOpenAdvTs>=5e3;this.closeWithLog(t,e.onClose,r),Ce("viewed",t,a),_e=null}};try{"function"==typeof(null==(s=window.gdsdk)?void 0:s.showAd)?window.gdsdk.showAd().then(()=>{r()}).catch(_e.onError):null==(i=_e.onError)||i.call(_e,new Error("Failed to show fullscreen. GameDistribution SDK is not available"))}catch(e){null==(n=_e.onError)||n.call(_e,e),Ce("error",t,a)}})),Re(this,"showRewardedVideo",e=>xe(this,[e],function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>{var s;t.request({advBlockId:this.getAdvBlockId(b.$H.REWARDED)});let i=!1;_e={onOpen:()=>{Ee(t,e.onOpen),i=!0},onError:e=>{(0,Ae.q)("[Azerion] showRewardedVideo error",e),Ce("error",t,a)},onClose:()=>{if(!i)return(0,Ae.q)("[Azerion] showRewardedVideo no ads, process empty"),void Ce("empty",t,a);this.closeWithLog(t,e.onClose),Ce("viewed",t,a),_e=null,this.preloadRewardedVideo()},onRewarded:()=>{this.rewardWithLog(t,e.onRewarded)}};try{if("function"!=typeof(null==(s=window.gdsdk)?void 0:s.showAd))throw new Error("Failed to show rewarded. GameDistribution SDK is not available");window.gdsdk.showAd(be.Rewarded).then(()=>{r()}).catch(_e.onError)}catch(e){Ce("error",t,a)}})})),this.loadAzerionSDKScript()}loadAzerionSDKScript(){return xe(this,null,function*(){const e=(0,Se.V)("azerion_game_id");if(!e)throw new Error("No Azerion game id passed");window.GD_OPTIONS={gameId:e,onEvent:e=>{var t,r,a;switch(e.name){case ke.SDK_GAME_PAUSE:null==(t=null==_e?void 0:_e.onOpen)||t.call(_e);break;case ke.SDK_GAME_START:null==(r=null==_e?void 0:_e.onClose)||r.call(_e);break;case ke.SDK_REWARDED_WATCH_COMPLETE:null==(a=null==_e?void 0:_e.onRewarded)||a.call(_e)}}};try{if(yield(0,Ie.x)({id:"azerion-sdk",src:"https://html5.api.gamedistribution.com/main.min.js"}),!window.gdsdk)throw new Error("No window.gdsdk");this.onServiceLoaded(),this.preloadRewardedVideo()}catch(e){(0,Pe.H)({block:Te.W.ADV,additional:{adv:{service:this.serviceName}}},e),this.onServiceError()}})}getAdvBlockId(e,t){return"azerion_block_id"}preloadRewardedVideo(){var e;"function"==typeof(null==(e=window.gdsdk)?void 0:e.preloadAd)&&window.gdsdk.preloadAd(be.Rewarded).then(()=>{(0,Ae.q)("[Azerion] preload rewarded completed")}).catch(e=>{(0,Ae.q)("[Azerion] preload rewarded error",e)})}},crazy_games:class extends he{constructor(e,t){super(e,t,pe.e.CrazyGames),Le(this,"closeWithLog",(e,t)=>{e.close(),null==t||t(!0)}),Le(this,"showFullscreenAdv",e=>Be(this,[e],function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>{var s;t.request({advBlockId:this.getAdvBlockId(b.$H.INTERSTITIAL)});try{null==(s=window.CrazyGames)||s.SDK.ad.requestAd("midgame",{adError:e=>{(0,Ae.q)("[CrazyGames] showFullscreenAdv error",e),Ce("error",t,a)},adFinished:()=>{this.closeWithLog(t,e.onClose),Ce("viewed",t,a)},adStarted:()=>{Ee(t,e.onOpen),r()}})}catch(e){Ce("error",t,a)}})})),Le(this,"showRewardedVideo",e=>Be(this,[e],function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>{var s;t.request({advBlockId:this.getAdvBlockId(b.$H.REWARDED)});try{null==(s=window.CrazyGames)||s.SDK.ad.requestAd("rewarded",{adError:e=>{(0,Ae.q)("[CrazyGames] showRewardedVideo error",e),Ce("error",t,a)},adFinished:()=>{this.closeWithLog(t,e.onClose),Ce("viewed",t,a)},adStarted:()=>{Ee(t,e.onOpen),r()}})}catch(e){Ce("error",t,a)}})})),this.loadCrazyGamesSDKScript()}loadCrazyGamesSDKScript(){return Be(this,null,function*(){var e;try{if(yield(0,Ie.x)({id:"crazy-games-sdk",src:"https://sdk.crazygames.com/crazygames-sdk-v3.js"}),!(null==(e=window.CrazyGames)?void 0:e.SDK))throw new Error("No window.CrazyGames.SDK");yield window.CrazyGames.SDK.init();const{environment:t}=window.CrazyGames.SDK;if(!t||!["crazygames","local"].includes(t))throw new Error("Unexpected SDK environment: "+t);this.onServiceLoaded()}catch(e){(0,Pe.H)({block:Te.W.ADV,additional:{adv:{service:this.serviceName}}},e),this.onServiceError()}})}getAdvBlockId(e,t){return"crazy_games_block_id"}},events_promo:ei,google_instream:mt,google_manual:class extends he{constructor(e,t){super(e,t,pe.e.GoogleManual,{showIntervalCommonMs:30*me.WT}),wt(this,"provider",null),wt(this,"maxRetries",(0,Me.Mi)(this.advManager.flags)),wt(this,"preloadSlots",{}),wt(this,"showRewardedVideo",()=>bt(this,null,function*(){return Promise.reject("Not implemented")})),this.init()}init(){return bt(this,null,function*(){try{if(!this.isTagActive(b.$H.INTERSTITIAL))throw new Error("Nothing to show.");this.provider=yield(0,T.l)(E.oO.GoogleManual),this.preloadBanner({reason:Ve.p_.PRELOAD,tag:b.$H.INTERSTITIAL}).catch(e=>{(0,te.g5)(this,{error:e})}),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}getAdvBlockId(e){if(e===b.$H.INTERSTITIAL)return this.advManager.allAdvBlocks.google.manual;throw new Error(`AdvTag ${e} not supported by this service.`)}preloadBanner(e){return bt(this,arguments,function*({tag:e,reason:t=Ve.p_.PRELOAD,logger:r}){const a=this.preloadSlots[e];if(a)return yt(`Return existing preload banner instance ${e}`),t!==Ve.p_.PRELOAD&&a.cancelRetry(),r&&(r.bindRequest(a.logger),a.logger=r),a.preloadPromise;const s=this.provider;if(!s)throw new Error("Provider not loaded.");let i=t!==Ve.p_.PRELOAD,n=-1;const o=new S.Z,l={cancelRetry:()=>{i=!0,clearTimeout(n)},logger:null!=r?r:new Ue.U({tag:e,app_id:this.advManager.appId,game_id:this.advManager.appId}),preloadPromise:o.promise,cleanup:t=>{l.cancelRetry(),o.reject(t),delete this.preloadSlots[e],yt(`${e} banner cleared.`)}};let d=0;const c=this.getAdvBlockId(e),u=()=>bt(this,null,function*(){var e;try{const e=yield s.createSlot({blockId:c});if(l.logger.request({advBlockId:c,reason:t,retry:d,provider:this.serviceName}),(yield Promise.race([s.preloadSlot({slot:e}),(0,ot.D)(At).then(()=>{throw new te.lu(lt.XO.RESPONSE_TIMEOUT,{isEmpty:!1})})])).isEmpty)throw l.logger.responseEmpty(),new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:!0});l.logger.response(),o.resolve(e)}catch(t){if(i||d>this.maxRetries)return void l.cleanup(t);n=window.setTimeout(u,null!=(e=kt[d++])?e:kt[kt.length-1])}});return u(),this.preloadSlots[e]=l,l.preloadPromise})}showFullscreenAdv(e){return bt(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r}){return new Promise((a,s)=>bt(this,null,function*(){try{const s=this.provider;if(!s)throw new Error("Provider not loaded.");const i=yield this.preloadBanner({tag:b.$H.INTERSTITIAL,reason:r,logger:t});a(),(0,gt.o)(i.googleSlot,`ingame-banner-${b.$H.INTERSTITIAL}-google-manual`),e.onOpen(!0),yield s.showSlot(i),e.onClose(!0)}catch(e){s(e)}}))})}cancelShow(e){var t;e===b.$H.INTERSTITIAL&&(null==(t=this.preloadSlots[e])||t.cleanup())}onShowAdvFinished({tag:e}){var t;e===b.$H.INTERSTITIAL&&(null==(t=this.preloadSlots[e])||t.cleanup(),window.setTimeout(()=>{this.preloadBanner({tag:b.$H.INTERSTITIAL}).catch(e=>{(0,te.g5)(this,{error:e})})},this.advManager.minIntervalBetweenAds*je.j2))}},native:class extends he{constructor(e,t){super(e,t,pe.e.Native),zt(this,"preloadRewardedAdvTimer"),zt(this,"preloadFullscreenAdvPromise"),zt(this,"preloadRewardedAdvPromise"),zt(this,"lastFullscreenError"),zt(this,"lastRewardedError"),zt(this,"fullscreenBlock"),zt(this,"rewardedBlock"),zt(this,"fullscreenPreloadAdStatus","not_preloaded"),zt(this,"rewardedPreloadAdStatus","not_preloaded"),zt(this,"fullscreenShowAdNumber",0),zt(this,"rewardedShowAdNumber",0),zt(this,"depth",0),zt(this,"nativeAdv"),zt(this,"showFullscreenAdv",e=>Ut(this,[e],function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>Ut(this,null,function*(){var s;const{advManager:i}=this;this.fullscreenShowAdNumber+=1;const n=r=>{e.onClose(r),i.callOnAdvClose(r),"preloading"!==this.fullscreenPreloadAdStatus&&(this.preloadFullscreenAdvPromise=void 0),(0,Me.ZJ)(i.flags)||this.preloadFullscreenAdv({clickDaemon:t})};try{e.onOpen(!1),r();const a=yield Promise.race([this.preloadFullscreenAdv({clickDaemon:t}),new Promise((e,t)=>Ut(this,null,function*(){yield(0,ot.D)(Kt),t(new Error("Fullscreen preload timeout"))}))]);t.bindRequest(a),yield this.nativeAdv.showFullscreenAdv({onShowCalled:()=>{t.show()}}),n(!0)}catch(r){String(r.message).includes(Vt)||String(null==(s=this.lastFullscreenError)?void 0:s.message).includes(Vt)||t.error(r.message),(0,te.g5)(this,{tag:b.$H.INTERSTITIAL,error:r,name:"Native fullscreen adv error",additional:{adNumber:this.fullscreenShowAdNumber}}),"not_preloaded"===this.fullscreenPreloadAdStatus?(0,te.g5)(this,{tag:b.$H.INTERSTITIAL,error:r,name:"ad was not preloaded",additional:{adNumber:this.fullscreenShowAdNumber}}):"preloading"===this.fullscreenPreloadAdStatus&&(0,te.g5)(this,{tag:b.$H.INTERSTITIAL,error:r,name:"ad is still preloading",additional:{adNumber:this.fullscreenShowAdNumber}}),e.onError(r),n(!1),a(r)}}))})),zt(this,"showRewardedVideo",e=>Ut(this,[e],function*({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>Ut(this,null,function*(){var s;this.rewardedShowAdNumber+=1;const i=()=>{e.onClose(),"preloading"!==this.rewardedPreloadAdStatus&&(this.preloadRewardedAdvPromise=void 0),(0,Me.k4)(this.advManager.flags)||this.preloadRewardedAdv({clickDaemon:t,reason:Ve.p_.PRELOAD})};try{e.onOpen(!1),r();const a=yield Promise.race([this.preloadRewardedAdv({clickDaemon:t,reason:Ve.p_.ONSPOT}),new Promise((e,t)=>Ut(this,null,function*(){yield(0,ot.D)(Yt),t(new Error("Rewarded preload timeout"))}))]);t.bindRequest(a),yield this.nativeAdv.showRewardedVideo({onShowCalled:()=>{t.show()}}),e.onRewarded(),i()}catch(r){String(r.message).includes(Vt)||String(null==(s=this.lastRewardedError)?void 0:s.message).includes(Vt)||t.error(r.message),String(r.message).includes("User closed ad before it's end.")&&t.close(),(0,te.g5)(this,{tag:b.$H.REWARDED,error:r,name:"Native rewarded video error",additional:{adNumber:this.rewardedShowAdNumber}}),"not_preloaded"===this.rewardedPreloadAdStatus?(0,te.g5)(this,{tag:b.$H.REWARDED,error:r,name:"ad was not preloaded",additional:{adNumber:this.rewardedShowAdNumber}}):"preloading"===this.rewardedPreloadAdStatus&&(0,te.g5)(this,{tag:b.$H.REWARDED,error:r,name:"ad is still preloading",additional:{adNumber:this.rewardedShowAdNumber}}),e.onError(r),i(),a(r)}}))})),(0,St.x)()?this.nativeAdv=function(e){const t=window.appData.isGamesLiteApp;let r=null;function a(){return qt(this,null,function*(){return null!==r||(r=yield Et({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),r})}function s(t,r){return xt((0,j.Qx)(e.flags)?t:void 0,r)}return{getFullscreenBlockId(){return qt(this,null,function*(){const{fullscreenBlock:e}=yield a();return e})},getRewardedBlockId(){return qt(this,null,function*(){const{rewardedBlock:e}=yield a();return e})},preloadFullscreenAdv(){return qt(this,null,function*(){const{fullscreenBlock:e}=yield a(),r=s(e,Ct);console.info("[Native adv TV] preload","fullscreen instream pageId:",r);const i=()=>{var e,t,a;return null==(a=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:a.call(t,r,"0")};return t?i():Zt("preload",i)})},preloadRewardedVideo(){return qt(this,null,function*(){const{rewardedBlock:e}=yield a(),r=s(e,Dt);console.info("[Native adv TV] preload","rewarded instream pageId:",r);const i=()=>{var e,t,a;return null==(a=null==(t=null==(e=window.yandex)?void 0:e.ads)?void 0:t.preloadInstreamAdv)?void 0:a.call(t,r,"0")};return t?i():Zt("preload",i)})},showFullscreenAdv(e){return qt(this,arguments,function*({onShowCalled:e}){const{fullscreenBlock:r}=yield a(),i=s(r,Ct);if(console.info("[Native adv TV] show","fullscreen instream pageId:",i,r),!r&&!i)return Promise.reject(new Error("No fullscreen block for show"));const n=()=>{var t,r,a,s,n;return(null==(r=null==(t=window.yandex)?void 0:t.ads)?void 0:r.showInstreamAdv)&&e(),null==(n=null==(s=null==(a=window.yandex)?void 0:a.ads)?void 0:s.showInstreamAdv)?void 0:n.call(s,i)};return t?n():Zt("show",n)})},showRewardedVideo(e){return qt(this,arguments,function*({onShowCalled:e}){const{rewardedBlock:r}=yield a(),i=s(r,Dt);if(console.info("[Native adv TV] show","rewarded instream pageId:",i),!r)return Promise.reject(new Error("No rewarded block for show"));const n=()=>{var t,r,a,s,n;return(null==(r=null==(t=window.yandex)?void 0:t.ads)?void 0:r.showInstreamAdv)&&e(),null==(n=null==(s=null==(a=window.yandex)?void 0:a.ads)?void 0:s.showInstreamAdv)?void 0:n.call(s,i)};return t?n():Zt("show",n)})}}}(this.advManager):this.nativeAdv=function(e){let t;function r(){if(!t){const r=(0,Bt.W5)();t=JSON.stringify(((e,t)=>{for(var r in t||(t={}))Mt.call(t,r)&&$t(e,r,t[r]);if(jt)for(var r of jt(t))Ht.call(t,r)&&$t(e,r,t[r]);return e})({app_id:e.appId,clid:(0,Lt.X)()},r?{gclid:r}:{}))}return t}const a=window.appData.isGamesLiteApp;let s=null;function i(){return Ft(this,null,function*(){return null===s&&(s=yield Et({advBlocks:e.advBlocks,flags:e.flags,residenceInfo:e.residenceInfo})),s})}return{getFullscreenBlockId(){return Ft(this,null,function*(){const{fullscreenBlock:e}=yield i();return e})},getRewardedBlockId(){return Ft(this,null,function*(){const{rewardedBlock:e}=yield i();return e})},preloadFullscreenAdv(){return Ft(this,null,function*(){const{mediation:e,fullscreenBlock:t}=yield i();if(console.info("[Native adv] preload",e,"fullscreen ad:",t),!t)return Promise.reject(new Error("No fullscreen block for preload"));const r=()=>{var r,a,s;return null==(s=null==(a=null==(r=window.yandex)?void 0:r.ads)?void 0:a.preloadFullscreenAdv)?void 0:s.call(a,t,e)};return a?r():Zt("preload",r)})},preloadRewardedVideo(){return Ft(this,null,function*(){const{mediation:e,rewardedBlock:t}=yield i();if(console.info("[Native adv] preload",e,"rewarded video:",t),!t)return Promise.reject(new Error("No rewarded block for preload"));const r=()=>{var r,a,s;return null==(s=null==(a=null==(r=window.yandex)?void 0:r.ads)?void 0:a.preloadRewardedVideo)?void 0:s.call(a,t,e)};return a?r():Zt("preload",r)})},showFullscreenAdv(e){return Ft(this,arguments,function*({onShowCalled:e}){const{mediation:t,fullscreenBlock:s}=yield i(),n=r();if(console.info("[Native adv] show",t,"fullscreen ad:",s,n),!s)return Promise.reject(new Error("No fullscreen block for show"));const o=()=>{var r,a,i,o,l;return(null==(a=null==(r=window.yandex)?void 0:r.ads)?void 0:a.showFullscreenAdv)&&e(),null==(l=null==(o=null==(i=window.yandex)?void 0:i.ads)?void 0:o.showFullscreenAdv)?void 0:l.call(o,s,t,{revenueData:n})};return a?o():Zt("show",o)})},showRewardedVideo(e){return Ft(this,arguments,function*({onShowCalled:e}){const{mediation:t,rewardedBlock:s}=yield i(),n=r();if(console.info("[Native adv] show",t,"rewarded video:",s,n),!s)return Promise.reject(new Error("No rewarded block for show"));const o=()=>{var r,a,i,o,l;return(null==(a=null==(r=window.yandex)?void 0:r.ads)?void 0:a.showRewardedVideo)&&e(),null==(l=null==(o=null==(i=window.yandex)?void 0:i.ads)?void 0:o.showRewardedVideo)?void 0:l.call(o,s,t,{revenueData:n})};return a?o():Zt("show",o)})}}}(this.advManager),(0,St.x)()&&!(0,j.dx)(e.flags)||this.init()}init(){var e;this.onServiceLoaded();const{flags:t}=this.advManager;!this.hasFullscreenAdv||this.advManager.isInterstitialAdsTurnOff||(0,Me.uy)(t)||this.preloadFullscreenAdv({clickDaemon:new Ue.U({app_id:this.advManager.appId,game_id:this.advManager.appId,tag:b.$H.INTERSTITIAL})}),this.hasRewarderdAdv&&(null==(e=this.advManager.getAdvBlocksByCurrentPlatform())?void 0:e.rewarded)&&!(0,Me.uK)(t)&&(this.preloadRewardedAdvTimer=setTimeout(()=>{this.preloadRewardedAdv({clickDaemon:new Ue.U({app_id:this.advManager.appId,game_id:this.advManager.appId,tag:b.$H.REWARDED}),reason:Ve.p_.PRELOAD}),this.preloadRewardedAdvTimer=null},15*me.WT))}getAdvBlockId(e){var t,r;return e===b.$H.REWARDED?null!=(t=this.rewardedBlock)?t:super.getAdvBlockId(e):null!=(r=this.fullscreenBlock)?r:super.getAdvBlockId(e)}getTimeoutExtraTime(e,t){return e===oe.QA.ShowFullscreen||e===oe.QA.ShowRewarded?5e3:super.getTimeoutExtraTime(e,t)}withFullscreenBlockId(e){this.fullscreenBlock?e(this.fullscreenBlock):this.nativeAdv.getFullscreenBlockId().then(t=>{this.fullscreenBlock=t,e(t)})}withRewardedBlockId(e){this.rewardedBlock?e(this.rewardedBlock):this.nativeAdv.getRewardedBlockId().then(t=>{this.rewardedBlock=t,e(t)})}preloadFullscreenAdv({clickDaemon:e}){return this.preloadFullscreenAdvPromise||(this.preloadFullscreenAdvPromise=new Promise((t,r)=>{this.withFullscreenBlockId(a=>{this.rawPreloadFullscreenAdv({fullscreenBlock:a,clickDaemon:e}).then(e=>{t(e)}).catch(r)})})),this.preloadFullscreenAdvPromise}rawPreloadFullscreenAdv(e){return Ut(this,arguments,function*({fullscreenBlock:e,clickDaemon:t}){this.lastFullscreenError=void 0,this.fullscreenPreloadAdStatus="preloading";try{if(Ot)return t.bindRequest(Ot),this.fullscreenPreloadAdStatus="preloaded",Promise.resolve(t)}catch(e){(0,te.g5)(this,{tag:b.$H.INTERSTITIAL,error:e,name:"Error while restore request from sessionStorage"})}t.request({advBlockId:e,provider:pe.e.Native,reason:Ve.p_.PRELOAD});try{return yield this.nativeAdv.preloadFullscreenAdv(),this.fullscreenPreloadAdStatus="preloaded",t.response(),t}catch(e){throw this.fullscreenPreloadAdStatus="not_preloaded",this.lastFullscreenError=e,t.error(e.message),(0,te.g5)(this,{tag:b.$H.INTERSTITIAL,error:e,name:"preloading failed"}),_t("preloadFullscreenAdv",e.message),e}})}preloadRewardedAdv({clickDaemon:e,reason:t}){return this.preloadRewardedAdvTimer&&(clearTimeout(this.preloadRewardedAdvTimer),this.preloadRewardedAdvTimer=null),this.preloadRewardedAdvPromise||(this.preloadRewardedAdvPromise=new Promise((r,a)=>{this.withRewardedBlockId(s=>{this.rawPreloadRewardedAdv({rewardedBlock:s,clickDaemon:e,reason:t}).then(e=>{r(e)}).catch(a)})})),this.preloadRewardedAdvPromise}rawPreloadRewardedAdv(e){return Ut(this,arguments,function*({rewardedBlock:e,clickDaemon:t,reason:r}){this.lastRewardedError=void 0,this.rewardedPreloadAdStatus="preloading",t.request({advBlockId:e,provider:pe.e.Native,reason:r});try{return yield this.nativeAdv.preloadRewardedVideo(),this.rewardedPreloadAdStatus="preloaded",t.response(),t}catch(e){throw this.rewardedPreloadAdStatus="not_preloaded",this.lastRewardedError=e,t.error(e.message),(0,te.g5)(this,{tag:b.$H.REWARDED,error:e,name:"preloading failed"}),_t("preloadRewardedVideo",e.message),e}})}},onboarding_promo:ir,parent_window:gr,playgama:class extends he{constructor(e,t){const{serviceName:r}=t;var a;super(e,t,r),Pr(this,"symbol"!=typeof(a="provider")?a+"":a,undefined),this.init()}init(){return Er(this,null,function*(){var e,t;try{this.provider=yield(0,T.l)(E.oO.Playgama);const{clid:r}=null!=(t=null==(e=(0,yr.getDomainConfig)().adv.shared.playgama)?void 0:e.targeting)?t:{};r&&this.advManager.appId&&window.pgAds.updateTargeting({playgama_clid:r,gameId:this.advManager.appId}),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}showOutOfPageAdv(e){return Er(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,tag:a,debugLabel:s,handleReward:i}){return new Promise((n,o)=>Er(this,null,function*(){try{const{provider:s}=this;if(!s)return o(new Error("Provider not loaded."));const l=this.getAdvBlockId(a,r);let d;e.onOpen(!1),t.request({advBlockId:l}),d=yield s.createSlot({blockId:l,type:a});const{isEmpty:c}=yield s.preloadSlot({slot:d});if(c)throw t.responseEmpty(),new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:c});t.response(),n();const{closePromise:u}=yield s.showSlot(d);t.show();const h=yield u;i&&(null==h?void 0:h.wasRewarded)&&e.onRewarded(),e.onClose(null==h?void 0:h.wasRewarded)}catch(e){(0,Ae.q)(`${s} failed with error`,e),o(e)}}))})}getTimeoutExtraTime(e,t){if(e===oe.QA.ServiceInit)return 3*me.WT}getAdvBlockId(e,t){return"playgama_"+e}showFullscreenAdv(e){return this.showOutOfPageAdv(Tr(Ir({},e),{debugLabel:"showFullscreenAdv",handleReward:!1}))}showRewardedVideo(e){return Er(this,null,function*(){return this.showOutOfPageAdv(Tr(Ir({},e),{debugLabel:"showRewardedVideo",handleReward:!0}))})}},prebid_tgo:class extends he{constructor(e,t){super(e,t,pe.e.PrebidTGO),ra(this,"fullscreenSlot",null),ra(this,"interstitialPreload"),ra(this,"rewardedPreload"),ra(this,"interstitialPreloadTimeout",xr.HF),ra(this,"api"),ra(this,"useRewarded",!1),ra(this,"usePrebid",!0),ra(this,"waitForAuction",new S.Z),ra(this,"prebidAuctionTimeout"),ra(this,"isPrebidAuctionRunning"),ra(this,"startPrebidAuction",(0,Cr.P)(()=>{if(_r("Start prebid auction"),this.isPrebidAuctionRunning)return;this.isPrebidAuctionRunning=!0;const{pbjs:e}=window;this.prebidAuctionTimeout=window.setTimeout(()=>{_r("No auction handled, call empty function."),this.prebidAuctionHandler()},lt.XI),e.que.push(()=>aa(this,null,function*(){e.requestBids({adUnitCodes:[this.getAdvBlockId(b.$H.INTERSTITIAL)],bidsBackHandler:this.prebidAuctionHandler,timeout:(0,zr.cm)(this.advManager.flags)})}))},lt.kw)),ra(this,"prebidAuctionHandler",(e,t)=>{clearTimeout(this.prebidAuctionTimeout),t&&(0,Pe.H)({block:Te.W.ADV},new Error("[prebid_sticky] Auction finished with bidders timed out.")),(0,Ur.H)({advTag:b.$H.INTERSTITIAL,adUnitCodes:[this.getAdvBlockId(b.$H.INTERSTITIAL)],bids:e});const{pbjs:r,googletag:a}=window;a.cmd.push(()=>{r.que.push(()=>{r.setTargetingForGPTAsync([this.getAdvBlockId(b.$H.INTERSTITIAL)]),_r("End prebid auction"),this.waitForAuction.resolve(),this.isPrebidAuctionRunning=!1})})}),ra(this,"showFullscreenAdv",e=>aa(this,[e],function*({callbacks:e,clickDaemon:t,reason:r,depth:a,initialTag:s}){return new Promise((i,n)=>aa(this,null,function*(){this.clearPreloadInterstitialTimer(),yield(0,Lr.bT)(()=>aa(this,null,function*(){try{let n=!1;_r("Call fullscreen show"),c.Z.post({type:"adv-fullscreen-block",action:"show",data:{onOpen:()=>{e.onOpen(!1)},onClose:()=>{(s!==b.$H.REWARDED||n)&&(e.onClose(n),this.preloadInterstitial())}}});const{isEmpty:o,clickDaemon:l}=yield this.interstitialPreload.preload({reason:r,depth:a,clickDaemon:t});if(l&&t.bindRequest(l),o)throw new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:!0});n=!0,i(),yield this.interstitialPreload.show(),t.show(),c.Z.post({type:"adv-fullscreen-block",action:"show-controls",data:{blockName:this.serviceName}})}catch(e){this.preloadInterstitial(),n(e)}}))}))})),ra(this,"showRewardedVideo",e=>aa(this,[e],function*({callbacks:e,clickDaemon:t,depth:r,reason:a}){return new Promise((s,i)=>aa(this,null,function*(){try{const{isEmpty:i,waitForShow:n,clickDaemon:o}=yield this.rewardedPreload.preload({depth:r,clickDaemon:t,reason:a});if(o&&t.bindRequest(o),i||!n)throw new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:!0});s(),e.onOpen(!0);const{wasRewarded:l,wasShown:d}=yield n((0,Dr.v_)({on:"adv_rewarded.prebid_tgo.delayed_on_rewarded"},()=>{},()=>({onRewarded:()=>{e.onRewarded()}})));(0,Dr.v_)({on:"adv_rewarded.prebid_tgo.delayed_on_rewarded"},()=>{l&&e.onRewarded()}),e.onClose(d)}catch(e){i(e)}}))}));const{flags:r}=e;this.isTagActive(b.$H.INTERSTITIAL)&&(0,j.Wv)(r)&&(0,zr.z4)(b.$H.INTERSTITIAL)||(this.usePrebid=!1),this.isTagActive(b.$H.REWARDED)&&(this.useRewarded=!0,this.rewardedPreload=new Gr(this)),this.interstitialPreload=new Hr(this),this.api=new Rr.Z(window.appData.apiData),this.init()}getTimeoutExtraTime(e,t){if(e===oe.QA.ShowFullscreen&&t===Ve.p_.START_FULLSCREEN)return 2e3}getAdvBlockId(e,t=Ve.p_.ONSPOT){switch(e){case b.$H.INTERSTITIAL:return t===Ve.p_.START_FULLSCREEN?this.advManager.allPrebidAdvBlocks.preroll:this.advManager.allPrebidAdvBlocks.interstitial;case b.$H.REWARDED:return this.advManager.allPrebidAdvBlocks.rewarded;default:throw new Error(`AdvTag ${e} not supported by this service.`)}}init(){return aa(this,null,function*(){var e,t;const r=(0,zr.cQ)({cdnUrl:this.advManager.context.cdnUrl,flags:this.advManager.flags,fullUrl:(0,rt.e)().href,options:{isSlowCountry:this.advManager.context.isSlowCountry}});yield(0,Lr.xq)({metrikaCounter:null==(e=(0,yr.getDomainConfig)().analytics.counters)?void 0:e.metrika,parallel:null!=(t=(0,j.RM)(this.advManager.flags,Ke.Z.prebidLoadAfterGpt))&&t,prebidScriptUrl:this.usePrebid?r:void 0}).then(e=>{e.prebid||(this.usePrebid=!1,this.waitForAuction.resolve(),e.prebidError&&(0,te.g5)(this,{error:new Error(`Failed to load Prebid.js: ${e.prebidError.message}`)})),e.gpt?window.setTimeout(()=>{this.initGPT().then(()=>this.usePrebid?this.initPrebid():void 0).then(()=>{this.interstitialPreloadTimeout===xr.HF&&this.preloadInterstitial(),this.useRewarded&&this.hasRewarderdAdv&&this.rewardedPreload.preload().catch(e=>_r("Preload error",e))}).catch(e=>{_r(e),this.onServiceError(e)})},0):(_r(e.gptError),this.onServiceError(e.gptError))})})}initGPT(){return aa(this,null,function*(){return yield(0,Lr.Vg)(),(0,Lr.bT)(e=>{e.enableServices(),this.onServiceLoaded()})})}initPrebid(){return aa(this,null,function*(){yield(0,zr.BA)(e=>aa(this,null,function*(){yield(0,zr.OH)();const t=((e,t)=>Yr(e,Xr(t)))(((e,t)=>{for(var r in t||(t={}))Qr.call(t,r)&&ta(e,r,t[r]);if(Jr)for(var r of Jr(t))ea.call(t,r)&&ta(e,r,t[r]);return e})({},(0,zr.Zt)(this.advManager.flags)),{code:this.getAdvBlockId(b.$H.INTERSTITIAL)}),r=(0,j.QR)(this.advManager.flags,Ke.Z.prebidExtraBids);if((0,Vr.GI)(r)){const e=r.reduce((e,t)=>(lt.Hf[t]&&e.push(lt.Hf[t]),e),[]);t.bids=[...t.bids,...e]}const a=(0,j.QR)(this.advManager.flags,Ke.Z.prebidDisabledBids);(0,Vr.GI)(a)&&(t.bids=t.bids.filter(({bidder:e})=>!a.includes(e))),_r("interstitial ad units react",t),e.addAdUnits(t),e.onEvent("auctionEnd",e=>{const t=e.auctionEnd-e.timestamp;_r(`Prebid auction took: ${t}ms`),(0,le.s4)("play_prebid_interstitial_auction_time",t)})}))})}clearPreloadInterstitialTimer(){clearTimeout(this.interstitialPreloadTimeout)}preloadInterstitial(){this.clearPreloadInterstitialTimer(),this.interstitialPreloadTimeout=window.setTimeout(()=>{this.interstitialPreload.preload({beforeRequest:this.usePrebid?()=>(this.waitForAuction.resolve(),this.waitForAuction=new S.Z,this.startPrebidAuction(),this.waitForAuction.promise):void 0})},this.advManager.minIntervalBetweenAds*je.j2)}cancelShow(e){switch(e){case b.$H.INTERSTITIAL:c.Z.post({type:"adv-fullscreen-block",action:"hide"});break;case b.$H.REWARDED:this.rewardedPreload.cancel()}}onShowAdvFinished({tag:e}){switch(e){case b.$H.INTERSTITIAL:break;case b.$H.REWARDED:window.setTimeout(()=>{this.rewardedPreload.preload().catch(e=>_r("Preload error",e))},this.advManager.minIntervalBetweenAds*je.j2)}}},promo:Qt,publift_zone:class extends he{constructor(e,t){const{serviceName:r}=t;if(r!==pe.e.PubliftZone)throw new Error(`Invalid service name: ${r}, ${pe.e.PubliftZone} expected.`);super(e,t,r),oi(this,"provider"),oi(this,"interstitialPreload"),oi(this,"rewardedPreload"),oi(this,"interstitialPreloadTimeout"),oi(this,"rewardedPreloadTimeout"),this.init()}showFullscreenAdv({callbacks:e,clickDaemon:t,reason:r,depth:a,initialTag:s}){return new Promise((i,n)=>li(this,null,function*(){try{if(!this.provider||!this.interstitialPreload)return void n(new Error("Publift provider not loaded."));let o,l=!1;yield c.Z.post({type:"adv-fullscreen-block",action:"show",data:{onOpen:()=>{e.onOpen(!1)},onClose:()=>li(this,null,function*(){var t;i(),e.onClose(l),o&&(yield null==(t=this.interstitialPreload)?void 0:t.destroySlot())})}});const d=yield this.interstitialPreload.preload({reason:r,clickDaemon:t,depth:a,initialTag:s}),{isEmpty:u,clickDaemon:h}=d;if(h&&t.bindRequest(h),u)throw new te.lu("Slot is empty",{isEmpty:!0});o=d.slot,l=!0,i(),yield this.interstitialPreload.show(),t.show(),c.Z.post({type:"adv-fullscreen-block",action:"show-controls",data:{blockName:this.interstitialPreload.blockName}})}catch(e){n(e)}}))}showRewardedVideo({reason:e,clickDaemon:t,callbacks:r}){return new Promise((a,s)=>li(this,null,function*(){var i;try{if(!this.rewardedPreload)return void s(new Error("Provider not loaded."));const n=yield this.rewardedPreload.preload({reason:e,clickDaemon:t,providerLoaderName:null==(i=this.provider)?void 0:i.providerLoaderName}),{isEmpty:o,waitForShow:l,clickDaemon:d}=null!=n?n:{};if(d&&t.bindRequest(d),o||!l)throw new te.lu(lt.XO.EMPTY_SLOT,{isEmpty:!0});a(),r.onOpen(!0);const{wasRewarded:c,wasShown:u}=yield l();c&&r.onRewarded(),r.onClose(u)}catch(e){s(e)}}))}preloadRewarded(){clearTimeout(this.rewardedPreloadTimeout),this.rewardedPreloadTimeout=window.setTimeout(()=>{var e,t;null==(t=this.rewardedPreload)||t.preload({providerLoaderName:null==(e=this.provider)?void 0:e.providerLoaderName})},5e3)}preloadInterstitial(){clearTimeout(this.interstitialPreloadTimeout),this.interstitialPreloadTimeout=window.setTimeout(()=>{var e;null==(e=this.interstitialPreload)||e.preload({initialTag:b.$H.INTERSTITIAL})},this.advManager.minIntervalBetweenAds*je.j2)}init(){return li(this,null,function*(){var e;try{const t=this.isTagActive(b.$H.INTERSTITIAL),r=this.isTagActive(b.$H.REWARDED),a=t||r?yield(0,T.l)(E.oO.PubliftZone):null;a&&(this.provider=a,t&&(this.interstitialPreload=new ii(this,this.provider),this.preloadInterstitial()),r&&(this.rewardedPreload=new Gr(this),this.rewardedPreload.preload({providerLoaderName:null==(e=this.provider)?void 0:e.providerLoaderName}).catch(e=>ti("Preload error",e)))),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}getTimeoutExtraTime(e,t){return e===oe.QA.ServiceInit?3*me.WT:super.getTimeoutExtraTime(e,t)}getAdvBlockId(e,t){var r,a,s,i,n,o;switch(e){case b.$H.INTERSTITIAL:return null!=(s=null==(a=null==(r=this.advManager.allAdvBlocks.publift)?void 0:r.interstitial)?void 0:a.blockId)?s:"invalid_block";case b.$H.REWARDED:return null!=(o=null==(n=null==(i=this.advManager.allAdvBlocks.publift)?void 0:i.rewarded)?void 0:n.blockId)?o:"invalid_block"}return super.getAdvBlockId(e,t)}cancelShow(e){var t;switch(e){case b.$H.INTERSTITIAL:c.Z.post({type:"adv-fullscreen-block",action:"hide"});break;case b.$H.REWARDED:null==(t=this.rewardedPreload)||t.cancel()}}onShowAdvFinished({tag:e}){switch(e){case b.$H.INTERSTITIAL:this.preloadInterstitial();break;case b.$H.REWARDED:this.preloadRewarded()}}},transsion:class extends he{constructor(e,t){super(e,t,pe.e.Transsion),na(this,"api"),na(this,"googleKeyValues"),na(this,"onScriptLoaded",e=>{var t,r;const{advManager:a}=this,{playPageData:s}=a.context;null==(r=window.h5sdk)||r.init(parseInt(s.gameInfo.appId,10),"","","","",{float:{env:"pre"},ga:{id:null==(t=(0,yr.getDomainConfig)().analytics.counters)?void 0:t.ga},adsense:{client:e.dataset.adClient,"data-ad-channel":e.dataset.adChannel,"data-ad-frequency-hint":e.dataset.adFrequencyHint,callback:()=>{var e;null==(e=window.h5sdk)||e.adConfig({preloadAdBreaks:"on",sound:"off",onReady:()=>{this.onServiceLoaded()}})}}})}),na(this,"processShowResult",({clickDaemon:e,info:t,reject:r,resolve:a})=>{if(["viewed","dismissed"].includes(t.breakStatus))return e.response(),void a();const s=!["noAdPreloaded","other","timeout"].includes(t.breakStatus);s?e.error(`${Ve.Ud.ERROR}_${t.breakStatus}`):e.responseEmpty(),r(new te.lu(`Transsion AdBreak returned ${t.breakStatus} status`,{isEmpty:!s}))}),na(this,"openWithLog",e=>()=>{null==e||e(),this.api.sendAdvShow({advService:this.serviceName,googleKeyValues:this.googleKeyValues})}),na(this,"showFullscreenAdv",e=>oa(this,[e],function*({callbacks:e,clickDaemon:t,depth:r}){return new Promise((a,s)=>{var i,n,o;const{advManager:l}=this,d=null!=(i=(0,j.di)(l.flags,Ke.Z.transsionFullscreenPlacementType))?i:"preroll";"preroll"===d?null==(n=window.h5sdk)||n.adBreak({adBreakDone:i=>{"viewed"!==i.breakStatus&&"dismissed"!==i.breakStatus||(this.openWithLog(e.onOpen)(),e.onClose(!0)),this.processShowResult({tag:b.$H.INTERSTITIAL,depth:r,info:i,clickDaemon:t,resolve:a,reject:s})},type:d}):null==(o=window.h5sdk)||o.adBreak({afterAd:e.onClose.bind(this,!0),adBreakDone:e=>{this.processShowResult({tag:b.$H.INTERSTITIAL,depth:r,info:e,clickDaemon:t,resolve:a,reject:s})},beforeAd:()=>{this.openWithLog(e.onOpen)},type:d})})})),na(this,"showRewardedVideo",e=>oa(this,[e],function*({callbacks:e,clickDaemon:t,depth:r}){return new Promise((a,s)=>{var i;null==(i=window.h5sdk)||i.adBreak({adDismissed:e.onClose.bind(this,!1),afterAd:e.onClose.bind(this,!0),adBreakDone:e=>{this.processShowResult({tag:b.$H.REWARDED,depth:r,info:e,clickDaemon:t,resolve:a,reject:s})},adViewed:e.onRewarded,beforeAd:()=>{this.openWithLog(e.onOpen)},beforeReward:e=>{e()},type:"reward"})})})),this.api=new Rr.Z(window.appData.apiData),this.init()}getAdvBlockId(e){return sa}getTimeoutExtraTime(e){return e===oe.QA.ServiceInit?5e3:1e4}init(){this.loadScript(),(0,Lr.N5)().then(e=>{this.googleKeyValues=e})}loadScript(){var e,t,r;window.t3wgame=!0;const{advManager:a}=this,{playPageData:s}=a.context;let i=(0,j.di)(a.flags,Ke.Z.transsionAdChannel);if(!i){const{gameSettings:a}=s;(null==(r=null==(t=null==(e=null==a?void 0:a.advInfo)?void 0:e.adsense)?void 0:t.channel)?void 0:r.id)&&(i=a.advInfo.adsense.channel.id)}(0,Ie.x)({id:"transsion-script",dataset:{adChannel:i,adClient:sa,adFrequencyHint:"50s"},src:"https://www.hippoobox.com/static/sdk/adsdk_1.4.0.0.js"}).then(e=>{this.validateH5SdkObject(window.h5sdk)&&this.onScriptLoaded(e)}).catch(e=>{this.onServiceError(e)})}validateH5SdkObject(e){if(!e||"object"!=typeof e)throw new Error("Can not find valid window.h5sdk");if("function"!=typeof e.init)throw new Error("window.h5sdk.init method is not a function");return!0}},yandex:class extends he{constructor(e,t){super(e,t,pe.e.Yandex),Ms(this,"advContainer"),Ms(this,"cssClasses"),Ms(this,"cssViewTypeClass"),Ms(this,"destroyAdv"),Ms(this,"isFullscreenShowing",!1),Ms(this,"isRewardedShowing",!1),Ms(this,"startReason"),Ms(this,"savedPageYOffset"),Ms(this,"showAdvCallbacks",{[b.$H.INTERSTITIAL]:null,[b.$H.REWARDED]:null}),Ms(this,"prerenderDelayPromise"),Ms(this,"fullscreenPrerender"),Ms(this,"rewardedPrerender"),Ms(this,"isPreloadFullscreenAdvEnabled"),Ms(this,"closeAdvOnEscape",null),Ms(this,"onScriptLoadedSuccessful",()=>{this.onScriptFinish(()=>{this.fullscreenPrerender||!this.isTagActive(b.$H.INTERSTITIAL)||this.isTagWaterfall(b.$H.INTERSTITIAL)||!this.hasFullscreenAdv||this.advManager.isAdvDisabled||(this.fullscreenPrerender=this.initFullscreenPrerender(this.options.tags[b.$H.INTERSTITIAL]===oe.pP.Start?Ve.p_.START_FULLSCREEN:Ve.p_.PRELOAD,this.getClickDaemon(b.$H.INTERSTITIAL))),this.isTagActive(b.$H.REWARDED)&&!this.isTagWaterfall(b.$H.REWARDED)&&this.hasRewarderdAdv&&this.initRewardedPrerender()}),this.onServiceLoaded()}),Ms(this,"onScriptLoadedWithError",e=>{Sa(),this.onServiceError(e)}),Ms(this,"debounceNewFullscreenAdvLoad",()=>{this.isRewardedShowing||this.isPreloadFullscreenAdvEnabled||this.preloadFullscreenAdv(Ve.p_.PRELOAD)}),this.cssClasses=ka(),this.cssViewTypeClass=(0,te.TE)(e.viewType),this.debounceNewFullscreenAdvLoad=(0,Ns.D)(this.debounceNewFullscreenAdvLoad,1e3),this.init()}init(){this.closeOnEscape(),this.initMessaging()}initMessaging(){c.Z.onInternalMessage("yandex-adv-service",e=>{switch(e.data.action){case"close-adv":case"bottom-button-close-adv":this.hideFullscreenAdv(!0);break;case"adv-container-mounted":this.advContainer=document.querySelector(`.${je.kn.modal}.${(0,te.el)("yandex")}.${je.kn.modalFullscreen}`),this.loadScript(),this.initDOMEvents()}})}initDOMEvents(){const{advManager:{viewType:e}}=this;e===je.xd.fullscreen&&(window.addEventListener("resize",()=>{this.savedPageYOffset=(0,te.SW)(this.advContainer)}),$e.default.addChangeListener(()=>{this.isFullscreenShowing&&this.isPreloadFullscreenAdvEnabled?(ba("Screen orientation was changed, set `rerenderForced = true` and hide/show."),this.hideFullscreenAdv(void 0,!0)):this.debounceNewFullscreenAdvLoad()}),(0,te.zw)())}loadScript(){Array.isArray(window.yandexContextAsyncCallbacks)||(window.yandexContextAsyncCallbacks=[]),window.yandexContextAsyncCallbacks.push(this.onScriptLoadedSuccessful),(0,Ie.x)({id:"yandexads-context",src:this.advManager.context.yaAdsScript}).catch(this.onScriptLoadedWithError)}getTimeoutExtraTime(e,t){if(e===oe.QA.ShowFullscreen&&t===Ve.p_.WATERFALL)return 1500}startPrerenderDelayPromise(e){this.prerenderDelayPromise=new Promise(t=>{setTimeout(()=>{null==e||e(),t()},2e3)})}initFullscreenPrerender(e,t){return this.fullscreenPrerender?this.fullscreenPrerender:(this.isPreloadFullscreenAdvEnabled=!1,ba("initFullscreenPrerender, reason =",e),ba(`isPreloadFullscreenAdvExperimentEnabled = ${this.isPreloadFullscreenAdvEnabled}`),this.isPreloadFullscreenAdvEnabled?new ns(this,e,t):new Va(this,e,t))}initRewardedPrerender(e=Ve.p_.PRELOAD){var t;if(this.rewardedPrerender)return;const r=null==(t=this.getAdvBlocksByPcodePlatform())?void 0:t.rewarded;r&&(this.rewardedPrerender=r.renderer===b.bW.PCODE?new Bs(this,e):new As(this,e),this.preloadRewardedAdv(e))}onScriptFinish(e){Sa(),this.startPrerenderDelayPromise(e)}getAdvBlocksByPcodePlatform(){return this.advManager.getAdvBlocksByPlatform(Ea())}getAdvBlockId(e,t,r){var a,s,i;if((0,St.x)())return e===b.$H.REWARDED?je.EC.rewarded:je.EC.fullscreen;const{advBlocks:n,deviceType:o}=this.advManager;return e===b.$H.REWARDED?null!=(a=Ia({advBlocks:n,deviceType:o}))?a:"":Pa({advBlocks:n,deviceType:o,reason:t,waterfallItem:(null==(i=null==(s=this.getAdvBlocksByPcodePlatform())?void 0:s.fullscreen)?void 0:i.renderer)===b.bW.PCODE?r:void 0})}closeOnEscape(){this.closeAdvOnEscape=e=>{"Escape"===e.key&&this.hideFullscreenAdv(!0)},window.addEventListener("keydown",this.closeAdvOnEscape)}hideFullscreenAdv(e,t){var r,a,s,i,n;this.screenUnlock(),this.isFullscreenShowing=!1,ba("hideFullscreenAdv, rerenderForced =",t);const{advManager:o}=this;null==(r=this.destroyAdv)||r.call(this);const l=this.getClickDaemon(b.$H.INTERSTITIAL);if(t){this.preloadFullscreenAdv();const e=null!=(s=null==(a=this.fullscreenPrerender)?void 0:a.previousReason)?s:Ve.p_.PRELOAD;return void this.showFullscreenAdv({callbacks:this.showAdvCallbacks[b.$H.INTERSTITIAL],clickDaemon:l,reason:e,depth:0,tag:b.$H.INTERSTITIAL,initialTag:b.$H.INTERSTITIAL})}(0,te.PS)(),this.closeAdvOnEscape&&(window.removeEventListener("keydown",this.closeAdvOnEscape),this.closeAdvOnEscape=null),o.deviceType!==wa.n.desktop&&ca(),c.Z.post({type:"yandex-fullscreen-render",action:"hide-fullscreen"}),window.scroll(0,this.savedPageYOffset),null==(i=this.fullscreenPrerender)||i.next(this.options.tags[b.$H.INTERSTITIAL]===oe.pP.Start?Ve.p_.PRELOAD:Ve.p_.PRELOAD_WATERFALL,l),e&&(null==(n=this.showAdvCallbacks[b.$H.INTERSTITIAL])||n.onClose(e),o.callOnAdvClose(e),(0,R.D)())}showAdvContainer({initialTag:e}){const{advManager:t}=this,{flags:r}=t;this.isFullscreenShowing=!0;const{deviceType:a}=this.advManager;setTimeout(()=>{var s;window.focus(),a!==wa.n.desktop&&da(),c.Z.post({type:"yandex-fullscreen-render",action:"show-fullscreen",data:{initialTag:e}}),this.savedPageYOffset=(0,te.SW)(this.advContainer);const i=(null==(s=this.advManager.context.uatraits)?void 0:s.OSFamily)===la.k.IOS;a===wa.n.desktop?(0,te.ss)({advElement:this.advContainer.querySelector(`.${this.cssClasses.modalWrap}`),type:"fullscreen",flags:t.flags,appId:t.appId,isIOS:i}):(0,te.ss)({advElement:this.advContainer,type:"fullscreen",flags:t.flags,appId:t.appId,isIOS:i}),r.autoclose_adv&&setTimeout(()=>{this.hideFullscreenAdv(!0)},r.autoclose_adv)},0)}preloadFullscreenAdv(e){var t;null==(t=this.fullscreenPrerender)||t.next(e,this.getClickDaemon(b.$H.INTERSTITIAL))}preloadRewardedAdv(e){var t;null==(t=this.rewardedPrerender)||t.next(e)}showFullscreenAdv(e){return Hs(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,initialTag:a,waterfallItem:s}){return new Promise((i,n)=>Hs(this,null,function*(){var o,l,d;try{this.showAdvCallbacks[b.$H.INTERSTITIAL]=e,ba("showFullscreenAdv"),this.screenLock(),this.fullscreenPrerender||(this.fullscreenPrerender=this.initFullscreenPrerender(r,t));const{fullscreenPrerender:n}=this;yield this.prerenderDelayPromise,a===b.$H.REWARDED&&(null==(l=null==(o=this.getAdvBlocksByPcodePlatform())?void 0:o.fullscreen)?void 0:l.renderer)===b.bW.PCODE&&(null==(d=this.fullscreenPrerender)||d.next(Ve.p_.WATERFALL,t,{initialTag:a,waterfallItem:s}));const{hasContent:c,err:u,clickDaemon:h}=yield n.ready().then(e=>e.showPrerenderedAd?e.showPrerenderedAd():e);if(h&&t.bindRequest(h),u)throw u;if(!c)throw new te.lu(je.qS,{isEmpty:!0});e.onOpen(),(0,te.WL)(),this.showAdvContainer({initialTag:a}),i()}catch(e){this.screenUnlock(),n(e),(0,Dr.v_)({on:"adv_interstitial.yandex.enable_preload_retries"})&&this.fullscreenPrerender instanceof ma&&this.fullscreenPrerender.retryPreloading(Ve.p_.PRELOAD,b.$H.INTERSTITIAL)}}))})}showRewardedVideo(e){return Hs(this,arguments,function*({callbacks:e,clickDaemon:t,reason:r,depth:a}){return new Promise((s,i)=>Hs(this,null,function*(){var n,o,l;try{const{advManager:i}=this;if(this.showAdvCallbacks[b.$H.REWARDED]=e,!this.rewardedPrerender&&(null==(n=i.getAdvBlocksByCurrentPlatform())?void 0:n.rewarded)&&this.initRewardedPrerender(r),yield this.prerenderDelayPromise,!(null==(o=i.getAdvBlocksByCurrentPlatform())?void 0:o.rewarded))throw new Error("partnerId is not defined, no rewarded video adv block available");yield null==(l=this.rewardedPrerender)?void 0:l.showRewardedVideo({callbacks:e,clickDaemon:t,reason:r,tag:b.$H.REWARDED,initialTag:b.$H.REWARDED,depth:a}),s()}catch(e){i(e)}}))})}screenLock(){const{advManager:{flags:e}}=this;(0,j.F7)(e)&&$e.default.lock().catch(()=>{})}screenUnlock(){const{advManager:{flags:e}}=this;(0,j.F7)(e)&&$e.default.unlock().catch(()=>{})}getClickDaemon(e){const{advManager:t}=this;return new Ue.U({app_id:t.appId,game_id:t.appId,tag:e})}},yandex_inapp_promo:class extends he{constructor(e,t){const{serviceName:r}=t;super(e,t,r),Ws(this,"provider"),Ws(this,"advBlocks",{}),Ws(this,"isPcode",!1),this.advBlocks=(0,f.CB)(e.flags),this.init()}init(){return Zs(this,null,function*(){try{this.provider=yield(0,T.l)(E.oO.YandexBlock),this.isPcode||(yield(0,ve.b)({querySelector:`.${M}`,interval:100,rejectTimeout:1500}),yield c.Z.post({type:"adv-fullscreen-block",action:"add-block",data:{blockName:this.serviceName},timeout:me.WT})),this.onServiceLoaded()}catch(e){this.onServiceError(e)}})}getAdvBlockId(){var e,t;const{deviceType:r}=this.advManager,a="desktop"===r?"desktop":"mobile";return(null==(t=null==(e=this.advBlocks)?void 0:e.interstitial)?void 0:t[a])||xr.UV.interstitial[a]}showFullscreenAdv({callbacks:e,clickDaemon:t}){return new Promise((r,a)=>Zs(this,null,function*(){try{const{serviceName:s}=this,i=this.provider;if(!i)return void a(new Error("Yandex Inapp Promo provider not loaded."));const n=this.getAdvBlockId();t.request({advBlockId:n});const o=yield i.createSlot({blockId:n,divId:X(s),location:this.advManager.context.location,type:this.isPcode?"fullscreen":void 0,withPlatform:!!this.isPcode||void 0,isPcode:this.isPcode}),{isEmpty:l,slot:d}=yield i.preloadSlot({slot:o,flags:this.advManager.flags}).then(e=>e.showPrerenderedAd?e.showPrerenderedAd():e);if(l)throw t.responseEmpty(),new te.lu("Slot is empty",{isEmpty:!0});t.response(),(0,$s.E)("interstitial"),r(),e.onOpen(!0);const{closePromise:u}=yield i.showSlot(d);this.isPcode?u.then(({wasShown:t})=>{e.onClose(t),o&&i.destroySlot(o)}):(yield c.Z.post({type:"adv-fullscreen-block",action:"show-block",data:{blockName:s},timeout:me.WT}),yield c.Z.post({type:"adv-fullscreen-block",action:"show",data:{onClose:()=>{e.onClose(),o&&i.destroySlot(o)}}}))}catch(e){a(e)}}))}showRewardedVideo(){return Zs(this,null,function*(){return Promise.reject(new Error("Not implemented exception!"))})}cancelShow(e){this.isPcode||e!==b.$H.INTERSTITIAL||c.Z.post({type:"adv-fullscreen-block",action:"hide"})}}},ci=di;var ui=Object.defineProperty,hi=(e,t,r)=>(((e,t,r)=>{t in e?ui(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const pi=["onOpen","onRewarded","onClose","onError"],vi=class{constructor(e,t){this.tag=e,this.clickDaemon=t,hi(this,"callbacks",{}),hi(this,"currentTag"),hi(this,"isOuterCallbacksMuted",!1),hi(this,"onOpen",(e=!0)=>{var t;e&&(null==(t=this.clickDaemon)||t.show()),this.safeCall("onOpen")}),hi(this,"onRewarded",()=>{var e;null==(e=this.clickDaemon)||e.rewarded(),this.safeCall("onRewarded")}),hi(this,"onClose",e=>{var t;e&&this.currentTag!==this.tag&&this.currentTag===b.$H.INTERSTITIAL&&this.onRewarded(),null==(t=this.clickDaemon)||t.close(),this.safeCall("onClose",void 0,e)}),hi(this,"onError",e=>{this.safeCall("onError",!1,e)});for(const e of pi)this.callbacks[e]||(this.callbacks[e]=[]);this.currentTag=e}safeCall(e,t=!0,...r){if(this.isOuterCallbacksMuted)return void(0,Ae.q)(`AdvCallbacks ${e} call skipped, due mute during waterfall.`);const a=this.callbacks[e];if(a)for(let s=0;s<a.length;s++)(0,te.tq)(a[s],`Error in callback ${e}: `).apply(null,r),t&&a.splice(s--,1)}addCallbacks(e,t=!1){for(const r in e)t&&["onOpen","onRewarded"].includes(r)&&!this.callbacks[r].length?(0,te.tq)(e[r],`Error in callback ${r}`).apply(null):this.callbacks[r].push(e[r])}muteCallbacks(){this.isOuterCallbacksMuted=!0}unmuteCallbacks(){this.isOuterCallbacksMuted=!1}};var mi=r(94365),gi=Object.defineProperty;const yi=me.yR;class fi{constructor(){var e,t;((e,t,r)=>{t in e?gi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(e="canShowAdv")?e+"":e,t),this.setupCanShowAdv()}setupCanShowAdv(){this.canShowAdv=()=>!0,(0,mi.FN)()&&(this.canShowAdv=()=>(console.warn(`Warning: please, try to open advertising after ${yi}ms`),!1),window.setTimeout(()=>{this.canShowAdv=()=>!0},yi))}}var wi=r(99283),bi=r(62305),ki=r(150),Ai=r(34083),Si=r(28250),Pi=Object.defineProperty,Ii=Object.defineProperties,Ti=Object.getOwnPropertyDescriptors,Ei=Object.getOwnPropertySymbols,Ci=Object.prototype.hasOwnProperty,Di=Object.prototype.propertyIsEnumerable,Ri=(e,t,r)=>t in e?Pi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xi=(e,t,r)=>(Ri(e,"symbol"!=typeof t?t+"":t,r),r),_i=(e,t,r)=>new Promise((a,s)=>{var i=e=>{try{o(r.next(e))}catch(e){s(e)}},n=e=>{try{o(r.throw(e))}catch(e){s(e)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);o((r=r.apply(e,t)).next())});const Oi=(0,re.M$)("AdvManager",re.XG.Adv,{background:"seagreen"}),Li=Oi.tag("showAdv");class Bi{constructor(e,t,r){var a,s,i;this.context=e,this.gameControl=t,xi(this,"flags"),xi(this,"appId"),xi(this,"viewType"),xi(this,"deviceId"),xi(this,"deviceType"),xi(this,"advBlocks"),xi(this,"residenceInfo"),xi(this,"advUsedBlocks"),xi(this,"startTime"),xi(this,"lang"),xi(this,"minIntervalBetweenAds"),xi(this,"advDelay"),xi(this,"isInterstitialAdsDisabled"),xi(this,"isInterstitialAdsTurnOff"),xi(this,"isRewardedAdsTurnOff"),xi(this,"isDisableAdButtonEnabled"),xi(this,"withWorldWideAdv"),xi(this,"inactiveTabTime"),xi(this,"callbacksToSdk",{[b.$H.INTERSTITIAL]:null,[b.$H.REWARDED]:null}),xi(this,"firstShowGuard"),xi(this,"guardClosedPromiseWrapper",new S.Z),xi(this,"reasonForDisablingAd"),xi(this,"_showAdvLock",{[b.$H.INTERSTITIAL]:!1,[b.$H.REWARDED]:!1}),xi(this,"_lastShowTime",{[b.$H.INTERSTITIAL]:0,[b.$H.REWARDED]:0}),xi(this,"_showTimes",{[b.$H.INTERSTITIAL]:0,[b.$H.REWARDED]:0}),xi(this,"serviceInstances"),xi(this,"waterfallQueue"),xi(this,"splashScreenPromise",new S.Z),xi(this,"removalGameScreenPromise",new S.Z),xi(this,"middleLayerInGamePromise",new S.Z),xi(this,"allAdvBlocks"),xi(this,"allPrebidAdvBlocks"),xi(this,"_adOpenedType"),xi(this,"logAdvDelayFlag"),xi(this,"servicesBlocks",{[b.$H.INTERSTITIAL]:{},[b.$H.REWARDED]:{}}),xi(this,"handleVisibilityChange",()=>{Oi("handleVisibilityChange",document.visibilityState);const e=(0,j.$9)(this.flags,Ke.Z.minInactivePlayTabTimeToShowAd);e&&("hidden"===document.visibilityState?this.inactiveTabTime=Date.now():this.inactiveTabTime>0&&Date.now()-this.inactiveTabTime>=e&&(Oi("show interstitial after inactive state"),this.showAdv(b.$H.INTERSTITIAL,{reason:Ve.p_.ONSPOT})))}),xi(this,"onGuardMessage",e=>{const{action:t}=e.data;"set-was-showed"===t&&this.resolveGuardPromise()}),xi(this,"onSplashMessage",e=>{const{action:t}=e.data;"set-was-closed"===t&&this.resolveSplashScreenPromise()}),xi(this,"onMiddleLayerMessage",e=>{const{action:t}=e.data;"close"===t&&this.resolveMiddleLayerPromise()}),xi(this,"onGameRemovalScreenMessage",e=>{const{action:t}=e.data;"close"===t&&this.resolveRemovalGameScreenPromise()}),xi(this,"onFrameMessage",e=>{const{action:t}=e.data;t===A.ur.IframeLoaded&&(this.initServices(b.$H.INTERSTITIAL),this.initServices(b.$H.REWARDED),c.Z.offInternalMessage("frame",this.onFrameMessage))}),this.deviceType=e.deviceType,this.allAdvBlocks=e.allAdvBlocks,this.allPrebidAdvBlocks=e.allAdvBlocks.prebid;const n=e.playPageData.gameSettings,{flags:o}=e.abt;this.flags=o,this.withWorldWideAdv=Boolean(e.withWorldWideAdv);const l=(0,mi.pN)(["a_delay","clid",It.Je,"min-interval-between-ads","utm_medium"]);this.deviceId=l[It.Je],this.appId=e.playPageData.gameInfo.appId,this.viewType=this.deviceType===wa.n.desktop?je.xd.desktop:je.xd.fullscreen,this.advBlocks=(0,te.$3)(n.advBlocks,this.appId,o),this.residenceInfo=null==(a=n.advInfo)?void 0:a.residence_info,this.advUsedBlocks=n.advUsedBlocks,this.startTime=Date.now(),this.lang=e.playPageData.request.lang,this.minIntervalBetweenAds=(0,te.mx)(l["min-interval-between-ads"],o,this.withWorldWideAdv),this.advDelay=(0,j.$9)(o,Ke.Z.advDelay)||e.advPartnerInfo.advDelay||(0,te.dh)(l.a_delay)||(e.isTranssion?je.Sk:0),this.isInterstitialAdsDisabled=!1,this.isInterstitialAdsTurnOff=(0,bi.W)(o,b.By.FULLSCREEN,e.advPartnerInfo.blockedPlacements),this.isRewardedAdsTurnOff=(0,bi.W)(o,b.By.REWARDED,e.advPartnerInfo.blockedPlacements),this.isDisableAdButtonEnabled=(0,j.RM)(o,Ke.Z.disableAdButton)||!1,this.firstShowGuard=new fi,(null==(i=null==(s=this.getAdvBlocksByCurrentPlatform())?void 0:s.fullscreen)?void 0:i.blockID)||(0,te.ey)(this.appId),void 0!==l.a_delay&&(0,te.R4)(),Oi("advBlocks",this.advBlocks),Oi("advUsedBlocks",this.advUsedBlocks);const{ingameAdv:d,options:u}=(0,w.HX)();this.waterfallQueue=(0,ls.gK)({flags:o,ingameAdvData:d,trafficSplitProvider:null==u?void 0:u.trafficSplitProvider,withWorldWideAdv:this.withWorldWideAdv,isInAppGame:e.playPageData.gameSettings.extraFeatures.inAppGame}),Oi("waterfallQueue",this.waterfallQueue),this.updateSubscriptionState(r.isAdvDisabledBySubscription),this.initMessaging(),this.showStartFullscreenAdv(),(0,Ai.y)().then(e=>{e||this.resolveGuardPromise()}),e.isGamesApp&&!this.isInterstitialAdsTurnOff&&(0,ls.sf)(this.waterfallQueue.interstitial,pe.e.Native)&&function(e){setTimeout(()=>function(e){return t=this,r=arguments,a=function*({advBlocks:e,appId:t,flags:r,residenceInfo:a}){var s;const{mediation:i,fullscreenBlock:n}=yield Et({advBlocks:e,flags:r,residenceInfo:a}),o=new Ue.U({app_id:t,game_id:t,tag:b.$H.INTERSTITIAL});Ot=o,_t(`Preload. mediation = ${i}, fullscreen = ${n}`),o.request({advBlockId:n,provider:pe.e.Native,reason:Ve.p_.PRELOAD});const l=null==(s=window.yandex)?void 0:s.ads,d=()=>{o.error(Ve.Ud.NOT_IMPL)};let c;if((0,St.x)()){const e=xt((0,j.Qx)(r)?n:void 0,Ct);if(!l||!l.preloadInstreamAdv)return void d();c=l.preloadInstreamAdv(e,"0")}else{if(!l||!l.preloadFullscreenAdv)return void d();c=l.preloadFullscreenAdv(n,i)}c.then(()=>{o.response()}).catch(e=>{o.error(`${Ve.Ud.ERROR}_${e.message}`),console.error(e)})},new Promise((e,s)=>{var i=e=>{try{o(a.next(e))}catch(e){s(e)}},n=e=>{try{o(a.throw(e))}catch(e){s(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,n);o((a=a.apply(t,r)).next())});var t,r,a}(e),3e3)}({advBlocks:this.advBlocks,appId:this.appId,flags:o,residenceInfo:this.residenceInfo}),this.guardClosedPromiseWrapper.promise.then(()=>{document.addEventListener("visibilitychange",this.handleVisibilityChange)}),this.logAdvDelayFlag=Boolean(window.appData.logAdvDelay)}get adOpenedType(){return this._adOpenedType}set adOpenedType(e){Oi(`Set adOpenedType to: ${e}`),this._adOpenedType=e}get showAdvLock(){return this._showAdvLock}get lastShowTime(){return this._lastShowTime}get isAdvDisabledByPartner(){return null===window.appData.advPartnerInfo.advEnabledByPartner?(0,ki.VX)():!window.appData.advPartnerInfo.advEnabledByPartner}getAdvBlocksByPlatform(e){return this.advBlocks[e]}getAdvBlocksByCurrentPlatform(){return this.getAdvBlocksByPlatform((0,wi.P)(this.deviceType))}updateSubscriptionState(e){this.updateDisableAdvButtonVisibility(e),this.isInterstitialAdsDisabled!==e&&(this.isInterstitialAdsDisabled=e,this.reasonForDisablingAd=b.Jm.SUBSCRIPTION,this.sendAdvDisabledToChild(this.reasonForDisablingAd))}showStartFullscreenAdv(){var e,t,r;if((0,bi.W)(this.flags,b.By.START_FULLSCREEN,this.context.advPartnerInfo.blockedPlacements))return;const a=Boolean(null==(t=null==(e=this.getAdvBlocksByCurrentPlatform())?void 0:e.start_fullscreen)?void 0:t.blockID),s=(0,ls.C5)({hasStartFullscreenAdv:a,flags:this.flags,ingameAdvData:null==(r=window.appData.advDataStore)?void 0:r.ingameAdv,withWorldWideAdv:this.withWorldWideAdv});s&&(Oi("Show fullscreen on start (preroll)"),this.callOnAdvClose(),this.showAdv(b.$H.INTERSTITIAL,{reason:Ve.p_.START_FULLSCREEN,sendToSDK:!1},s))}get isAdvDisabled(){return this.isInterstitialAdsDisabled||this.isInterstitialAdsTurnOff||this.isAdvDisabledByPartner}initServices(e,t=this.waterfallQueue[e],r=Ve.p_.ONSPOT){var a;const s=(a,s)=>{if(r===Ve.p_.START_FULLSCREEN&&e===s)return oe.pP.Start;switch((0,ls.Jt)(e===s?t:this.waterfallQueue[s],a)){case-1:return oe.pP.Skip;case 0:return oe.pP.Onspot;default:return oe.pP.Waterfall}},i=new Set;if(t.forEach(e=>i.add(e.provider)),this.serviceInstances=[...i].reduce((e,t)=>{if(e[t])return e;try{const r=ci[t];e[t]=new r(this,{tags:{[b.$H.INTERSTITIAL]:s(t,b.$H.INTERSTITIAL),[b.$H.REWARDED]:s(t,b.$H.REWARDED)},serviceName:t}),e[t].initPromise.promise.catch(()=>{}),Oi(`Service ${t} inited.`)}catch(e){(0,Pe.H)({block:Te.W.ADV},e)}return e},null!=(a=this.serviceInstances)?a:{}),!t.every(({provider:t})=>this.servicesBlocks[e][t])){Oi.spoiler(this.serviceInstances)(`Services for tag ${e}:${r} inited`);for(const{provider:r}of t)this.servicesBlocks[e][r]=!0;c.Z.post({type:"play-adv-manager",action:"update-adv-services-list",data:this.servicesBlocks})}}updateDisableAdvButtonVisibility(e){if(!this.isDisableAdButtonEnabled)return;const t=(0,Ba._)("aab-adv");e?t.classList.contains(je.Si)&&t.classList.remove(je.Si):t.classList.contains(je.Si)||t.classList.add(je.Si)}sendAdvDisabledToChild(e){Oi("readNoAdsSubscriptionValue, this.isInterstitialAdsDisabled = ",this.isInterstitialAdsDisabled,", reason = ",e),c.Z.hasChild()&&c.Z.postToChild(k.fB.SetDisabledState({reason:e,value:this.isInterstitialAdsDisabled}))}resolveGuardPromise(){this.guardClosedPromiseWrapper.resolve(void 0),c.Z.offInternalMessage("guard",this.onGuardMessage)}resolveSplashScreenPromise(){this.splashScreenPromise.resolve(void 0),c.Z.offInternalMessage("splash",this.onSplashMessage)}resolveMiddleLayerPromise(){this.middleLayerInGamePromise.resolve(void 0),c.Z.offInternalMessage("middle-layer",this.onMiddleLayerMessage)}resolveRemovalGameScreenPromise(){this.removalGameScreenPromise.resolve(void 0),c.Z.offInternalMessage("game-removal-screen",this.onGameRemovalScreenMessage)}initMessaging(){var e;c.Z.onInternalMessage("guard",this.onGuardMessage,{withHistory:!0}),c.Z.onInternalMessage("frame",this.onFrameMessage,{withHistory:!0}),this.context.playPageData.isBrandingEnabled||this.context.playPageData.isSlowdownEnabled&&!this.advDelay?c.Z.onInternalMessage("splash",this.onSplashMessage):this.splashScreenPromise.resolve(void 0),(null==(e=this.context.middleLayerInGameData)?void 0:e.show)?c.Z.onInternalMessage("middle-layer",this.onMiddleLayerMessage):this.middleLayerInGamePromise.resolve(void 0),this.context.gameRemovalDate&&(0,I.h)(this.context.gameRemovalDate)?c.Z.onInternalMessage("game-removal-screen",this.onGameRemovalScreenMessage):this.removalGameScreenPromise.resolve(void 0);const{options:t}=(0,w.HX)();c.Z.onExternalMessage("adv-manager",(e,r)=>{var a;switch(e.data.action){case"adv-show-fullscreen":if((null==t?void 0:t.enableForceAdvFullscreen)&&(null==(a=e.data.data)?void 0:a.force)){const e=this.waterfallQueue[b.$H.INTERSTITIAL].filter(e=>e.provider!==pe.e.Promo);return e.length?(this.callbacksToSdk[b.$H.INTERSTITIAL]=r,void this.guardClosedPromiseWrapper.promise.then(()=>{this.showAdv(b.$H.INTERSTITIAL,{reason:Ve.p_.ONSPOT},e)})):void r({error:new Error("No providers in waterfall for force fullscreen adv")})}this.callbacksToSdk[b.$H.INTERSTITIAL]=r,this.showAdv(b.$H.INTERSTITIAL,{reason:Ve.p_.ONSPOT});break;case"adv-show-rewarded-video":this.callbacksToSdk[b.$H.REWARDED]=r,this.showAdv(b.$H.REWARDED,{reason:Ve.p_.ONSPOT});break;case"get-disabled-state":return void r({data:{value:this.isInterstitialAdsDisabled}})}})}callOnAdvClose(e=!1){Oi("callOnAdvClose",e),c.Z.post({type:"adv-manager",action:"on-adv-close",data:{wasShown:e}})}waitServiceInit(e,t){const{serviceName:r}=e;return e.initPromise.state!==S.W.Pending?e.initPromise.promise:Promise.race([e.initPromise.promise,(0,Si.D)((0,te.uD)(this.flags,e,t)).then(()=>{throw new Error(`Ad script init timeout, serviceName: ${r}`)})])}waitShowAdv(e,t,r){const a=(t===b.$H.INTERSTITIAL?e.showFullscreenAdv:e.showRewardedVideo).bind(e);return Promise.race([a(r),(0,Si.D)((0,te.gp)(this.flags,t,e,r.reason)).then(()=>{throw new Error(`Ad showAdv(${t}) timeout, serviceName: ${e.serviceName}`)})])}sendCallbackToSdk(e,t){var r,a;null==(a=(r=this.callbacksToSdk)[e])||a.call(r,{data:{error:t}}),this.callbacksToSdk[e]=null}showServiceAdv(e,t,r){return _i(this,arguments,function*(e,t,r,{clickDaemon:a,depth:s,reason:i,initialTag:n,waterfallItem:o}=r){var l,d;try{Li(`Service ${e.serviceName} start processing ${t}:${i}`),s?a.waterfall({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,i,o),depth:s,reason:i,tag:n}):a.demand({provider:e.serviceName,advBlockId:e.getAdvBlockId(t,i),depth:0,reason:i}),yield Promise.all([this.guardClosedPromiseWrapper.promise,this.splashScreenPromise.promise,this.middleLayerInGamePromise.promise,this.removalGameScreenPromise.promise,this.waitServiceInit(e,i)]);const l=yield this.waitShowAdv(e,t,r);if("function"==typeof l)try{yield l()}catch(e){if(e instanceof Error){const t=new te.lu(e.message,(d=((e,t)=>{for(var r in t||(t={}))Ci.call(t,r)&&Ri(e,r,t[r]);if(Ei)for(var r of Ei(t))Di.call(t,r)&&Ri(e,r,t[r]);return e})({},e.params),Ii(d,Ti({wasShown:!0}))));throw t.stack=e.stack,t}throw e}return Li(`Service ${e.serviceName} processed ${t}:${i}`),{status:oe.mb.Ok}}catch(s){return Li(`Service ${e.serviceName} ${t}:${i} error:`,s),r.callbacks.muteCallbacks(),s instanceof Error||(s=new Error("Unhandled undefined error (safe)")),null==(l=e.cancelShow)||l.call(e,t),(0,te.g5)(e,{additional:{adv:{advBlockId:e.getAdvBlockId(t,i)}},error:s,name:je._u,tag:t}),s instanceof te.lu&&s.params.isEmpty||a.error(s.message||s.toString()),s instanceof te.lu&&s.params.isEmpty?{status:oe.mb.Empty,error:s}:s instanceof te.lu&&s.params.wasShown?{status:oe.mb.FailedShow,error:s}:{status:oe.mb.Failed,error:s}}})}mergeShowAdv(e,t,r,a){let s=this.showAdvLock[e];if(s){const[i,n]=s;if(i===Ve.p_.START_FULLSCREEN)return n.addCallbacks(t,!0),a&&(0,te.Sn)(n,e),Li(`showAdv ${e}:${r} was merged with ${e}:${i}`),!0}return!1}showAdv(e,t){return _i(this,arguments,function*(e,t,r=this.waterfallQueue[e]){Li.spoiler(t)(`showAdv ${e}:${t.reason}`);const a=this.logAdvDelay(e);let s,{reason:i}=t,{callbacks:n={},sendToSDK:o=!0}=t;if(this.mergeShowAdv(e,n,i,o))return;this.initServices(e,r,i);let l=new Ue.U({tag:e,app_id:this.appId,game_id:this.appId});const d=new vi(e,l);d.addCallbacks(n),(0,te.fl)(d,e,this.context.platform).catch(()=>{}),(0,te.KW)(d,this.flags),o&&(0,te.Sn)(d,e);const u=()=>this.adOpenedType=null;d.addCallbacks({onClose:u,onError:u});let h=0,p=0,v=oe.mb.Failed,m=e,g=[];d.addCallbacks({onClose:()=>{var t;Li("callOnShowAdvFinished"),c.Z.post({type:"play-adv-manager",action:"close-adv",data:{tag:e}});try{for(const a of g){const s=null==(t=this.serviceInstances)?void 0:t[a.provider];s&&s.onShowAdvFinished&&s.onShowAdvFinished({tag:a.tag||e,latestTag:m,initialTag:e,status:v,waterfallItems:r})}}catch(e){Oi("Failed to call AdvService.onShowAdvFinished, error:",e.message)}},onOpen:()=>null==a?void 0:a(p,m)});try{const t=()=>{var t,a;const s=r[h];if(!s)throw new te.lu(`No available waterfall item for tag ${e}:${i}`,{isFinal:!0});const n=null==(t=this.serviceInstances)?void 0:t[null==s?void 0:s.provider];if(!n)throw new te.lu(`No available service for tag ${e}:${i}, waterfall provider: ${null!=(a=null==s?void 0:s.provider)?a:pe.e.None}`,{isFinal:!0});return[n,s]};do{d.unmuteCallbacks();const[r,a]=t();if(s)Li(`Service ${s.serviceName} failed to show adv, go to waterfall. Next service: ${null==r?void 0:r.serviceName}`);else{l.tryOpen({reason:i,provider:r.serviceName});const t=this.advDisabledCheck(e,d,l);if(t)return void this.sendCallbackToSdk(e,t);this._showAdvLock[e]=[i,d],this._showTimes[e]++,this._lastShowTime[e]=Date.now()}if(this.adOpenedType=e,this.sendCallbackToSdk(e),s=r,!(0,P.uM)(a,this._showTimes[e])){Li(`Skip service ${s.serviceName} due checkNthShowSkip`,a),h++;continue}m=a.tag?a.tag:e,m!==d.currentTag&&(d.currentTag=m),p>0&&(i=Ve.p_.WATERFALL);const n=yield s.checkCanShow(e,i);if(n!==oe.Kc.Ok){Li(`Skip service ${s.serviceName} due canShowCheck: ${n}`),h++;continue}g.push(a),c.Z.post({type:"play-adv-manager",action:"show-adv",data:{tag:e,serviceName:s.serviceName}}),this.gamePauseResume(e,d);const{status:o,error:u}=yield this.showServiceAdv(s,m,{callbacks:d,clickDaemon:l,depth:p++,tag:m,initialTag:e,reason:i,waterfallItem:a});if(v=o,v===oe.mb.Ok)return void s.resetShowTimer(e);if(v===oe.mb.FailedRemove)this.waterfallQueue[e].splice(h,1);else{if(v===oe.mb.FailedShow)throw u||new te.lu(`Error after ${m} showAdv (service: ${s.serviceName})`,{isFinal:!0,wasShown:!0});h++}}while(s);throw new te.lu("No adv providers left.",{isFinal:!0})}catch(t){this.sendCallbackToSdk(e),this._lastShowTime[e]=0,d.unmuteCallbacks(),d.onError(t),t instanceof te.lu&&(t.params.isFinal||t.params.wasShown)&&(v===oe.mb.Empty?l.noContent():l.fail(t.message)),d.onClose(!1),this.callOnAdvClose(!1),(0,Pe.H)({prefix:"Please, send this error sdk developers: ",block:Te.W.ADV},t)}finally{this._showAdvLock[e]=!1}})}gamePauseResume(e,t){let r;if(e===b.$H.INTERSTITIAL)r="adv_interstitial";else{if(e!==b.$H.REWARDED)return;r="adv_rewarded"}Oi("gamePause:",r),this.gameControl.gamePause(r),t.addCallbacks({onClose:()=>{Oi("gameResume:",r),this.gameControl.gameResume(r)}})}logAdvDelay(e){var t;return!this.logAdvDelayFlag||e!==b.$H.INTERSTITIAL&&e!==b.$H.REWARDED?null:(null==(t=null==Ya?void 0:Ya.Rum)||t.time(je.Cn),(t,r)=>{var a;return null==(a=null==Ya?void 0:Ya.Rum)?void 0:a.timeEnd(je.Cn,{"-additional":encodeURIComponent(JSON.stringify({tag:r,app_id:this.appId,depth:t,initialTag:e}))})})}advDisabledCheck(e,t,r){if(this.adOpenedType)return r.skip(b.Jm.ANOTHER_AD_OPENED),new Error("Another ad already opened");if(e===b.$H.INTERSTITIAL){if(this.isAdvDisabled){if(this.isInterstitialAdsDisabled)r.noAdv();else{let e;e=this.isInterstitialAdsTurnOff?b.Jm.INTERSTITIAL_ADS_TURN_OFF:this.isAdvDisabledByPartner?b.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT:b.Jm.UNKNOWN,r.skip(e)}return this.callOnAdvClose(!1),new Error("Skip interstitial.")}if(!this.firstShowGuard.canShowAdv()){const e=new Error("Cannot open the advertisement. Try again later.");return r.rateLimited("rate"),this.callOnAdvClose(!1),e}const e=this.canOpenAdv();if(e)return r.rateLimited("rate"),this.callOnAdvClose(!1),e}if(e===b.$H.REWARDED){const e=new Error("Skip rewarded.");if(this.isRewardedAdsTurnOff)return Oi("Skip rewarded"),this.skipRewarded({advLogger:r,callbacks:t,reason:b.Jm.REWARDED_ADS_TURN_OFF}),e;if(this.isAdvDisabledByPartner)return Oi("Skip rewarded"),this.skipRewarded({advLogger:r,callbacks:t,reason:b.Jm.ALL_ADS_DISABLED_BY_PARTNERS_KIT}),e}return null}skipRewarded({advLogger:e,callbacks:t,reason:r}){["onOpen","onRewarded","onClose"].filter(Boolean).forEach((e,r)=>{window.setTimeout(()=>{var r;return null==(r=t[e])?void 0:r.call(t)},100*r)}),e.skip(r)}canOpenAdv(){var e,t;const r=Date.now();if(!(null==(t=null==(e=this.getAdvBlocksByCurrentPlatform())?void 0:e.fullscreen)?void 0:t.blockID)){const e=`${je._u}: can not find block id`,t=`https://games.yandex.ru/console/application/${this.appId}`;return(0,Pe.H)({block:Te.W.ADV},new Error(`\nWhat you can do:\n1. Enable monetization: https://yandex.ru/dev/games/doc/dg/console/enable-monetization-docpage/\n2. Fill all fields in your draft ${t}#application-info-draft\n3. Ensure in Ads section ${t}#application-info-draft (bottom)\nthere is block id (like R-A-123456).\nIf state != work (created, for example), just wait 24 hours: block creation might take time\n`)),new Error(e)}if(this.lastShowTime[b.$H.INTERSTITIAL]&&r-this.lastShowTime[b.$H.INTERSTITIAL]<this.minIntervalBetweenAds){const e="Fullscreen ad skipped: too frequent requests";return c.Z.post({action:"debug-action-guard",type:"adv-manager",data:{type:b.$H.INTERSTITIAL,minInterval:this.minIntervalBetweenAds,reason:"Called too often"}}),new Error(e)}if(Math.abs(r-this.startTime)<this.advDelay){const e=`Adv was delayed on ${this.advDelay}ms`;return new Error(e)}return navigator.onLine||!1!==(0,j.RM)(this.flags,Ke.Z.advShowOnOffline)?null:new Error("Adv can't be shown offline")}}r(16128),r(67906);var Ni=r(8823),ji=r(7318),Mi=r(71720);var Hi=r(63399),$i=r(87345),Fi=r(67818),Wi=r(81399),Zi=r(89498),qi=r(74516),Gi=r(20595),zi=Object.defineProperty,Ui=Object.getOwnPropertySymbols,Vi=Object.prototype.hasOwnProperty,Ki=Object.prototype.propertyIsEnumerable,Yi=(e,t,r)=>t in e?zi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xi=(e,t)=>{for(var r in t||(t={}))Vi.call(t,r)&&Yi(e,r,t[r]);if(Ui)for(var r of Ui(t))Ki.call(t,r)&&Yi(e,r,t[r]);return e};const Ji=({appPromo:e})=>{const t=(0,Fi.F)(e.promo),r=(0,Wi.U)({game:e.game,promo:e.promo,size:qi.KL.orig,imageType:"cover"}),s=r?{backgroundImage:`url(${r})`}:void 0;return(0,a.jsx)("div",{className:"GamePromoCard-module__promoCover--Obgeo",style:s,children:(0,a.jsx)(Gi.Z,{text:t})})},Qi=({promo:e,eventDescriptionClassName:t,eventTitleClassName:r})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"GamePromoCard-module__logo--tOLJI",children:(0,a.jsx)(Zi.Z,{})}),(0,a.jsx)("div",{className:(0,L.E)("GamePromoCard-module__eventTitle--YqJ3l",r),children:e.title}),(0,a.jsx)("div",{className:(0,L.E)("GamePromoCard-module__eventDescription--RsP2y",t),children:e.description}),(0,a.jsx)("div",{className:"GamePromoCard-module__eventSpacer--KFQwX"})]}),en=({promo:e,eventDescriptionClassName:t,eventTitleClassName:r})=>(0,a.jsx)(Qi,{eventDescriptionClassName:t,eventTitleClassName:r,promo:e}),tn=({appPromo:e,className:t,eventDescriptionClassName:r,eventTitleClassName:s,isMultiCard:i=!1,onRef:n})=>{var o;const{game:l,promo:d}=e,c=(0,O.T)();return(0,a.jsxs)("div",{className:(0,L.E)("GamePromoCard-module__wrapper--BYWWA","GamePromoCard-module__desktop--vHChY GamePromoCard-module__horizontalFull--F60SP","GamePromoCard-module__singleCard--z0AOz",t),children:[(0,a.jsx)(Ji,{appPromo:e}),(0,a.jsxs)("div",{className:"GamePromoCard-module__content--Zwdhs",ref:n,children:[(0,a.jsx)(en,{eventDescriptionClassName:r,eventTitleClassName:s,promo:d}),(0,a.jsxs)("div",{className:"GamePromoCard-module__footer--h2aRm",children:[(0,a.jsx)(Hi.x,{description:null==(o=l.category)?void 0:o.title,descriptionClassName:"GamePromoCard-module__gameDescription--M08On",game:l,gameInfoClassName:"GamePromoCard-module__gameInfo--oZwOO",titleClassName:"GamePromoCard-module__gameTitle--rpS5E",wrapperClassName:"GamePromoCard-module__gameMiniCard--mO9Hg"}),(0,a.jsx)("div",{className:"GamePromoCard-module__playControl--GHIWr",children:(0,a.jsx)($i.Z,{iconLeft:"new-tab-with-arrow",size:"page_icon_mobile",text:c("game-news.play")})})]})]})]})},rn=(0,ji.Z)([ji.n.onClick],Vr.SS.GAME)(Ni.Z),an=(0,ji.Z)([ji.n.onShow],Vr.SS.GAME)(e=>(0,a.jsx)("div",{className:"GamePromoCard-module__desktopAspectFix--GsNoq",children:(0,a.jsx)(tn,Xi({},e))})),sn=({appId:e,appPromo:t,block:r,eventsCount:s,isMultiCard:i,listType:n,className:o,cardClassName:l,cardDescriptionClassName:d,cardTitleClassName:c,onClick:u,onRef:h})=>{const p=(0,Mi.z)({appId:e}),v=t.game.appID,m="event";return(0,a.jsx)(rn,{block:r,eventsCount:s,game:t.game,listType:n,loggingAppId:v,mix:(0,L.E)("GamePromoCard-module__urlWrapper--PsI0b",o),page:p,size:m,onClick:u,children:(0,a.jsx)(an,{appPromo:t,block:r,className:l,eventDescriptionClassName:d,eventTitleClassName:c,eventsCount:s,game:t.game,isMultiCard:i,listType:n,loggingAppId:v,page:p,size:m,onRef:h})})};var nn=r(51340),on=r(47587);const ln="Slider-critical-module__scroll--E8BY4",dn="Slider-critical-module__scrollWithPaginationOffset--lPboH";var cn=r(4422),un=r.n(cn),hn=r(76753);const pn=({withArrowsNavigation:e=!1,withDots:t=!1,children:r,className:s,slideClassName:i,draggableInitial:o,continuousInitial:l})=>{const d=(0,O.T)(),{contentRef:c,currentIndex:u,onNextClick:h,onPrevClick:p}=(({continuousInitial:e=!1,draggableInitial:t=!0}={})=>{const r=(0,n.useRef)(null),a=(0,n.useRef)(null),[s,i]=(0,n.useState)(0);(0,hn.q)(()=>{const n=r.current;return n?a.current=new(un())(n,{continuous:e,draggable:t,startSlide:s,transitionEnd:e=>{i(e)}}):console.error("Slider: No content"),()=>{var e;null==(e=a.current)||e.kill(),a.current=null}});const o=(0,n.useCallback)(()=>{var e;return null==(e=a.current)?void 0:e.next()},[]),l=(0,n.useCallback)(()=>{var e;return null==(e=a.current)?void 0:e.prev()},[]);return{contentRef:r,currentIndex:s,onNextClick:o,onPrevClick:l}})({draggableInitial:o,continuousInitial:l});if(!Array.isArray(r)||0===r.length)return console.warn("Slider: no valid slides provided"),null;const v=t&&r.length>1,m=e&&r.length>1,g=m&&u<r.length-1,y=m&&u>0;return(0,a.jsxs)("div",{className:(0,L.E)("Slider-critical-module__slider--ne7ng",s),children:[g&&(0,a.jsx)(on.Q,{alt:d("common.scroll.right"),className:(0,L.E)(ln,v&&dn,"Slider-critical-module__scrollToRight--M7AtC"),direction:"right",onClick:h}),y&&(0,a.jsx)(on.Q,{alt:d("common.scroll.left"),className:(0,L.E)(ln,v&&dn,"Slider-critical-module__scrollToLeft--EsEWR"),direction:"left",onClick:p}),(0,a.jsxs)("div",{className:"Slider-critical-module__swipe--gkHjR",ref:c,children:[(0,a.jsx)("div",{className:"Slider-critical-module__swipeWrap--WFTGO",children:r.map((e,t)=>(0,a.jsx)("div",{className:i,children:e},`swipe-slide-${t}`))}),v&&(0,a.jsx)("div",{className:"Slider-critical-module__dots--rSzIN",children:r.map((e,t)=>(0,a.jsx)("div",{className:(0,L.E)("Slider-critical-module__dot--SnfME",t===u&&"Slider-critical-module__dotCurrent--Ek11Z")},`dot-for-slide-${t}`))})]})]})},vn=e=>{const{appId:t,appPromos:r,block:s,closeCountdown:i=3,listType:o,testId:l,onClose:d}=e,c=((0,O.T)(),r.length),u=(0,n.useMemo)(()=>Array.isArray(r)&&r.length?r.map(e=>(0,a.jsx)(sn,{appId:t,appPromo:e,block:s,cardDescriptionClassName:"GamePromoPopup-module__eventDescription--hHPKT",cardTitleClassName:"GamePromoPopup-module__eventTitle--LyBlK",eventsCount:c,isMultiCard:r.length>1,listType:o},`promo-card-${e.game.appID}-${e.promo.startTime.valueOf()}`)):null,[t,r,s,c,o]);return(0,a.jsxs)("div",{className:"GamePromoPopup-module__body--Q0F2O","data-testid":l,children:[!1,(0,a.jsx)("div",{className:"GamePromoPopup-module__content--hbP5B",children:(0,a.jsx)(pn,{draggableInitial:!1,withArrowsNavigation:!0,withDots:!0,children:u})})]})},mn=e=>{const{appId:t,appPromos:r,block:s,closeCountdown:i,listType:o,testId:l,onShow:d,onClose:c}=e;return(0,n.useEffect)(()=>{null==d||d()},[d]),(0,a.jsx)(nn.Z,{blockBodyScroll:!0,closeButtonType:"adv-fullscreen",cls:"GamePromoPopup-module__popupRootDesktop--zGNsE",containerClassName:"GamePromoPopup-module__popupContainerDesktop--_WSgj",onClose:c,children:(0,a.jsx)(vn,{appId:t,appPromos:r,block:s,closeCountdown:i,listType:o,testId:l,onClose:c})})};var gn=r(86508),yn=r(24046);r(33520);const fn=()=>{const e=(0,n.useRef)(!1),t=(0,n.useRef)(null),{isLegalEmbedPartner:r,playPageData:{gameInfo:{appId:s}}}=(0,_.b)(),i=(0,o.C)(e=>e.appPromos),[l,d]=(0,n.useState)(0),[u,h]=(0,n.useState)({}),[p,v]=(0,n.useState)(!1),m=(0,n.useCallback)(t=>{var a;r?null==(a=t.onClose)||a.call(t):(h(t),v(!0),e.current=!0)},[r]),g=(0,n.useCallback)(()=>{var e;(0,fa.NF)({},Vr.Ji.GAME_PROMO_OPEN),null==(e=u.onOpen)||e.call(u)},[u]),y=(0,n.useCallback)(()=>{var e;null==(e=u.onClose)||e.call(u),v(!1)},[u]),{promos:f,fetching:w}=null!=i?i:{},b=void 0!==i,k=b&&w,A=b&&Array.isArray(f),S=A&&0===f.length,P=(0,n.useCallback)((t,r)=>{const{action:a,data:s}=t.data;switch(a){case"show":{const{onOpen:e,onClose:t,onError:r}=s;return void m({onError:r,onOpen:e,onClose:t})}case"check-if-can-show":{const t=b&&!k&&!S;return void r({data:{canShow:!e.current&&t}})}}},[m,b,k,S]),I=(0,n.useCallback)((e,t)=>{t.height!==l&&d(t.height)},[l]);return(0,n.useEffect)(()=>(c.Z.onInternalMessage("adv-events-promo-block",P),gn.Z.addResizeBlockListener("game",I,!0),()=>{c.Z.offInternalMessage("adv-events-promo-block",P),gn.Z.removeResizeBlockListener("game",I)}),[I,P]),p&&b&&!k&&A&&!S?(0,a.jsx)("div",{ref:t,style:{height:l?`calc(100% + ${l}px)`:void 0},children:(0,a.jsx)(mn,{appId:Number(s),appPromos:f,block:yn.Q.FULLSCREEN_PROMO,closeCountdown:3,listType:It.co.EVENTS,testId:"events-promo-container",onClose:y,onShow:g})}):null},wn="advBlock_"+pe.e.GoogleInstream,bn=({tag:e})=>{const t=(0,n.useRef)(null),[r,s]=(0,n.useState)(!1),i=(0,n.useCallback)((r,a)=>{var i,n,o,l;const{action:d,data:{tag:c}}=r.data;if(c===e)switch(d){case"show":s(!0);break;case"hide":s(!1);break;case"get-size":a({data:{width:null!=(n=null==(i=t.current)?void 0:i.clientWidth)?n:null,height:null!=(l=null==(o=t.current)?void 0:o.clientHeight)?l:null}})}},[e]);(0,n.useEffect)(()=>(c.Z.onInternalMessage("adv-instream-render",i),()=>{c.Z.offInternalMessage("adv-instream-render",i)}),[i]);const o=["GoogleInstreamBlock-module__block--UThhL",r?void 0:"GoogleInstreamBlock-module__hidden--w4W3T"];return(0,a.jsx)("div",{className:(0,L.E)(...o),id:wn+"_"+e,ref:t})};var kn=r(78863),An=r(26014),Sn=r(8281),Pn=Object.defineProperty,In=Object.defineProperties,Tn=Object.getOwnPropertyDescriptors,En=Object.getOwnPropertySymbols,Cn=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,Rn=(e,t,r)=>t in e?Pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xn=(e,t)=>{for(var r in t||(t={}))Cn.call(t,r)&&Rn(e,r,t[r]);if(En)for(var r of En(t))Dn.call(t,r)&&Rn(e,r,t[r]);return e},_n=(e,t)=>In(e,Tn(t));const On=i().with("prowo-container"),Ln=()=>{const e=(0,n.useRef)(null),{isLegalEmbedPartner:t}=(0,_.b)(),r=(0,n.useRef)(new An.Z),[s,i]=(0,n.useState)(0),[o,l]=(0,n.useState)({advTag:b.$H.INTERSTITIAL,callbacks:{},reason:Ve.p_.ONSPOT,visible:!1}),d=(0,n.useCallback)((e,r,a)=>{var s;t?null==(s=a.onClose)||s.call(a):l(()=>({advTag:e,callbacks:a,reason:r,visible:!0}))},[t]),u=(0,n.useCallback)(()=>{var e,t;(0,fa.NF)({},Vr.Ji.GAME_PROMO_OPEN),r.current.updateShowData(Sn.Wp.GamePromo),null==(t=(e=o.callbacks).onOpen)||t.call(e)},[o]),h=(0,n.useCallback)(()=>{var e,t,r,a;null==(t=(e=o.callbacks).onRewarded)||t.call(e),null==(a=(r=o.callbacks).onClose)||a.call(r),l(_n(xn({},o),{visible:!1}))},[o]),p=(0,n.useCallback)(e=>{var t,r,a,s;null==(r=(t=o.callbacks).onClose)||r.call(t),null==(s=(a=o.callbacks).onError)||s.call(a,e),l(_n(xn({},o),{visible:!1}))},[o]),v=(0,n.useCallback)((e,t)=>{const{action:r,data:a}=e.data;if("show"===r){const{advTag:e,reason:t,onOpen:r,onRewarded:s,onClose:i,onError:n}=a;return void d(e,t,{onError:n,onOpen:r,onRewarded:s,onClose:i})}},[d]),m=(0,n.useCallback)((e,t)=>{t.height!==s&&i(t.height)},[s]);(0,n.useEffect)(()=>(c.Z.onInternalMessage("adv-promo-block",v),gn.Z.addResizeBlockListener("game",m,!0),()=>{c.Z.offInternalMessage("adv-promo-block",v),gn.Z.removeResizeBlockListener("game",m)}),[m,v]);const{advTag:g,reason:y,visible:f}=o,w=(0,n.useMemo)(()=>({onError:p}),[p]);return f?(0,a.jsx)("div",{className:On({advType:g,"with-blur":!0}),ref:e,style:{height:s&&!(0,Dr.v_)({on:"new_game_desktop_header"})?`calc(100% + ${s}px)`:void 0},children:(0,a.jsx)(kn.Z,{advTag:g,auto:void 0,containerRef:e,errorProps:w,hide:h,reason:y,onShow:u})}):null};var Bn=r(61533),Nn=Object.defineProperty,jn=Object.defineProperties,Mn=Object.getOwnPropertyDescriptors,Hn=Object.getOwnPropertySymbols,$n=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,Wn=(e,t,r)=>t in e?Nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Zn=(e,t)=>{for(var r in t||(t={}))$n.call(t,r)&&Wn(e,r,t[r]);if(Hn)for(var r of Hn(t))Fn.call(t,r)&&Wn(e,r,t[r]);return e},qn=(e,t)=>jn(e,Mn(t));const Gn=i().with("instream-renderer"),zn=({advManager:e})=>{const[t,r]=(0,n.useState)({isVisible:!1,blockId:"",isHeaderEnabled:!(0,x.I)(),width:0,height:0}),s=(0,n.useCallback)((e,t)=>{const{action:a}=e.data;switch(a){case"show":r(e=>qn(Zn({},e),{isVisible:!0}));break;case"hide":r(e=>qn(Zn({},e),{isVisible:!1}));break;case"set-size":{const{width:t,height:a}=e.data.data;r(e=>qn(Zn({},e),{width:t,height:a}));break}case"update-block-id":{const{blockId:a}=e.data.data;(0,Bn.flushSync)(()=>r(e=>qn(Zn({},e),{blockId:a}))),t({data:{blockId:a}});break}}},[]);(0,n.useEffect)(()=>(c.Z.onInternalMessage("instream-fullscreen-render",s,{withHistory:!0}),()=>{c.Z.offInternalMessage("instream-fullscreen-render",s)}),[s]);const{viewType:i}=e,o=[je.kn.modal,je.kn.modalFullscreen,je.kn.modalWithBlur,(0,te.TE)(i),t.isVisible?je.kn.modalVisible:void 0,t.isHeaderEnabled?je.kn.modalWithHeader:void 0,t.isHeaderEnabled?je.kn.headerFix:void 0];return(0,a.jsx)("div",{className:(0,L.E)(...o),children:(0,a.jsx)("div",{className:Gn("content"),style:{width:t.width,height:t.height},children:(0,a.jsx)("div",{id:t.blockId})})})};var Un=r(32574),Vn=r(70931);const Kn=(0,re.M$)("AdvStickyParentWindow",void 0,{background:"#0c6c09"}),Yn=(0,Un.Z)(({appId:e,features:t,flags:r,settings:a})=>{const s=(0,n.useMemo)(()=>new lr,[]),[i,o]=(0,n.useState)(!0),[l,d]=(0,n.useState)(!1),{adv:u}=(0,Vn.Lf)(a),{advPartnerInfo:h}=(0,_.b)(),p=(0,n.useMemo)(()=>(0,Vn.uk)({adv:u,appId:e,isDesktop:!0,flags:r,orientation:null==t?void 0:t.orientation,blockedPlacements:h.blockedPlacements}),[u,e,t,r,h]);return(0,n.useEffect)(()=>{const e=(e,t)=>{return r=function*(){const{action:r}=e.data;switch(r){case"adv-show-sticky-banner":{if(Kn(`onExternalMessage: action: "${r}"`),!p)return void t({data:{reason:b.$R.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});const e=dr({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!0}});s.addListener({fn:e=>{var r;const{payload:a}=e,s=null==(r=a.stickyAdvIsShowing)||r;return d(!s),t({data:{reason:a.reason,stickyAdvIsShowing:s}}),!0},messageId:e});break}case"adv-hide-sticky-banner":{Kn(`onExternalMessage: action: "${r}"`);const e=dr({action:"setBannerAdvStatus",type:"adv",payload:{stickyAdvIsShowing:!1}});s.addListener({fn:e=>{var r;const{payload:a}=e,s=null!=(r=a.stickyAdvIsShowing)&&r;return d(!s),t({data:{reason:a.reason,stickyAdvIsShowing:s}}),!0},messageId:e});break}case"adv-status-sticky-banner":if(Kn(`onExternalMessage: action: "${r}"`),!p)return void t({data:{reason:b.$R.ADV_IS_NOT_CONNECTED,stickyAdvIsShowing:!1}});Kn(`Get stickyAdvIsShowing: ${!l}`),t({data:{stickyAdvIsShowing:!l}})}},new Promise((e,t)=>{var a=e=>{try{i(r.next(e))}catch(e){t(e)}},s=e=>{try{i(r.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,s);i((r=r.apply(undefined,null)).next())});var r};return Kn("ParentWindowStickyAdvService init"),c.Z.onAllMessages("adv-manager",e),()=>{c.Z.offAllMessages("adv-manager",e)}},[p,l,s]),(0,hn.q)(()=>{const a=(0,Vn.jx)({adv:u,appId:e,flags:r,orientation:null==t?void 0:t.orientation}),i={desktop:{landscape:a.desktop,portrait:a.desktop},mobile:{landscape:a.mobileLandscape,portrait:a.mobilePortrait}};dr({action:"setBannerAdvSettings",type:"adv",payload:{enabled:p,locations:i}});const n=dr({action:"ping",type:"liveness"}),l=s.addListener({fn:e=>{const{action:t,type:r}=e;switch(r){case"liveness":"pong"===t&&(window.clearTimeout(d),o(!0));break;case"error":o(!1),Kn("error",e)}return!0},messageId:n}),d=window.setTimeout(()=>{l(),o(!1)},2e3)}),null},d.Z,{appId:e=>e.playPageData.gameInfo.appId,features:e=>e.playPageData.gameSettings.features,flags:e=>e.abt.flags,settings:e=>e.playPageData.gameSettings.settings});var Xn=r(30928),Jn=r(74344),Qn=r(47341),eo=Object.defineProperty,to=(e,t,r)=>(((e,t,r)=>{t in e?eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class ro extends n.Component{constructor(e){super(e),to(this,"additionalClasses",""),to(this,"cssClasses"),to(this,"isCloseButtonHiddenTimeout"),to(this,"closeButtonDeferredTime",0),to(this,"isYandexSearchApp"),to(this,"onYandexFullscreenRenderMessage",(e,t)=>{var r;const{action:a}=e.data;switch(a){case"update-block-id":this.setState({advBlockId:e.data.data.blockId,pageNumber:e.data.data.pageNumber},()=>{t({data:{blockId:this.getBlockId()}})});break;case"show-fullscreen":{const t=Boolean(this.closeButtonDeferredTime)&&(null==(r=e.data.data)?void 0:r.initialTag)===b.$H.REWARDED;this.setState({isVisible:!0,seconds:0,withTimer:!1,isCloseButtonHidden:t}),t&&(this.hideCloseButton(),this.setIsCloseButtonHiddenTimeout());break}case"hide-fullscreen":this.clearIsCloseButtonHiddenTimeout(),this.showCloseButton(),this.setState({isVisible:!1})}}),to(this,"handleClose",()=>{(0,B.D)(()=>{c.Z.post({type:"yandex-adv-service",action:"close-adv"})})}),to(this,"handleBottomButtonClose",()=>{this.state.isCloseButtonHidden||(0,B.D)(()=>{c.Z.post({type:"yandex-adv-service",action:"bottom-button-close-adv"})})}),to(this,"handleTouchMove",e=>{e.stopPropagation(),e.preventDefault()}),to(this,"handleButtonDisableAdvClick",()=>{(0,N.Z)()}),to(this,"setModalRef",()=>{c.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})}),this.isYandexSearchApp=(0,ds.qo)(),this.state={advBlockId:"",pageNumber:1,isCloseButtonHidden:!1,isVisible:!1,inited:!1,seconds:0,withTimer:!1,isHeaderEnabled:!(0,x.I)()}}get withNativeClose(){var e,t;const{flags:r}=this.context.abt;return null==(t=null==(e=this.props.advManager.getAdvBlocksByPlatform(Ea()))?void 0:e.fullscreen)||t.renderer,b.bW.PCODE,(0,j.qf)(r)||!1}componentDidMount(){this.init(),this.initMessaging()}init(){var e;const{flags:t}=this.context.abt,{viewType:r}=this.props.advManager;this.closeButtonDeferredTime=Math.max(0,Math.min(5e3,null!=(e=(0,j.$9)(t,Ke.Z.advCloseButtonDeferredTime))?e:0)),this.cssClasses=ka();const a=[];r===je.xd.fullscreen&&t.new_adv_block&&a.push(`new_adv_block-${t.new_adv_block}`),this.additionalClasses=a.join(" "),this.setState({inited:!0})}initMessaging(){c.Z.onInternalMessage("yandex-fullscreen-render",this.onYandexFullscreenRenderMessage)}setIsCloseButtonHiddenTimeout(){this.clearIsCloseButtonHiddenTimeout(),this.isCloseButtonHiddenTimeout=window.setTimeout(()=>{this.showCloseButton()},this.closeButtonDeferredTime)}clearIsCloseButtonHiddenTimeout(){this.isCloseButtonHiddenTimeout&&(window.clearTimeout(this.isCloseButtonHiddenTimeout),this.isCloseButtonHiddenTimeout=void 0)}hideCloseButton(){this.setState({isCloseButtonHidden:!0}),document.documentElement.dataset.pcodeCloseButtonHidden="true"}showCloseButton(){this.setState({isCloseButtonHidden:!1}),document.documentElement.dataset.pcodeCloseButtonHidden="false"}getBlockId(){const{advBlockId:e,pageNumber:t}=this.state;return`yandex_rtb_${e}_${t}`}renderModalContent(){const{cssClasses:e}=this,{advBlockId:t,isCloseButtonHidden:r,isVisible:s,withTimer:i}=this.state;if(!t||!e)return null;const{deviceType:n,isDisableAdButtonEnabled:o}=this.props.advManager,l=Boolean(this.isYandexSearchApp),{getText:d}=this.props,c=this.withNativeClose,u=(0,a.jsxs)("span",{"aria-hidden":"true",className:`${Aa(e,"modalBottom",l)}`,children:[(0,a.jsx)("span",{className:`${e.modalButton} ${e.modalButtonDisableAdv}`,onClick:this.handleButtonDisableAdvClick,children:d("header.popup.disable.ads")}),(0,a.jsx)("span",{className:`${e.modalButton} ${e.modalButtonClose}`,onClick:this.handleBottomButtonClose,children:d("adv.close")})]});return n===wa.n.desktop?c?(0,a.jsx)("div",{className:`${je.kn.modalInner}`,children:(0,a.jsx)("div",{className:`${e.modalWrap} with-native-close`,children:(0,a.jsx)("div",{className:`${e.modalContent} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()})})}):(0,a.jsx)("div",{className:`${je.kn.modalInner}`,children:(0,a.jsxs)("div",{className:`${e.modalWrap}`,children:[s&&i&&(0,a.jsx)("div",{className:je.kn.countdown,children:(0,a.jsx)(Qn.Z,{seconds:this.state.seconds,text:d("adv.timed.allow.skip.text"),onClose:this.handleClose})}),(0,a.jsx)("div",{className:`${e.modalContent} ${e.yandexAdaptive}`,id:this.getBlockId()}),!i&&!r&&(0,a.jsx)(Jn.Z,{"data-testid":"yandex-fullscreen-render-button",source:It.h0.REWARDED_COUNTER,type:"adv-fullscreen",onClick:this.handleClose}),o?u:""]})}):c?(0,a.jsx)("div",{className:`${je.kn.modalInner}`,children:(0,a.jsx)("div",{className:`${Aa(e,"modalContent",l)} ${e.yandexAdaptive} with-native-close`,id:this.getBlockId()})}):(0,a.jsxs)("div",{className:`${je.kn.modalInner}`,children:[(0,a.jsx)("div",{className:`${Aa(e,"modalContent",l)} ${e.yandexAdaptive}`,id:this.getBlockId()}),!(0,St.x)()&&!r&&(0,a.jsx)("span",{"aria-hidden":"true",className:`${Aa(e,"modalClose",l)}`,children:(0,a.jsx)(C.z,{className:e.mobileCloseButton,"data-testid":"yandex-fullscreen-render-button",size:40,view:"primary",width:"max",onClick:this.handleClose,children:d("adv.close")})}),o?u:null]})}render(){const{additionalClasses:e,cssClasses:t}=this,{isVisible:r,inited:s,isHeaderEnabled:i}=this.state,{viewType:n}=this.props.advManager;if(!s)return null;const o=r?`${t.modalVisible} ${je.kn.modalVisible}`:"",l=[je.kn.modal,(0,te.el)("yandex"),je.kn.modalFullscreen,(0,te.TE)(n),t.modalMedia,o,e,je.kn.modalWithBlur,i?je.kn.modalWithHeader:void 0,i?je.kn.headerFix:void 0].join(" ").trim();return(0,a.jsx)("div",{className:l,ref:this.setModalRef,onTouchMove:this.handleTouchMove,children:this.renderModalContent()})}}to(ro,"contextType",d.Z);const ao=(0,Xn.$j)(function(e){return{getText:e.getText}})(ro);var so=r(69729),io=Object.defineProperty,no=(e,t,r)=>(((e,t,r)=>{t in e?io(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class oo extends d.P{constructor(e){super(e),no(this,"cssClasses"),no(this,"isPCodeModal"),no(this,"onAdvCloseMessagingCallback"),no(this,"onRewardedMessagingCallback"),no(this,"isYandexSearchApp"),no(this,"isYaBroChromeLower79",window.appData.isYaBroOrSearchApp&&!(0,so.LR)(window.navigator.userAgent,so.t_,{major:79,minor:0})),no(this,"onYandexRewardedRenderMessage",(e,t)=>{var r;const{action:a}=e.data;switch(a){case"update-block-id":this.setState({advBlockId:e.data.data.blockId},()=>{t({data:{blockId:this.getBlockId()}})});break;case"show-rewarded":this.setState({isVisible:!0,seconds:(null==(r=e.data.data)?void 0:r.seconds)||0}),this.onAdvCloseMessagingCallback=t;break;case"on-rewarded":this.onRewardedMessagingCallback=t;break;case"hide-rewarded":this.setState({isVisible:!1})}}),no(this,"handleAdvClose",e=>{var t;null==(t=this.onAdvCloseMessagingCallback)||t.call(this,{data:{isRewarded:e}})}),no(this,"handleRewardedDone",()=>{var e;null==(e=this.onRewardedMessagingCallback)||e.call(this)}),no(this,"handleTouchMove",e=>{e.stopPropagation(),e.preventDefault()}),no(this,"setModalRef",()=>{c.Z.post({type:"yandex-adv-service",action:"adv-container-mounted"})}),this.isYandexSearchApp=(0,ds.qo)(),this.state={advBlockId:"",inited:!1,isVisible:!1,seconds:0,isHeaderEnabled:!(0,x.I)()}}componentDidMount(){this.init(),this.initMessaging()}init(){var e,t;this.isPCodeModal=(null==(t=null==(e=this.props.advManager.getAdvBlocksByPlatform(Ea()))?void 0:e.rewarded)?void 0:t.renderer)===b.bW.PCODE,this.cssClasses=ka(),this.setState({inited:!0})}initMessaging(){c.Z.onInternalMessage("yandex-rewarded-render",this.onYandexRewardedRenderMessage)}getBlockId(){const{advBlockId:e}=this.state;return`yandex_rtb_rewarded_${e}`}renderModalContent(){const{cssClasses:e}=this,{isVisible:t,seconds:r}=this.state,{advManager:{deviceType:s}}=this.props;return s===wa.n.desktop?(0,a.jsxs)("div",{className:`${e.modalWrap}`,children:[t&&(0,a.jsx)("div",{className:je.kn.countdown,children:(0,a.jsx)(Qn.Z,{seconds:r,onClose:this.handleAdvClose,onDone:this.handleRewardedDone})}),(0,a.jsx)("div",{className:`${e.modalContent}`,id:this.getBlockId()})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:Aa(e,"modalContent",Boolean(this.isYandexSearchApp)),id:this.getBlockId()}),t&&!(0,St.x)()&&(0,a.jsx)(Qn.Z,{seconds:r,onClose:this.handleAdvClose,onDone:this.handleRewardedDone})]})}renderModal(){const{advManager:e}=this.props,{cssClasses:t}=this,{isVisible:r,isHeaderEnabled:s}=this.state,i=r?`${t.modalVisible} ${je.kn.modalVisible}`:"",n=[je.kn.modal,t.rewardedVideo,t.yandexAdaptive,(0,te.TE)(e.viewType),t.modalMedia,i,je.kn.modalWithBlur,s?je.kn.modalWithHeader:void 0,s?je.kn.headerFix:void 0,this.isYaBroChromeLower79?je.kn.yabroChromeLower79:void 0].join(" ").trim();return(0,a.jsx)("div",{className:n,ref:this.setModalRef,onTouchMove:this.handleTouchMove,children:this.renderModalContent()})}renderPCodeModal(){const{cssClasses:e}=this,{isVisible:t}=this.state,r=t?`${je.kn.modalVisible}`:"",s=[je.kn.modal,e.rewardedVideo,r,je.kn.modalWithBlur].join(" ").trim();return(0,a.jsx)("div",{className:s})}render(){const{inited:e}=this.state;return e?this.isPCodeModal?this.renderPCodeModal():this.renderModal():null}}var lo=r(90387),co=r(38207),uo=Object.defineProperty,ho=Object.getOwnPropertySymbols,po=Object.prototype.hasOwnProperty,vo=Object.prototype.propertyIsEnumerable,mo=(e,t,r)=>t in e?uo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const go=i().with("aab-adv"),yo=(0,re.M$)("PlayAdvManager",re.XG.Adv),fo=()=>{const e=(0,_.b)(),t=(0,o.C)(l.Ak),[r]=(0,n.useState)(t),{abt:{flags:s},location:i,withWorldWideAdv:d}=e,[u,h]=(0,n.useState)(null),p=(0,n.useRef)(null),v=(0,co.ff)();(0,n.useEffect)(()=>{const t=e=>{"update-adv-services-list"===e.data.action&&h(((e,t)=>{for(var r in t||(t={}))po.call(t,r)&&mo(e,r,t[r]);if(ho)for(var r of ho(t))vo.call(t,r)&&mo(e,r,t[r]);return e})({},e.data.data))};return c.Z.onInternalMessage("play-adv-manager",t),yo("Create AdvManager instance"),p.current=new Bi(e,v,{isAdvDisabledBySubscription:r}),()=>{c.Z.offInternalMessage("play-adv-manager",t),yo("Destroy AdvManager instance")}},[e,v,r]),(0,n.useEffect)(()=>{var e;null==(e=p.current)||e.updateSubscriptionState(t)},[t]);const m=(0,n.useMemo)(()=>(0,lo.O)(i),[i]),g=p.current,k=e.playPageData.gameSettings.extraFeatures.inAppGame,{ingameAdv:A,options:S}=(0,w.HX)(),P=(0,n.useMemo)(()=>{if(!g||!u)return null;const e=(0,ls.gK)({flags:s,ingameAdvData:A,trafficSplitProvider:null==S?void 0:S.trafficSplitProvider,withWorldWideAdv:d,isInAppGame:k}),t=u[b.$H.INTERSTITIAL],r=u[b.$H.REWARDED],i=t[pe.e.PrebidTGO]||t[pe.e.Adsense]||t[pe.e.PubliftZone]||t[pe.e.AdsenseResponsive]||t[pe.e.AnymindBlock]||t[pe.e.YandexInAppPromo],n=Boolean(r[pe.e.GoogleInstream]&&e.rewarded.find(e=>e.provider===pe.e.GoogleInstream&&e.tag===b.$H.INTERSTITIAL));return(0,a.jsxs)(a.Fragment,{children:[t[pe.e.Yandex]&&(0,a.jsx)(ao,{advManager:g}),u[b.$H.REWARDED][pe.e.Yandex]&&(0,a.jsx)(oo,{advManager:g}),i&&(0,a.jsx)(ee,{advManager:g}),(t[pe.e.GoogleInstream]||n)&&((0,f.vV)(s)||(0,Me.Hc)(s)?(0,a.jsx)(bn,{advManager:g,tag:b.$H.INTERSTITIAL}):(0,a.jsx)(zn,{advManager:g})),u[b.$H.REWARDED][pe.e.GoogleInstream]&&(0,a.jsx)(bn,{advManager:g,tag:b.$H.REWARDED}),(0,a.jsx)(Ln,{}),(0,a.jsx)(fn,{}),m&&(0,a.jsx)(Yn,{})]})},[g,u,s,A,null==S?void 0:S.trafficSplitProvider,d,k,m]);return g?(0,a.jsxs)("div",{className:go(),children:[(0,a.jsx)(y,{appId:g.appId,isDevFeaturesEnabled:!1}),P]}):null}},80913:(e,t,r)=>{r.d(t,{q:()=>p,Q:()=>y});var a=r(7323);const s="count_of_user_visits";function i(){return!(0,a.dq)(s).wasError}var n=r(94365),o=r(99083),l=r(55222),d=r(78216),c=r(26014),u=r(8281),h=r(85187);const p=15e3,v=1,m=1,g=5;function y(){return!((0,n.Oo)()||(e=null==(t=window.YandexGamesSDK)?void 0:t.game.info.hasWebAppsCategory,e||(0,o.VP)()||(0,l.PK)()||!i()||function(){let e,t=(0,a.dq)(s);return i()?(t.value&&(e=Number(t.value)),(!e||e<0)&&(e=0),e):0}()>=g||!(0,d.uP)()))&&(new c.Z).checkShowCapability(u.Wp.GamePromo,{waitingPeriod:v*h.E,maxShowCount:m,considerInstallation:!0});var e,t}},83592:(e,t,r)=>{r.d(t,{Kc:()=>n,QA:()=>l,hk:()=>s,mb:()=>o,pP:()=>i});var a=r(23160);function s(e){return(null==e?void 0:e.provider)===a.e.AdsenseResponsive&&"slotId"in e}var i=(e=>(e.Onspot="onspot",e.Skip="skip",e.Start="start",e.Waterfall="waterfall",e))(i||{}),n=(e=>(e.Next="next",e.NextRemove="next_remove",e.Ok="ok",e))(n||{}),o=(e=>(e.Empty="empty",e.Failed="failed",e.FailedRemove="failed_remove",e.FailedShow="failed_show",e.Ok="ok",e))(o||{}),l=(e=>(e.ServiceInit="serviceInit",e.ShowFullscreen="showFullscreen",e.ShowRewarded="showRewarded",e))(l||{})},28010:(e,t,r)=>{r.d(t,{Z:()=>f});var a=r(57627),s=r(87363),i=r(30928),n=r(88866),o=r(95523),l=r(78825),d=r(19960),c=r(20966),u=r(87125);const h="fetch-limits";var p=(e=>(e.LIMIT_EXCEEDING="limit-exceeding",e))(p||{}),v=Object.defineProperty,m=(e,t,r)=>(((e,t,r)=>{t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const g=(0,u.M$)("PlayFetchLimits",u.XG.Popup);class y extends s.Component{constructor(e){super(e),m(this,"actionToMethodMap",{"leaderboard/entries":"leaderboard.getLeaderboardEntries()","leaderboard/score":"leaderboard.setLeaderboardScore()","player-info/get-data":"player.getData()","player-info/set-data":"player.setData()","player-info/increment-stats":"player.incrementStats()","player-info/stats":"player.getStats()","player-info/set-stats":"player.setStats()"}),m(this,"onFetchInternalMessage",e=>{const{action:t}=e.data;if(t!==p.LIMIT_EXCEEDING)return;const{data:{url:r,method:a}}=e.data;this.onLimitExceeding({method:a,url:r})}),m(this,"onMessageBoxClick",()=>{const{warningMessage:e}=this.state;if(e)try{navigator.clipboard.writeText(e)}catch(e){}}),m(this,"onMessageBoxClose",()=>{this.setState({warningMessage:void 0})}),m(this,"onMessageBoxSnooze",()=>{this.onMessageBoxClose(),this.setState({snooze:!0})}),this.state={snooze:!1,warningMessage:void 0}}componentDidMount(){l.Z.onInternalMessage(h,this.onFetchInternalMessage)}componentWillUnmount(){l.Z.offInternalMessage(h,this.onFetchInternalMessage)}onLimitExceeding(e){const t=this.getLimitErrorText(e);(0,c.H)({message:"Fetch limit exceeding",type:"fetch"},new Error(t)),((0,d.m)()||u.HQ)&&this.setState({warningMessage:t})}getLimitErrorText({method:e,url:t}){var r;if(t){let e=t;try{e=new URL(t).pathname}catch(e){}return g(`onLimitExceeding, url = ${t}`),this.props.getText("game-sdk.fetch-limits.warn.text",{params:{url:e}})}return e=null!=(r=this.actionToMethodMap[e])?r:e,g(`onLimitExceeding, method = ${e}`),this.props.getText("game-sdk.fetch-limits.warn.method.text",{params:{method:e}})}render(){const{snooze:e,warningMessage:t}=this.state;return e||!t?null:(0,a.jsx)(n.Z,{autohide:!1,level:o.XB.ERROR,withCloseButton:!0,onClick:this.onMessageBoxClick,onClose:this.onMessageBoxClose,onSnooze:this.onMessageBoxSnooze,children:t})}}const f=(0,i.$j)(function(e){return{getText:e.getText}})(y)},13466:(e,t,r)=>{r.d(t,{Z:()=>b});var a=r(57627),s=r(4545),i=r(77372),n=r(63904),o=r.n(n),l=r(87363),d=r(38225),c=r(96533),u=r(50678),h=r(39138),p=r(72895),v=r(65745),m=r(33067);const g=o().with("play-game-logo"),y=({type:e})=>{const t=(0,d.C)(c.Up),{lang:r,referrer:s,cdnUrl:n,playPageData:{gameInfo:o},rtl:y}=(0,l.useContext)(u.Z),f=(0,h.T)(),w=f("common.company.name"),b=f("common.service.short_name"),k=f("common.service.name"),A=(0,v._B)({cdnUrl:n,darkTheme:t,fullLogo:e!==v.q7.GUARD&&e!==v.q7.AVATAR&&e!==v.q7.MODAL,text:w,type:e,lang:r,rtl:y}),S=(0,i.K)(r),P=(0,l.useMemo)(()=>(0,p.sD)(s),[s]);if(e===v.q7.MODAL){const s=(0,v._B)({cdnUrl:n,darkTheme:t,isWhiteLabelPartner:P,text:f("common.service.short_name"),type:e,lang:r,rtl:y});return(0,a.jsx)("span",{className:g(),children:(0,a.jsx)("img",{alt:k,className:g("service",{type:e,lang_ru:S,newYear:null==s?void 0:s.includes("new-year")}),crossOrigin:"anonymous",loading:"lazy",src:s,title:k})})}if(e===v.q7.GUARD){const{serviceType:s}=(0,m.Vk)(o.categoryNames),i=(s===v.CF.WEBAPPS_CATEGORY_SERVICE_NAME?f("common.service.app_name"):f("common.service.short_name")).replace(/\s/g,"%20"),l=(0,v._B)({cdnUrl:n,darkTheme:t,isWhiteLabelPartner:P,text:i,type:e,lang:r,rtl:y});return(0,a.jsx)("span",{className:g(),children:(0,a.jsx)("img",{alt:k,className:g("service",{type:e,lang_ru:S,newYear:null==l?void 0:l.includes("new-year")}),crossOrigin:"anonymous",loading:"lazy",src:l,title:k})})}if(e===v.q7.AVATAR)return P?null:(0,a.jsx)("div",{className:g(),children:(0,a.jsx)("img",{alt:k,className:g("company",{type:e,lang_ru:S,newYear:null==A?void 0:A.includes("new-year")}),crossOrigin:"anonymous",src:A,title:k})});const I=(0,v._B)({cdnUrl:n,darkTheme:t,isWhiteLabelPartner:P,text:b,type:e,lang:r,rtl:y});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{alt:k,className:g("service",{type:e,lang_ru:S,whitelabel:P,newYear:null==I?void 0:I.includes("new-year")}),crossOrigin:"anonymous",src:I,title:k})})};var f=r(54536);const w=({isShort:e,type:t})=>{switch(t){case v.q7.MENU:return(0,a.jsx)(f.Z,{isShort:e,showImage:!1,textSize:"m"});case v.q7.HEADER:return(0,a.jsx)(f.Z,{isShort:e,showImage:!1,textColor:"light",textSize:"s",type:t});case v.q7.MIDDLE_LAYER_HEADER:return(0,a.jsx)(f.Z,{isShort:e,showImage:!1,textSize:"s",type:t});case v.q7.GUARD:case v.q7.MODAL:case v.q7.PAYMENTS:return(0,a.jsx)(f.Z,{imageSize:"s",isShort:e,textSize:"m"});case v.q7.AVATAR:return(0,a.jsx)(f.Z,{imageSize:"m",isShort:e,showText:!1});default:return(0,a.jsx)(f.Z,{isShort:e,showImage:!1,textSize:"m"})}},b=({isShort:e,type:t})=>(0,v.EA)()!==s.EDomain.Yandex?(0,a.jsx)(w,{isShort:e,type:t}):(0,a.jsx)(y,{type:t})},16647:(e,t,r)=>{r.d(t,{Z:()=>De});var a=r(57627),s=r(43774),i=r(63904),n=r.n(i),o=r(87363),l=r(68927),d=r(35767),c=r(38225),u=r(55990),h=r(60362),p=r(59664);var v=r(78825);const m={ctrl:"control"},g={Space:"Space"},y=["altKey","ctrlKey","metaKey","shiftKey"],f=y.reduce((e,t)=>{var r;const a=t.replace("Key",""),s=(i=null!=(r=m[a])?r:a)[0].toUpperCase()+i.slice(1);var i;return e[t]={name:s,nameLeft:`${s}Left`,nameRight:`${s}Right`},e},{}),w=({keydown:e})=>{var t;if(!e)return"";const{code:r,key:a}=e,s=[],i=new Set,n=[];return y.forEach(t=>((e,t,r,a,s)=>{const{name:i,nameLeft:n,nameRight:o}=f[r];e&&(a.push(t===n||t===o?t:i),s.add(n),s.add(o))})(e[t],r,t,s,i)),s.length&&n.push(s.join(" + ")),i.has(r)||n.push(null!=(t=g[r])?t:a),n.join(" + ")},b=(0,p.A)()?(0,o.memo)(()=>{const[e,t]=(0,o.useState)(new Map),r=(0,o.useCallback)(({data:{data:e,messageId:r,action:a}})=>{"keydown"===a&&e&&(t(t=>{const a=new Map(t.entries());return 5===a.size&&a.delete(a.keys().next().value),a.set(r,{id:r,key:w(e)}),a}),setTimeout(()=>t(e=>{const t=new Map(e.entries());return t.delete(r),t}),2e3))},[]);return(0,o.useEffect)(()=>(v.Z.onExternalMessage(h.cV,r,{withHistory:!1}),()=>v.Z.offExternalMessage(h.cV,r)),[r]),(0,a.jsx)("div",{className:"KeydownLogger-module__KeydownLogger--WnZ6X",children:[...e.values()].map(({id:e,key:t})=>(0,a.jsx)("div",{className:"KeydownLogger-module__Key--wb4SI",children:t},e))})}):()=>(0,a.jsx)(a.Fragment,{});var k=r(12536),A=r(45682),S=r(66287),P=r(29276),I=r(30928),T=r(19146),E=r(50678),C=r(61916),D=r(87125),R=Object.defineProperty,x=(e,t,r)=>(((e,t,r)=>{t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const _=n().with("screen-manager-cover"),O=(0,D.M$)("ScreenManagerCover",D.XG.Popup);class L extends o.Component{constructor(){super(...arguments),x(this,"state",{visible:!0,playit:!1}),x(this,"onVisibilityChange",()=>{document.hidden&&this.setState({visible:!0})}),x(this,"onClick",()=>{this.setState({visible:!1}),v.Z.post({type:"screen-manager",action:"request-fullscreen"})})}componentDidMount(){if(O("componentDidMount"),P.w.available)return void this.setState({visible:!1});const e=(0,C.KT)();(0,k.Me)(e,k.QQ.PlayIt)&&"landscape"===this.gameOrientation&&this.setState({playit:!0}),this.addListeners()}get gameOrientation(){var e;return null==(e=this.context.playPageData.gameSettings.features)?void 0:e.orientation}componentDidUpdate(e){!e.isFullscreenActive&&this.props.isFullscreenActive&&this.setState({visible:!0})}componentWillUnmount(){O("componentWillUnmount"),this.removeListeners()}addListeners(){document.addEventListener("visibilitychange",this.onVisibilityChange)}removeListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}render(){return this.state.visible&&!this.props.isFullscreenActive?(0,a.jsx)("div",{className:_({playit:this.state.playit}),onClick:this.onClick,onTouchEnd:this.onClick}):null}}x(L,"contextType",E.Z);const B=(0,I.$j)(function(e){return{isFullscreenActive:e.ui.isFullscreenActive}})(L);var N=r(34922),j=r(81092),M=r(33249),H=r(94365),$=r(61712),F=r(99083),W=r(20966),Z=r(2592),q=r(60617),G=Object.defineProperty,z=(e,t,r)=>(((e,t,r)=>{t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const U=(0,D.M$)("ScreenManager",D.XG.Dev);class V extends o.Component{constructor(e){super(e),z(this,"onMessage",(e,t)=>{switch(e.data.action){case"request-fullscreen":this.requestFullscreen({force:!0}).then(()=>{t()}).catch(e=>{t({error:e})});break;case"exit-fullscreen":this.exitFullscreen().then(()=>{this.unlockScreenOrientation(),t()}).catch(e=>{t({error:e})});break;case"toggle-fullscreen":this.toggleFullscreen().then(()=>{this.unlockScreenOrientation(),t()}).catch(e=>{t({error:e})});break;case"rotate-banner-add":this.addScreenOrientationBanner();break;case"rotate-banner-remove":this.removeScreenOrientationBanner();break;case"get-state":this.isFullscreen().then(e=>{t({data:{isFullscreen:e,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})}).catch(()=>{t({data:{isFullscreen:!1,screenOrientationWasLocked:this.state.screenOrientationWasLocked}})});break;case"fullscreen-supported":t({data:{isFullscreenSupported:this.isFullscreenSupported}})}}),z(this,"updateFullscreenState",()=>{this.isFullscreen().then(e=>this.props.setIsFullscreenActive(e))}),this.state={screenOrientationWasLocked:!1,withCover:!1}}get gameFeatures(){return this.context.playPageData.gameSettings.features||{}}get fullScreenValue(){const{fullscreen:e}=this.gameFeatures;return"boolean"==typeof e?e:"desktop"!==this.context.deviceType}get gameOrientation(){const{orientation:e}=this.gameFeatures;if("landscape"===e||"portrait"===e)return e}componentDidMount(){U("componentDidMount"),this.props.setIsFullscreenEnabled(this.isFullscreenSupported()),this.addFullscreenListener(),this.updateFullscreenState(),this.initMessaging(),this.initCover(),this.initFullscreen(),this.initScreenOrientation()}componentWillUnmount(){U("componentWillUnmount"),this.removeFullscreenListener(),this.destroyMessaging(),this.destroyScreenOrientation()}addFullscreenListener(){var e;P.w.available?null==(e=(0,P.u)())||e.addEventListener("fullscreenchange",this):document.addEventListener(N.Z.fullscreenchange,this)}removeFullscreenListener(){var e;P.w.available?null==(e=(0,P.u)())||e.removeEventListener("fullscreenchange",this):document.removeEventListener(N.Z.fullscreenchange,this)}initMessaging(){v.Z.onExternalMessage("screen-manager",this.onMessage),v.Z.onInternalMessage("screen-manager",this.onMessage)}destroyMessaging(){v.Z.offExternalMessage("screen-manager",this.onMessage),v.Z.offInternalMessage("screen-manager",this.onMessage)}initCover(){this.isFullscreenEnabled()&&(P.w.available||(this.setState({withCover:!0}),(0,H.g)()||this.requestFullscreen().catch(()=>{})))}initFullscreen(){this.isFullscreenEnabled()&&((0,H.g)()||this.requestFullscreenForYandexPlatforms(),window.addEventListener("blur",this))}initScreenOrientation(){this.updateScreenOrientationBanner(),S.default.isSupported&&S.default.addChangeListener(this)}destroyScreenOrientation(){S.default.isSupported&&S.default.removeChangeListener(this)}handleEvent(e){const{type:t}=e;t===S.default.changeEventName?this.handleScreenOrientationChange():t===N.Z.fullscreenchange?(this.updateFullscreenState(),this.handleFullscreenChange()):"blur"===t?(window.removeEventListener("blur",this),window.setTimeout(()=>{var e,t,r;!(null==(e=document.activeElement)?void 0:e.toString().includes("HTMLIFrameElement"))&&"IFRAME"!==(null==(r=null==(t=document.activeElement)?void 0:t.tagName)?void 0:r.toUpperCase())||(0,H.g)()||this.requestFullscreen().catch(()=>{})},0)):(0,W.H)({prefix:"[ScreenManager]",sourceMethod:"handleEvent"},new Error(`Unknown event '${t}'`))}handleScreenOrientationChange(){!1===this.updateScreenOrientationBanner()&&this.requestFullscreen().catch(()=>{})}handleFullscreenChange(){this.isFullscreen().then(e=>{v.Z.hasChild()&&v.Z.postToChild(A.vP.Fullscreenchange({isFullscreen:e})),v.Z.post({type:"screen-manager",action:"fullscreenchange",data:{isFullscreen:e}}),window.setTimeout(()=>{e&&this.lockScreenOrientation()},Z.WT)}).catch(e=>{(0,W.H)({prefix:"[ScreenManager]",sourceMethod:"handleFullscreenChange"},e)})}isFullscreenSupported(){return P.w.available||Boolean(document[N.Z.fullscreenEnabled])}needScreenCover(){const e=(0,C.KT)();return(0,k.Me)(e,k.QQ.PlayIt)&&"landscape"===this.gameOrientation}isFullscreenEnabled(){const{abt:{flags:e},playPageData:{gameInfo:t}}=this.context,{appId:r}=t;if((0,q.Nm)(e))return!1;if(function(e){return["100714"].includes(e)}(r))return!1;if(window.parent!==window)return!1;const a=(0,C.KT)();return!(0,k.Me)(a,k.QQ.ByteApp)&&(!(0,k.Me)(a,k.QQ.PlayIt)||"portrait"!==this.gameOrientation)&&!this.props.isMiddleLayerInGameShown&&Boolean(this.fullScreenValue&&this.isFullscreenSupported())}get fullscreenElement(){return document[N.Z.fullscreenElement]}isFullscreen(){return P.w.available?P.w.isFullscreen():Promise.resolve(Boolean(this.fullscreenElement))}requestFullscreen({force:e}={}){return e||this.isFullscreenEnabled()?new Promise((e,t)=>{this.isFullscreen().then(r=>{r?e():this.fullscreenMethodCallWrapper("requestFullscreen").then(e).catch(t)}).catch(t)}):Promise.resolve()}requestFullscreenForYandexPlatforms(){((0,F.RY)()||(0,F.XQ)()||(0,F.V5)())&&this.requestFullscreen().catch(()=>{})}exitFullscreen(){return this.fullscreenMethodCallWrapper("exitFullscreen")}toggleFullscreen(){return this.isFullscreen().then(e=>e?this.exitFullscreen().then(()=>{this.needScreenCover()||this.setState({withCover:!1}),this.unlockScreenOrientation()}):this.requestFullscreen({force:!0}))}fullscreenMethodCallWrapper(e){return new Promise((t,r)=>{if(P.w.available)return void P.w[e]().then(t).catch(r);let a,s;if("exitFullscreen"===e?(a=document,s=document[N.Z.exitFullscreen]):(a=document.documentElement,s=a[N.Z[e]]),s)try{Promise.resolve(s.call(a,{navigationUI:"hide"})).then(()=>t()).catch(e=>r(e))}catch(e){r(e)}else r(new Error("Fullscreen is not supported"))})}isScreenOrientationSupported(){const{deviceType:e}=this.context;return"desktop"!==e&&"tv"!==e&&S.default.isSupported}isScreenOrientationEnabled(){return Boolean(this.gameOrientation&&this.isScreenOrientationSupported()&&!(0,q.t7)(this.context.abt.flags))}addScreenOrientationBanner(){(0,$.U4)({},{orientationBanner:{show:!0,correctOrientation:this.gameOrientation,currentOrientation:S.default.isSupported?(0,S.a)(S.default.type):void 0}}),this.props.setIsOrientationBannerVisible(Boolean(this.gameOrientation))}removeScreenOrientationBanner(){(0,$.U4)({},{orientationBanner:{show:!1,isLockedForcefully:this.state.screenOrientationWasLocked,correctOrientation:this.gameOrientation,currentOrientation:S.default.isSupported?(0,S.a)(S.default.type):void 0}}),this.props.setIsOrientationBannerVisible(!1)}updateScreenOrientationBanner(){if(this.isScreenOrientationEnabled())return S.default.type.startsWith(String(this.gameOrientation))?(this.removeScreenOrientationBanner(),!1):(this.addScreenOrientationBanner(),!0)}screenOrientationIsLockable(){return S.default.isLockable&&this.fullscreenElement&&this.isScreenOrientationEnabled()}lockScreenOrientation(){this.screenOrientationIsLockable()&&S.default.lock(this.gameOrientation).then(()=>{this.setState({screenOrientationWasLocked:!0}),this.props.setScreenOrientationLocked(!0)}).catch(e=>{console.debug(e),this.updateScreenOrientationBanner()})}unlockScreenOrientation(){this.state.screenOrientationWasLocked&&S.default.unlock().then(()=>{this.setState({screenOrientationWasLocked:!1}),this.props.setScreenOrientationLocked(!1)}).catch(e=>{console.debug(e)})}render(){const{withCover:e}=this.state;return[e&&(0,a.jsx)(B,{},"screen-manager-cover")]}}z(V,"contextType",E.Z);const K=(0,I.$j)(function(e){return{isMiddleLayerInGameShown:(0,M.nR)(e)}},function(e){return(0,T.DE)({setIsFullscreenActive:j.hu,setIsFullscreenEnabled:j.rV,setScreenOrientationLocked:j.ht,setIsOrientationBannerVisible:j.f_},e)})(V);var Y=r(73520),X=r(7153),J=r(28676),Q=r(73146),ee=r(32041),te=r(10122),re=r(39138),ae=r(90430),se=r(36329),ie=r(74344),ne=r(4522);const oe=({actionText:e,className:t,hasCloseButton:r=!0,images:s,isMobile:i=!1,isVisible:n,onActionClick:o,onCloseClick:l,text:d,title:c,withAnimation:u})=>{const h=(0,ne.E)(t,i&&"stripe-large-module__mobile--vxzaM","stripe-large-module__root--aNVEr",n?"stripe-large-module__visible--icAZo":"stripe-large-module__hidden--_fzF_",u&&"stripe-large-module__withAnimation--v1sgm");return(0,a.jsxs)("div",{className:h,children:[(0,a.jsxs)("div",{className:"stripe-large-module__info--hUx4f",children:[s&&s.length>0?(0,a.jsx)("div",{className:(0,ne.E)("stripe-large-module__images--nKuEH",s.length>1&&"stripe-large-module__hasRotation--nl_QG"),children:s.map((e,t)=>(0,a.jsx)("div",{className:"stripe-large-module__imageWrapper--IWqpF",children:e},`img-${t}`))}):(0,a.jsxs)("div",{className:"stripe-large-module__gamesPlaceholder--sMtoG",children:[(0,a.jsx)("div",{className:"stripe-large-module__mainImage--EkgcS"}),(0,a.jsx)("div",{className:"stripe-large-module__blurredBackground--wIchx"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"stripe-large-module__title--JYrHR",children:c}),d&&(0,a.jsx)("div",{className:"stripe-large-module__text--eqHAg",children:d})]})]}),(0,a.jsx)(se.z,{className:"stripe-large-module__actionControl--okVV2",rounded:!0,size:40,view:"primary",onClick:o,children:e}),r&&(0,a.jsx)(ie.Z,{mix:"stripe-large-module__closeControl--CPM2l",type:"popup",onClick:l})]})};var le=r(93181);const de=({actionText:e,images:t,isFixed:r,onActionClick:i,onCloseClick:n,text:l,title:d})=>{const u=(0,s.v_)({off:"login_stripe_bottom_no_close"}),[h,p]=((0,le.V)(),(0,o.useState)(!0)),v=(0,c.C)(e=>{var t;return null==(t=e.leftPanel)?void 0:t.desktopExpanded}),m=(0,o.useCallback)(()=>{p(!1),n()},[n]),g=(0,ne.E)("stripe-large-modal-module__stripeLargeModal--nngta",r&&"stripe-large-modal-module__fixed--_bN8k",v&&"stripe-large-modal-module__leftPanelExpanded--Sqdxw",!1);return(0,a.jsx)("div",{className:g,children:(0,a.jsx)(oe,{actionText:e,hasCloseButton:u,images:t,isMobile:!1,isVisible:h,text:l,title:d,withAnimation:!0,onActionClick:i,onCloseClick:m})})};var ce=r(74516),ue=r(10323),he=r(45310);const pe=ce.KL.default84x84,ve=({isFixed:e})=>{const t=(0,c.C)(e=>e.recentGames),{actionText:r,text:s,title:i}=(({count:e})=>{const t=(0,re.T)();return e>2?{actionText:t("common.login"),title:t("login-boosting.many-games.title"),text:t("login-boosting.games.description")}:{actionText:t("common.login"),title:t("login-boosting.few-games.title"),text:t("login-boosting.games.description")}})({count:t.length}),{isModalVisible:n,setIsModalVisible:l}=(0,te.c)(),d=(0,c.C)(e=>Boolean(e.userData.login));(0,o.useEffect)(()=>{d&&n&&((0,ae.R)(ee.y),l(!1))},[d,n,l]);const u=(0,o.useMemo)(()=>(null==t?void 0:t.length)>2?t.slice(0,3).map(({appID:e,media:t})=>(0,a.jsx)(Q.Z,{appID:e,media:t,size:pe},e)):void 0,[t]),h=(0,o.useCallback)(()=>{(0,ae.R)(ee.y),(0,X.iK)(()=>{l(!1)},300)},[l]);return!(0,he.I)()&&n&&r?(0,a.jsx)(J.s,{passportOrigin:ue._4.GamesTopStripe,children:({login:t,userIsLoggedIn:n})=>n?null:(0,a.jsx)(de,{actionText:r,images:u,isFixed:e,text:s,title:i,onActionClick:t,onCloseClick:h})}):null};var me=r(19694);var ge=r(76753);const ye=[h.ur.TTIReady,h.ur.GameReady],fe=["frame","game-measuring"],we=5*Z.WT;var be=r(77314);const ke=({actionGlowing:e,actionText:t,className:r,isVisible:s,onActionClick:i,onCloseClick:n,text:l,withAnimation:d})=>{const{isVisibleCommitted:c,withAnimationCommitted:u,stripeRef:h,rightButtonRef:p,stripeRefStyles:v}=((e,t)=>{const{rtl:r}=(0,be.b)(),a=(0,o.useRef)(null),s=(0,o.useRef)(null),i=(0,o.useRef)({}),[n,l]=(0,o.useState)(e),[d,c]=(0,o.useState)(t);return(0,o.useEffect)(function(){if(!e)if(a.current&&s.current){const e=a.current,t=s.current,n=r?-1:1;i.current={"--stripe-current-width":e.clientWidth-16+"px","--stripe-anchor-offset-left":r?`${e.offsetLeft}px`:"unset","--stripe-anchor-offset-right":r?"unset":`${e.offsetLeft}px`,"--stripe-right-button-width":`${t.offsetWidth}px`,"--stripe-out-anchor":n*e.offsetLeft+"px"}}else c(!1);l(e)},[e,r]),{isVisibleCommitted:n,withAnimationCommitted:d,stripeRef:a,rightButtonRef:s,stripeRefStyles:i}})(s,d);return(0,a.jsxs)("div",{className:(0,ne.E)(r,"stripe-module__stripe--tgKRw",u&&"stripe-module__withAnimation--j1w4T",c?"stripe-module__visible--FvVvZ":"stripe-module__hidden--iR7uG"),ref:h,style:v.current,children:[(0,a.jsx)("div",{className:"stripe-module__leftColumn--fUihx",children:(0,a.jsx)(ie.Z,{type:"button",onClick:n})}),(0,a.jsx)("div",{className:"stripe-module__centerColumn--rnR5m",children:l}),(0,a.jsx)("div",{className:"stripe-module__rightColumn--K33HV",children:(0,a.jsx)(se.z,{glowing:e,ref:p,rounded:!0,view:"primary",onClick:i,children:t})})]})},Ae=({actionText:e,onActionClick:t,onCloseClick:r,text:s,minDisplayTimeMs:i})=>{const{handleMouseEnter:n,handleMouseLeave:l,isModalVisible:d,setIsModalVisible:c}=(({minDisplayTimeMs:e=we,onClose:t})=>{const r=(()=>{const[e,t]=(0,o.useState)(!1);return(0,ge.q)(()=>{const e=r=>{if(!r.data||!r.data.action)return;const{action:a}=r.data;ye.includes(a)&&(t(!0),v.Z.offAllMessages(fe,e))};return v.Z.onAllMessages(fe,e,{withHistory:!0}),()=>{v.Z.offAllMessages(fe,e)}}),e})(),[a,s]=(0,o.useState)(!r),[i,n]=(0,o.useState)(!1),l=(0,o.useRef)(null),d=(0,o.useCallback)(()=>{n(!0)},[]),c=(0,o.useCallback)(()=>{n(!1)},[]);return(0,o.useEffect)(()=>{r||null!==l.current||(l.current=Date.now(),s(!0))},[r]),(0,o.useEffect)(()=>{if(!r||i||null===l.current)return;const a=Date.now()-l.current,n=Math.max(0,e-a),o=window.setTimeout(()=>{null!==l.current&&Date.now()-l.current>=e&&!i&&(s(!1),null==t||t({isUserInitiated:!1}))},n);return()=>{window.clearTimeout(o)}},[r,i,e,t]),{handleMouseEnter:d,handleMouseLeave:c,isModalVisible:a,setIsModalVisible:s}})({minDisplayTimeMs:i,onClose:r}),u=(0,o.useCallback)(()=>{c(!1),r({isUserInitiated:!0})},[c,r]);return(0,a.jsx)("div",{className:"stripe-modal-module__stripeModal--CnEEr",onMouseEnter:n,onMouseLeave:l,children:(0,a.jsx)(ke,{actionText:e,isVisible:d,text:s,withAnimation:!0,onActionClick:t,onCloseClick:u})})},Se=()=>{const e=(0,re.T)(),{isModalVisible:t,setIsModalVisible:r}=(()=>{const e=(0,c.T)(),t=(0,c.C)(me.Nl);return(0,o.useEffect)(()=>{const t=!(0,s.v_)({off:"login_stripe_top"})&&(0,ae.G)(ee.p);e((0,j.AN)(t))},[e]),{isModalVisible:t,setIsModalVisible:(0,o.useCallback)(t=>{e((0,j.AN)(t))},[e])}})(),[i,n]=(0,o.useState)(t),l=(0,o.useRef)(null),d=(0,c.C)(e=>Boolean(e.userData.login));(0,o.useEffect)(()=>(t?n(!0):l.current=window.setTimeout(()=>{n(!1)},700),()=>{l.current&&window.clearTimeout(l.current)}),[t]),(0,o.useEffect)(()=>{d&&t&&((0,ae.R)(ee.p),r(!1))},[d,t,r]);const u=e("common.login"),h=e("login-boosting.game"),p=(0,o.useCallback)(e=>{e.isUserInitiated&&(0,ae.R)(ee.p),r(!1)},[r]);return!(0,he.I)()&&i&&u&&h?(0,a.jsx)(J.s,{passportOrigin:ue._4.GamesTopStripe,children:({login:e,userIsLoggedIn:t})=>t?null:(0,a.jsx)(Ae,{actionText:u,text:h,onActionClick:e,onCloseClick:p})}):null};var Pe=r(29789),Ie=r(38149),Te=r(21713),Ee=r(26592);const Ce=n().with("game-root"),De=({showDragOverlay:e,onDragOverlayCloseByButton:t})=>{var r;const i=(0,be.b)(),n=(0,l.TH)(),h=(0,c.T)(),p=(0,q.mD)(i.abt.flags),{isInProgress:v}=(0,Pe.O)(),{abt:m,playPageData:g,baseHost:y,baseUrl:f,requestId:w,uatraits:k,isAndroidTV:A,deviceType:S,middleLayerInGameData:P,isTranssion:I}=i,{gameSrcDocument:T}=g,[E,C]=(0,o.useState)(!1),D=(0,o.useCallback)(()=>{var e;null==t||t(),C(!p),h((0,d.T)(!0)),null==(e=window.clickdaemonLog)||e.call(window,Y.C.SWIPE2FS,{item:"swipe2fsClose"})},[h,p,t]);let R=g.iframeAllow+"accelerometer; gyroscope;";const x=(0,re.T)(),_=(0,o.useMemo)(()=>(0,q.MA)(m.flags)||I||Boolean(P)||v,[m.flags,P,I,v]),O=(0,o.useRef)(n.search);let L=(0,o.useMemo)(()=>{var e;const{frameSrc:t}=function({appId:e,baseHost:t,baseUrl:r,deviceType:a,gameSrc:s,hasExternalURL:i,s3PreloaderHelperPath:n,sdkHash:o,search:l,uatraits:d}){const c=new Set(["draft"]),u=new Set([Te.fP]),h=new URL(s),p=new URLSearchParams(h.hash.slice(1));Array.from(new URLSearchParams(l.slice(1)).entries()).forEach(([e,t])=>{u.has(e)||(c.has(e)&&null!==t&&p.append(e,t),h.searchParams.has(e)||h.searchParams.append(e,t))}),i?(h.searchParams.set("sdk",`https://games.s3.yandex.net/sdk/_/v2.${o}.js`),h.searchParams.set("sdk_origin","sdk.games.s3.yandex.net")):h.searchParams.set("sdk",`/sdk/_/v2.${o}.js`),p.has("app-id")||p.append("app-id",e),p.append("device-type",a),h.hash=p.toString(),/[?&]csp_test=true/.test(l)&&(h.pathname=h.pathname.replace("index.html","index-csp.html"));const v=h.toString();Array.from(h.searchParams.keys()).forEach(e=>{e.startsWith("utm_")&&h.searchParams.delete(e)});let m=h.toString();if((0,Ee.G)(d)||(0,Ee.g)(d)){const e=(0,Ie.V)(m);e&&(m=e+(n.startsWith("/")?n.substring(1):n)+"?retpath="+encodeURIComponent(v))}return{frameSrc:m,originSrc:v}}({abt:m,appId:g.gameInfo.appId,baseHost:y,baseUrl:f,deviceType:S,gameSrc:g.gameSrc,hasExternalURL:Boolean(null==(e=g.gameData)?void 0:e.hasExternalURL),s3PreloaderHelperPath:g.s3PreloaderHelperPath,sdkHash:g.sdkHash,search:_?O.current:n.search,uatraits:k});return t},[m,y,f,S,n.search,null==(r=g.gameData)?void 0:r.hasExternalURL,g.gameInfo.appId,g.gameSrc,g.s3PreloaderHelperPath,g.sdkHash,O,_,k]);const B=(0,o.useCallback)(()=>{var e;"undefined"!=typeof window&&(null==(e=window.onGameFrameLoad)||e.call(window))},[]),N=(0,o.useCallback)(e=>{var t;"undefined"!=typeof window&&(null==(t=window.onGameFrameError)||t.call(window,e))},[]);let j=L;if(T){const e=new URL(L),t=new URL(T);t.hash=e.hash,j=t.toString()}return(0,a.jsxs)("div",{className:Ce(),children:[(0,a.jsx)(K,{}),(0,a.jsx)("iframe",{allow:R,"data-allowed-origins":JSON.stringify([g.gameOrigin,y]),"data-origin-src":L,id:"game-frame",name:w,sandbox:undefined,src:j,style:{},onError:N,onLoad:B}),e&&!E&&(0,a.jsxs)("div",{className:Ce("swipe-to-fs"),children:[(0,a.jsx)(u.Z,{className:Ce("swipe-to-fs-close-icon"),type:"close-circle",onClick:D}),(0,a.jsx)("div",{className:Ce("swipe-to-fs-bg")}),(0,a.jsxs)("div",{className:Ce("swipe-to-fs-content"),children:[(0,a.jsx)("span",{children:x(p?"game.swipe-to-fs-long":"game.swipe-to-fs")}),(0,a.jsx)("div",{className:Ce("swipe-to-fs-hint")})]})]}),(0,a.jsx)(b,{}),(0,a.jsx)(s.hW,{on:"login_stripe_top",onComponent:(0,a.jsx)(Se,{})}),(0,a.jsx)(s.hW,{on:"login_stripe_bottom_game",onComponent:(0,a.jsx)(ve,{})})]})}},93986:(e,t,r)=>{r.d(t,{G0:()=>T,GP:()=>E,IR:()=>C,QU:()=>R,WM:()=>x,Xp:()=>P,Zn:()=>D});var a=r(36240),s=r(21377),i=r(29743),n=r(42876),o=r(67296),l=r(60971),d=r(20966),c=r(2592),u=r(87125),h=r(97731),p=r(33376),v=r(85031),m=Object.defineProperty,g=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,w=(e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const b=60*c.WT;let k={time:0,data:{products:[]}};const A=e=>u.HQ&&(0,i.Q)(n.G)?e.map(e=>{var t=e,{currencyPrice:r}=t;return((e,t)=>{for(var r in t||(t={}))y.call(t,r)&&w(e,r,t[r]);if(g)for(var r of g(t))f.call(t,r)&&w(e,r,t[r]);return e})({},((e,t)=>{var r={};for(var a in e)y.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&g)for(var a of g(e))t.indexOf(a)<0&&f.call(e,a)&&(r[a]=e[a]);return r})(t,["currencyPrice"]))}):e,S=(0,u.M$)("Payments",u.XG.Dev);function P(e,t){const{lang:r}=t;return new Promise((a,s)=>{Math.abs(k.time-Date.now())<b&&k.lang===r?a({products:A(k.data.products)}):e.getGameProducts(t).then(e=>{k={data:e,lang:r,time:Date.now()},a({products:A(k.data.products)})}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"getProducts",message:`${p.EW} getProducts error`,type:"fetch"},e),s(e)})})}const I=Object.create(null),T=(0,o.Z)(function(e,t){const{token:r}=t;return S("consumePurchase",r),r in I||(I[r]=new Promise((a,i)=>{e.consumePurchase(t).then(e=>{delete I[r],S("consumePurchase responseData",e),e.token?a(e.token):i(new s.Z({code:"CANNOT_CONSUME_PURCHASE",message:"Can not consume purchase."}))}).catch(e=>{delete I[r],(0,d.H)({block:h.W.PAYMENT,sourceMethod:"consumePurchase",message:`${p.EW} consumePurchase error`,type:"fetch"},e),i(e)})})),I[r]});function E(e,t){return new Promise((r,s)=>{e.getPurchases(t).then(e=>{const{data:t,signature:s}=(0,a.c)(e,d.H);r({data:t,signature:s})}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"getPurchases",message:`${p.EW} getPurchases error`,type:"fetch"},e),s(e)})})}function C(e,t){return new Promise((r,a)=>{t.minRequiredAmount||delete t.minRequiredAmount,e.fetchCurrencyProducts(t).then(({data:e})=>{S("fetchCurrencyData response",e),r(e)}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"getCurrencyProducts",message:`${p.EW} getCurrencyProducts error`,type:"fetch"},e),a(e)})})}function D(e,{id:t,lang:r,getText:a,cdnUrl:s,product:i}){return new Promise((n,o)=>{function c(r){var i,d,c,u;const h=r.info.price,p=r.info.pricePlus,m=Boolean(null==(c=null==(d=null==(i=window.YandexGamesSDK)?void 0:i.game)?void 0:d.player)?void 0:c.hasYaPlus)&&"number"==typeof p&&p<h&&p>=0?p:h,g={balance:-1,product:{description:a(`purchase.description.${t}`),id:t,image:{url_prefix:`${s}/games-static/static-data/images/payments/subscriptions/${t}.svg`},price:m,pricePlus:p,priceRegular:h,title:a(`purchase.title.${t}`)}};if(!l.XK){const{experiments:e={}}=null==(u=window.YandexGamesSDK)?void 0:u.request,t=e.new_payments_balance;void 0!==t&&""!==t&&(g.balance=parseInt(t,10)||0);const r=e.new_payments_mockable;void 0!==r&&(g.mockable=r||!1)}(0,v.P)().isSearchCrawler||e.getUserBalance().then(({value:e})=>{g.balance=e,n(g)}).catch(o)}i&&i.id===t?c(i):e.getPlatformProduct({id:t,lang:r}).then(e=>{c(e)}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"getPlatformProduct",message:`${p.EW} getPlatformProduct error`,type:"fetch"},e),o(e)})})}const R=(0,o.Z)(function(e,t,r){return new Promise((a,s)=>{e.buyPlatformProduct(t,r).then(e=>{"failure"===e.status?s(new Error(e.message)):a(e)}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"buyPlatformProduct",message:`${p.EW} buyPlatformProduct error`,type:"fetch"},e),s(e)})})});function x(e){return new Promise((t,r)=>{e.getRecoveryCode().then(e=>{t(e.code)}).catch(e=>{(0,d.H)({block:h.W.PAYMENT,sourceMethod:"getRecoveryCode",message:`${p.EW} getRecoveryCode error`,type:"fetch"},e),r(e)})})}},25954:(e,t,r)=>{r.d(t,{E:()=>s});var a=r(55468);function s(e){return(0,a.f1)(e)?new a.ZP.AuthError({code:"UNAUTHORIZED",message:"Unauthorized"}):new a.ZP.PaymentsError({code:"PAYMENT_FAILURE",message:"Payment failure"})}},10796:(e,t,r)=>{r.d(t,{Z:()=>w});var a=r(21377),s=r(14181),i=r(78825),n=r(61712),o=r(37174),l=r(20966),d=r(97731),c=r(33376),u=Object.defineProperty,h=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,m=(e,t,r)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))p.call(t,r)&&m(e,r,t[r]);if(h)for(var r of h(t))v.call(t,r)&&m(e,r,t[r]);return e},y=(e,t,r)=>(m(e,"symbol"!=typeof t?t+"":t,r),r);const f=[0,5,10,20,40,60,90,120,200,300,400,1/0];class w{constructor(e){y(this,"appId"),y(this,"productStatData"),y(this,"basicSupportPaymentRequest"),y(this,"dialogType"),y(this,"supportPaymentRequest"),y(this,"startTime"),y(this,"authStates"),y(this,"isDestroyed",!1),y(this,"reachGoalRef"),y(this,"onInternalAuthMessage",e=>{const{action:t,data:r}=e.data;if(!r||"auth-fetch-wrapper"===r.initializer)switch(t){case"auth-dialog-open":this.authStates.authOpen=Date.now();break;case"auth-dialog-success":this.authStates.authSuccess=Date.now();break;case"auth-dialog-cancel":this.authStates.authCancel=Date.now()}}),this.productStatData=e.productStatData,this.startTime=Date.now(),this.appId=e.appId,this.authStates={},this.basicSupportPaymentRequest=e.basicSupportPaymentRequest,this.supportPaymentRequest=e.supportPaymentRequest,this.dialogType=e.dialogType,this.reachGoalRef=e.reachGoalRef,i.Z.onInternalMessage("auth",this.onInternalAuthMessage)}get reachGoal(){return this.reachGoalRef.current}destroy(){i.Z.offInternalMessage("auth",this.onInternalAuthMessage),delete this.productStatData,this.reachGoalRef={current:(0,o.iF)({context:{playPageData:"undefined"==typeof window?{}:window.playPageData},props:{partnerEventsLogParams:null}})},this.isDestroyed=!0}log(e,t={}){if(!this.productStatData||this.isDestroyed)return void this.warnAboutDestroyed("log");const r=Object.assign({state:e,appId:this.appId,productId:this.productStatData.id,title:this.productStatData.title,price:this.productStatData.price,basicSupportPaymentRequest:this.basicSupportPaymentRequest,v:2},t);"success"===e&&this.authStates.authSuccess&&(this.authStates.authSuccessPurchase=Date.now()),!t.preventDestroy&&["success","cancel","fail"].includes(e)&&(r.timeInterval=function(e){for(let t=0;t<f.length-1;t+=1)if(e>=f[t]&&e<f[t+1])return f[t+1]===1/0?`${f[t]}+`:`${f[t]}-${f[t+1]}`;return`${f[f.length-1]}+`}(Math.abs(Date.now()-this.startTime)/1e3),this.logAuthStates(),this.destroy()),(0,n.U4)({},{borrowParams:{purchase:r}})}logAuthStates(){Object.keys(this.authStates).forEach(e=>this.log(e),this),this.authStates={}}error(e,t={}){if(this.isDestroyed)return void this.warnAboutDestroyed("error");const r=e instanceof a.Z&&"PAYMENT_USER_CANCELED"===e.code?"cancel":"fail";this.log(r,g({reason:e.message,basicSupportPaymentRequest:this.basicSupportPaymentRequest,supportPaymentRequest:this.supportPaymentRequest},t))}reachGoals(e){var t,r,a,s,i;if(!this.productStatData)return void this.warnAboutDestroyed("reachGoals");this.reachGoal(c.Ji.SUCCESS_PURCHASE.replace("%app_id%",this.appId),{amount:null==(t=this.productStatData)?void 0:t.price,auth:e.hasAuth,dialog_type:this.dialogType,order_price:null==(r=this.productStatData)?void 0:r.price},{});const n=g({appId:this.appId,auth:e.hasAuth,dialog_type:this.dialogType},e.provider&&{payment_system:e.provider});void 0!==e.offerId&&(n.offer_id=e.offerId),void 0!==(null==(a=this.productStatData)?void 0:a.price)&&(n.amount=null==(s=this.productStatData)?void 0:s.price,n.order_price=null==(i=this.productStatData)?void 0:i.price),this.reachGoal(c.Ji.SUCCESS_PURCHASE_TRANSACTION,n)}sexyOfferShown(){this.reachGoal(c.Ji.INAPP_OFFER_SHOWN,{appId:this.appId})}openPurchase(e){this.reachGoal(c.Ji.PURCHASES_PURCHASE_OPEN,{auth:e,dialog_type:s.Z.PURCHASE,appId:this.appId})}warnAboutDestroyed(e){console.warn(`No data in the MetrikaStatesLogger when call '${e}'. Maybe already destroyed.`)}addProductInCart(e){if(!this.productStatData||!e)return void(0,l.H)({block:d.W.METRIKA,level:"warn",message:"Error in `addProductInCart`",prefix:"[Ecommerce]"});const t=window.appData.payCurrency;(0,n._H)({currencyCode:t,add:{products:[{id:this.productStatData.id,name:this.productStatData.title,price:this.productStatData.price,brand:e.publisherName,category:e.category,quantity:1}]}})}buyProduct(e){if(!this.productStatData||!e)return void(0,l.H)({block:d.W.METRIKA,level:"warn",message:"Error in `buyProduct`",prefix:"[Ecommerce]"});const t=window.appData.payCurrency;(0,n._H)({currencyCode:t,purchase:{actionField:{id:this.appId},products:[{id:this.productStatData.id,name:this.productStatData.title,price:this.productStatData.price,brand:e.publisherName,category:e.category,quantity:1}]}})}buyPlatformProduct({id:e,price:t}){(0,n._H)({promoClick:{promotions:[{id:"yanpopup",name:"generalpopup",creative:String(t),position:String(e)}]}})}}},85294:(e,t,r)=>{r.d(t,{Z:()=>I});var a=r(57627),s=r(63904),i=r.n(s),n=r(87363),o=r.n(n),l=r(30928),d=r(59962),c=r(22577),u=r(50678),h=r(8431),p=r(93986),v=r(25954);const m=r(20119).Z;var g=r(14181),y=r(78825),f=r(60971),w=r(87437),b=r(10323),k=Object.defineProperty,A=(e,t,r)=>(((e,t,r)=>{t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const S=i().with("play-payments");class P extends u.P{constructor(e,t){super(e),A(this,"paymentsRootRef",o().createRef()),A(this,"startPlatformMessagingCallback"),A(this,"onExternalPaymentsMessage",(e,t)=>{const{action:r,data:a}=e.data;switch(r){case"get-env":t({data:{paymentMode:(0,w.Z)()?"":void 0}});break;case"get-catalog":const{lang:e}=a,{playPageData:{gameInfo:{appId:r,isDraft:s}}}=this.context;(0,p.Xp)(this.props.api,{appId:r,draft:s,lang:e||this.state.defaultLang}).then(e=>{t({data:e})}).catch(e=>{t({error:(0,v.E)(e)})});break;case"get-purchases":{const{paymentsConfig:e}=a,{playPageData:{gameInfo:{appId:r,isDraft:s}}}=this.context;(0,p.GP)(this.props.api,{appId:r,draft:s,lang:e.lang||this.state.defaultLang,signed:e.signed}).then(({data:e,signature:r})=>{t({data:{data:e,signature:r}})}).catch(e=>{t({error:(0,v.E)(e)})});break}case"purchase-consume":{const{token:e}=a,{playPageData:{gameInfo:{appId:r,isDraft:s}}}=this.context;(0,p.G0)(this.props.api,{"app-id":r,draft:s,token:e}).then(e=>{t({data:{token:e}})}).catch(e=>{t({error:(0,v.E)(e)})});break}}}),A(this,"onInternalPaymentsMessage",(e,t)=>{const{action:r,data:a}=e.data;switch(r){case"balance-refill":{const{paymentsConfig:e}=a;this.openBalanceDialog(e);break}case"platform-purchase-start":this.startPlatformPurchase(a,t)}}),A(this,"onBalanceSuccess",()=>{this.setState({balanceDialog:null})}),A(this,"onBalanceError",e=>{f.XK||console.warn(e),this.setState({balanceDialog:null})}),A(this,"onPlatformPurchaseSuccess",e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,{data:e}),this.setState({purchaseDialog:null})}),A(this,"onPlatformPurchaseError",e=>{var t;null==(t=this.startPlatformMessagingCallback)||t.call(this,e),this.setState({purchaseDialog:null})}),A(this,"trembleDialog",()=>{this.setState({isTrembling:!1},()=>{requestAnimationFrame(()=>{this.setState({isTrembling:!0}),window.setTimeout(()=>{this.setState({isTrembling:!1})},2e3)})})}),A(this,"handleCreateBalanceRefilled",e=>{this.setState({balanceRefilled:e})}),A(this,"handleBalanceRefilledClose",()=>{var e,t;null==(t=null==(e=this.state.balanceRefilled)?void 0:e.onClose)||t.call(e),this.setState({balanceRefilled:null})}),A(this,"handleBalanceRefilledBuyMore",()=>{y.Z.post({type:"payments",action:"balance-refill",data:{paymentsConfig:{lang:this.context.lang}}}),this.handleBalanceRefilledClose()}),A(this,"renderContent",()=>(0,a.jsxs)(a.Fragment,{children:[this.renderBalanceRefilled(),this.renderDialog()]})),this.state={balanceDialog:null,balanceRefilled:null,dialogType:g.Z.BALANCE,purchaseDialog:null,basicSupportPaymentRequest:!1,isTrembling:!1,defaultLang:t.lang,hasMounted:!1}}componentDidMount(){this.setState({basicSupportPaymentRequest:(0,w.Z)(),hasMounted:!0}),this.initMessaging()}componentDidUpdate(e,t){var r,a;(null===t.balanceDialog&&null!==this.state.balanceDialog||null!==t.balanceDialog&&null===this.state.balanceDialog)&&(null==(a=(r=this.props).onDialogChange)||a.call(r,Boolean(this.state.balanceDialog)))}initMessaging(){y.Z.onExternalMessage("payments",this.onExternalPaymentsMessage),y.Z.onInternalMessage("payments",this.onInternalPaymentsMessage)}startPlatformPurchase(e,t){if(this.props.disablePlatformPurchase)return;if(this.state.purchaseDialog||this.state.balanceDialog)return void this.trembleDialog();const{paymentsConfig:r,purchaseConfig:a}=e;this.startPlatformMessagingCallback=t,this.setState({dialogType:g.Z.PURCHASE,balanceDialog:null,purchaseDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:r,purchaseConfig:a,isPlatformPurchase:!0}})}openBalanceDialog(e){this.state.purchaseDialog||this.state.balanceDialog?this.trembleDialog():this.setState({dialogType:g.Z.BALANCE,purchaseDialog:null,balanceDialog:{basicSupportPaymentRequest:this.state.basicSupportPaymentRequest,paymentsConfig:e}})}renderBalanceRefilled(){const{balanceRefilled:e,purchaseDialog:t}=this.state,{balance:r}=this.props;if(e){const s=t?"balance-refilled.ok":"balance-refilled.return-to-game";return(0,a.jsx)(h.Z,{appId:this.context.playPageData.gameInfo.appId,balance:"number"==typeof r?r:void 0,diff:Number(e.diff),imgSrc:e.img,isPurchase:Boolean(t),isRetpathUser:!0,orderPrice:e.orderPrice,passportOrigin:b._4.GamesBalanceRefilled,playRecoveryCode:e.recoveryCode,returnButtonText:this.props.getText(s),onBuyMore:this.handleBalanceRefilledBuyMore,onClose:this.handleBalanceRefilledClose})}return null}renderDialog(){const{hideAuthDialog:e}=this.props,{balanceDialog:t,purchaseDialog:r,isTrembling:s,dialogType:i}=this.state;return t?(0,a.jsx)(m,{basicSupportPaymentRequest:t.basicSupportPaymentRequest,dialogType:i,hideAuthDialog:e,isTrembling:s,paymentsConfig:t.paymentsConfig,rootRef:this.paymentsRootRef,onBalanceError:this.onBalanceError,onBalanceSuccess:this.onBalanceSuccess,onCreateBalanceRefilled:this.handleCreateBalanceRefilled}):r?(0,a.jsx)(m,{basicSupportPaymentRequest:r.basicSupportPaymentRequest,dialogType:i,hideAuthDialog:e,isPlatformPurchase:r.isPlatformPurchase,isTrembling:s,paymentsConfig:r.paymentsConfig,purchaseConfig:r.purchaseConfig,rootRef:this.paymentsRootRef,onCreateBalanceRefilled:this.handleCreateBalanceRefilled,onPlatformPurchaseError:this.onPlatformPurchaseError,onPlatformPurchaseSuccess:this.onPlatformPurchaseSuccess}):null}render(){return this.state.hasMounted?(0,a.jsx)("div",{className:S(),ref:this.paymentsRootRef,children:this.renderContent()}):null}}const I=(0,l.$j)(function(e){return{api:(0,d.Z)(e.apiData),balance:(0,c.n)(e),getText:e.getText,payCurrency:e.user.payCurrency}})(P)},10452:(e,t,r)=>{r.d(t,{Z:()=>m});var a,s=r(30569),i=Object.defineProperty;const n=Symbol("codePath"),o=Symbol("appId"),l=Symbol("sendMetricaParams"),d=Symbol("currencyPriceStat"),c=Symbol("sendOnceCurrencyCodeStat"),u=Symbol("getCurrencyImageUrlPrefix"),h=Symbol("currencyCodeStat");class p{constructor(e){var t;this._productData=e,((e,t,r)=>{t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(this,"symbol"!=typeof(t=a)?t+"":t,()=>{this[c]=()=>{},this[l](this[h])})}get id(){return this._productData.id}get title(){return(0,s.Z)(this._productData.title)}get description(){return(0,s.Z)(this._productData.description)}get imageURI(){const{image:e}=this._productData;if(e&&"object"==typeof e&&"url_prefix"in e){const t=String(e.url_prefix);return/\.(png|jpg|svg)$/.test(t)?t:`${t}/default256x256`}return"https://yastatic.net/s3/games-static/static-data/images/payments/default-product-image.png"}get price(){return`${this.priceValue}Â ${this.priceCurrencyCode}`}get priceValue(){return String(this._productData.price)}get priceCurrencyCode(){this[c]()}get[n](){return""}getPriceCurrencyImage(e="small"){if("svg"===e)return`${this[u]()}/currency-icon-m.svg`;let t="s";switch(e){case"medium":case"small":t=e.charAt(0);break;default:console.warn(`Unknown size value ('${e}')`)}const r=window.devicePixelRatio>=2;return`${this[u]()}/currency-icon-${t}${r?"@2x":""}.png`}toJSON(){return{id:this.id,title:this.title,description:this.description,imageURI:this.imageURI,price:this.price,priceValue:this.priceValue,priceCurrencyCode:this.priceCurrencyCode}}get[h](){return{borrowParams:{payments:{appId:this[o],productCurrencyCodeGet:!0}}}}[(a=c,u)](){return`//yastatic.net/s3/games-static/static-data/images/payments/sdk${this[n]}`}get[d](){return this._productData.currencyPrice}}var v=r(85082);class m extends p{get pricePlusValue(){return String(this._productData.pricePlus||"")}get priceRegularValue(){return String(this._productData.priceRegular)}get productBenefit(){return this._productData.benefit||null}get[o](){throw(0,v.r)()}[l](e){}getProductSpecialOffers(){return this.productBenefit&&"specialOffers"in this.productBenefit?this.productBenefit.specialOffers:null}getProductDiscount(){return this._productData.benefit&&"discounts"in this._productData.benefit?this._productData.benefit.discounts:null}isDiscounted(){const{price:e,priceRegular:t}=this._productData;return e<t}toJSON(){return{id:this.id,title:this.title,description:this.description,imageURI:this.imageURI,price:this.price,pricePlusValue:this.pricePlusValue,priceRegularValue:this.priceRegularValue,priceValue:this.priceValue,priceCurrencyCode:this.priceCurrencyCode}}}},14181:(e,t,r)=>{r.d(t,{Z:()=>a});var a=(e=>(e.BALANCE="balance",e.PURCHASE="purchase",e))(a||{})},34922:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(62764);const s={fullscreenEnabled:(0,a.Z)("fullscreenEnabled"),fullscreenElement:(0,a.Z)("fullscreenElement"),requestFullscreen:(0,a.Z)("requestFullscreen"),exitFullscreen:(0,a.Z)("exitFullscreen"),fullscreenchange:(0,a.Z)("fullscreenchange")}},85743:(e,t,r)=>{r.d(t,{Z:()=>l});var a=r(87363),s=r(68207),i=r(70815),n=r(38225),o=r(40497);const l=()=>{const e="undefined"!=typeof window,t=(0,n.C)(e=>e.userData.uid),r=(0,n.C)(e=>e.user.balance.ignoreBalanceEvents),l=(0,o.z)(),d=(0,a.useRef)(t),c=(0,n.T)(),u=(0,a.useMemo)(()=>e&&l.sse||!1,[l,e]);return(0,a.useEffect)(()=>{u&&d.current!==t&&(d.current=t,u.changeAuth(t))},[u,t]),(0,a.useEffect)(()=>{if(!u)return;const e=[],t=u.subscribe(i.Xn.BALANCE_CHANGED,()=>{r||c((0,s.Zc)({forceFetch:!0}))}),a=u.subscribe(i.Xn.BALANCE_UPDATE,e=>{r||c((0,s.v)(e.value))});return e.push(t),e.push(a),()=>{e.forEach(e=>e())}},[u,r,c]),null}},32041:(e,t,r)=>{r.d(t,{p:()=>a,y:()=>s});const a="yandexGames_stripe_modal_hide_until",s="yandexGames_stripe_large_modal_hide_until"},10122:(e,t,r)=>{r.d(t,{c:()=>c});var a=r(43774),s=r(87363),i=r(81092),n=r(38225),o=r(19694),l=r(32041),d=r(90430);const c=()=>{const e=(0,n.T)(),t=(0,n.C)(o.B8);return(0,s.useEffect)(()=>{const t=!(0,a.v_)({off:"login_stripe_bottom_game"})&&(0,d.G)(l.y);e((0,i.wu)(t))},[e]),{isModalVisible:t,setIsModalVisible:(0,s.useCallback)(t=>{e((0,i.wu)(t))},[e])}}},90430:(e,t,r)=>{r.d(t,{G:()=>n,R:()=>i});var a=r(7323),s=r(2592);function i(e){const t=Date.now()+s.s2;return(0,a.Ur)(e,String(t))}function n(e){const t=(0,a.dq)(e);if(t.wasError)return!1;if(!t.value)return!0;const r=parseInt(t.value,10);return!isNaN(r)&&Date.now()>=r}},15292:(e,t,r)=>{r.d(t,{u:()=>c});var a=r(4545),s=r(43774),i=r(87363),n=r(38225),o=r(77314),l=r(3891),d=r(53673);const c=()=>{const e=(0,n.C)(e=>e.user.payCurrency),{abt:{flags:t},tld:r,paymentService:c}=(0,o.b)();return(0,i.useMemo)(()=>(c!==d.ob.PSP&&!(0,s.v_)({on:"payments_enable_psp_for_all_domains"})||"RUB"!==e)&&(0,l.V)(t,r,e,(0,a.getDomainConfig)().payments.xsollaEnabled)?d.ob.XSOLLA:d.ob.PSP,[t,r,e,c])}},25135:(e,t,r)=>{r.d(t,{l:()=>Or});var a=r(57627),s=r(87363),i=r.n(s),n=r(38225),o=r(4545),l=r(43774);const d="payments-popup";var c=r(14181),u=r(77314),h=r(55303),p=r(87437),v=r(37174),m=r(33376),g=r(21377),y=r(68207),f=r(44226),w=r(77671),b=r(27987),k=r(93335),A=r(80193),S=r(36240),P=r(67296),I=r(20966),T=r(97731);const E=(0,P.Z)((e,t,r)=>{return a=[e,t,r],s=function*(e,{developerPayload:t,id:r,mock:a,signed:s=!1,offerId:i,userDiscountId:n},o){try{const l=yield e.buyGameProduct({signed:s,id:r,mock:a,developerPayload:t,offerId:i,userDiscountId:n},o);if("error"in l)throw new Error(l.error);return l}catch(e){return(0,I.H)({block:T.W.PAYMENT,sourceMethod:"buyProduct",message:`${m.EW} buyProduct error`,type:"fetch"},e),{error:e.message,status:"failure"}}},new Promise((e,t)=>{var r=e=>{try{n(s.next(e))}catch(e){t(e)}},i=e=>{try{n(s.throw(e))}catch(e){t(e)}},n=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,i);n((s=s.apply(undefined,a)).next())});var a,s});var C=r(40497);var D=r(10452),R=r(19960),x=Object.defineProperty,_=Object.defineProperties,O=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,j=(e,t,r)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M=(e,t)=>{for(var r in t||(t={}))B.call(t,r)&&j(e,r,t[r]);if(L)for(var r of L(t))N.call(t,r)&&j(e,r,t[r]);return e},H=(e,t)=>_(e,O(t));const $={product:null,amountToBuy:0,isLoading:!1,isProductMockable:!1};function F(e,t){switch(t.type){case"SET_LOADING":return H(M({},e),{isLoading:t.payload});case"SET_PRODUCT_DATA":return H(M({},e),{product:t.payload.product,amountToBuy:t.payload.amountToBuy,isProductMockable:Boolean(t.payload.mockable)});case"RESET":return $;default:return e}}var W=r(50678),Z=r(69729),q=r(29276),G=r(63904),z=r.n(G),U=r(30928),V=r(19146),K=r(25963),Y=r(59962),X=r(87137),J=r(96533),Q=r(55468),ee=r(78825),te=r(81391),re=r(79092),ae=r(57847),se=r(2592),ie=r(87125),ne=r(99251),oe=r(53673),le=r(50337),de=Object.defineProperty,ce=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,he=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable,me=Math.pow,ge=(e,t,r)=>t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ye=(e,t)=>{for(var r in t||(t={}))pe.call(t,r)&&ge(e,r,t[r]);if(he)for(var r of he(t))ve.call(t,r)&&ge(e,r,t[r]);return e},fe=(e,t)=>ce(e,ue(t)),we=(e,t,r)=>(ge(e,"symbol"!=typeof t?t+"":t,r),r);const be=(0,ie.M$)("PurchaseIframeTemplate",ie.XG.Dev),ke=z().with("play-purchase-iframe"),Ae=()=>{let e=`${(0,ne.e)().origin}${window.YandexGamesSDK.baseUrl}/sdk/payments/trust-redirect.html`;return e=(0,te.EP)(e),e},Se=20*se.yR;class Pe extends W.P{constructor(e){super(e),we(this,"isIOSVersionLessThan14",!(0,Z.LR)(window.navigator.userAgent,Z.jj,{major:14,minor:0,patch:0})),we(this,"reachGoal"),we(this,"removeIframeID",e=>{const t=this.state.iframeIDs;delete t[e],this.setState({iframeIDs:ye({},t)})}),we(this,"setIframeError",(e,t)=>{const r=this.state.iframeIDs[e];this.setState(a=>({iframeIDs:fe(ye({},a.iframeIDs),{[e]:fe(ye({},r),{error:t||"UNKNOWN"})})}))}),we(this,"setIframeRef",e=>t=>{const r=this.state.iframeIDs[e];r&&!r.iframeElement&&this.setState(a=>({iframeIDs:fe(ye({},a.iframeIDs),{[e]:fe(ye({},r),{iframeElement:t})})}))}),this.state={iframeIDs:{},activeFrameID:""},this.reachGoal=(0,v.iF)(this)}componentDidMount(){window.addEventListener("message",this),this.create()}componentWillUnmount(){window.removeEventListener("message",this)}componentDidUpdate(e){const{amount:t,packId:r,price:a}=this.props;`${t}_${r}_${a}`!=`${e.amount}_${e.packId}_${e.price}`&&this.create()}handleEvent(e){if(!this.props.isValidEvent(e))return;const t=e.source,r=Object.values(this.state.iframeIDs).filter(e=>{var r;return(null==(r=e.iframeElement)?void 0:r.contentWindow)===t})[0],a=null==r?void 0:r.id;a?this.props.handleEvent(e,a,this):console.warn("Can not find promiseId for frame",Object.keys(this.state.iframeIDs),ye({},this.state.iframeIDs))}setHeight(e,t){const r=this.state.iframeIDs[e];this.setState(a=>({iframeIDs:fe(ye({},a.iframeIDs),{[e]:fe(ye({},r),{height:t})})})),ee.Z.post({type:"purchase-form",action:"on_resize"})}startPurchase(){ee.Z.post({type:"purchase-form",action:"before_submit"})}afterPurchase(){ee.Z.post({type:"purchase-form",action:"after_submit"})}setReadyState(e,t,r=0){const a=this.state.iframeIDs[e];a.setReadyStateTimeout&&window.clearTimeout(a.setReadyStateTimeout),a.setReadyStateTimeout=window.setTimeout(()=>{const r=this.state.iframeIDs[e];this.setState(a=>({iframeIDs:fe(ye({},a.iframeIDs),{[e]:fe(ye({},r),{isReady:t})})}))},r)}resolvePromise(e){const t=this.state.iframeIDs[e],{paymentService:r}=this.props;if(!t)return void Promise.reject(new Error("Can not find promise"));const{payCurrency:a,price:s,token:i}=t;if(t.inProgress)return void be(`resolve promise with ${i} already started`);const n=this.state.iframeIDs[e];if(this.setState(t=>({iframeIDs:fe(ye({},t.iframeIDs),{[e]:fe(ye({},n),{inProgress:!0})})})),be("resolve promise with token",i),!i){const r=new g.Z({code:"PAYMENT_FAILURE",message:"No trust token."});return this.setIframeError(t.id,null==r?void 0:r.code),void this.props.onReject(e,r)}r!==oe.ob.XSOLLA&&this.reachGoal(m.Ji.PURCHASES_PURCHASE_SUCCESS,{amount:this.props.value,auth:Boolean(this.props.userData.uid),dialog_type:this.props.dialogType,order_price:this.props.price,appId:this.props.gameId,payment_system:this.props.provider}),this.setReadyState(e,!1),this.props.setUserBalanceFetchingStatus(),function(e,t){const r=se.WT;let a=0;return new Promise((s,i)=>{function n(){be("checkPurchaseStatus"),e.getPurchaseStatus(t).then(e=>{"success"===e.status?s(e):"failure"===e.status?i(new g.Z({code:"PAYMENT_FAILURE",message:"Failure payment status."})):o()}).catch(o)}function o(){a+=1;const e=r*Math.ceil(me(1.4,Math.ceil(a/10)));a<100?setTimeout(n,e):i(new g.Z({code:"PAYMENT_FAILURE",message:"Can not get payment status."}))}n()})}(this.props.api,i).then(t=>{be("checkPurchaseStatus resolve with response",JSON.stringify(t,null,"\t")),this.props.onResolve(e,t,{balanceDiff:this.props.balanceDiff,price:this.state.iframeIDs[e].price}),t.status===oe.mv.SUCCESS&&(0,ae.i)({payCurrency:a,price:s},(0,q.u)()),this.removeIframeID(e)}).catch(t=>{this.setReadyState(e,!0),this.setIframeError(e,t.code),this.props.onReject(e,t),this.removeIframeID(e)})}rejectPromise(e,t){this.state.iframeIDs[e]?(this.setIframeError(e,null==t?void 0:t.code),this.props.onReject(e,t),this.removeIframeID(e)):Promise.reject(new Error("Can not find promise"))}create(){const{context:e}=this,{tld:t}=e,{amount:r,dialogType:a,email:s,packId:i,payCurrency:n,price:o,reason:l,paymentService:d}=this.props;be("BaseManager.create; packId, amount: ",i,r);const c=`${r}_${i}_${o}`,u=this.state.iframeIDs[c];if(u)return this.setState({activeFrameID:c}),void(Math.abs(Date.now()-u.timestamp)>=Se&&(this.props.onReject(c,new g.Z({code:"PAYMENT_FAILURE",message:"Purchase frame was expired"})),this.removeIframeID(c)));if(this.setState(e=>({activeFrameID:c,iframeIDs:fe(ye({},e.iframeIDs),{[c]:{payCurrency:n,price:o,inProgress:!1,id:c,src:"about:blank",token:"",dataAuth:"",timestamp:Date.now()}})})),!i&&!r)return void console.error("No pack or amount.");const h=ye(ye({devParams:{developer_payload:JSON.stringify({"css-theme":this.props.darkTheme?"blackAndWhite":"transparentAndWhite",template:"checkout"})},clid:(0,re.X)(),lang:e.lang,payCurrency:n,paymentService:d,platform:"desktop",reason:l,redirect:Ae()},i?{productId:i}:{}),r?{amount:r}:{});if(d===oe.ob.XSOLLA){const e=this.props.darkTheme?"default_dark":"default";h.paymentFormUiSettings={theme:e}}s&&(h.iGamesUserEmail=s),l===oe.YC.PURCHASE&&this.props.gameId&&(h.appId=parseInt(this.props.gameId,10)),be("createPurchase",JSON.stringify(h,null,"\t")),this.props.api.createPurchase(h).then(e=>{var r,a;if(e&&e.url&&e.token){const s=new URL(e.url);if(d===oe.ob.PSP&&!/^(.+\.){0,7}yandex\.(ru|by|kz|uk|uz|com|com\.tr)$/.test(s.host)){console.error("Bad Trust url",s.href);const r=K.A.includes(t)?t:"ru";s.host=`trust.yandex.${r}`,e.url=s.href}this.setState(t=>({iframeIDs:fe(ye({},t.iframeIDs),{[c]:{payCurrency:n,price:o,inProgress:!1,id:c,src:e.url,token:e.token,dataAuth:e.email?"false":"true",timestamp:Date.now()}})}));const{userData:i}=this.props;!e.email||i.uid&&i.email?ee.Z.post({type:"purchase-form",action:"auth"}):(ee.Z.post({type:"purchase-form",action:"lock_email",data:{email:e.email}}),null==(a=(r=this.props).onCreateIFrame)||a.call(r,e.email))}else this.setIframeError(c,"REQUEST_FAILURE"),this.props.onReject(c,new g.Z({code:"PAYMENT_FAILURE",message:"Can not get payment URL."})),this.removeIframeID(c)}).catch(e=>{this.reachGoal(m.Ji.PURCHASES_PURCHASE_PAYMENT_SYSTEM_LOAD_ERROR,{auth:Boolean(this.props.userData.uid),dialog_type:a,message:e.message,appId:this.props.gameId,payment_system:this.props.provider}),(0,Q.f1)(e)?this.setIframeError(c,"UNAUTHORIZED"):this.setIframeError(c,"REQUEST_FAILURE"),this.props.onReject(c,e),this.removeIframeID(c)})}render(){const{iframeIDs:e,activeFrameID:t}=this.state,{isInvisible:r,fullScreen:s,getText:i,hasSmallSpinWithText:n}=this.props,o=Object.values(e),{isIOS:l}=(0,le.AK)(this.context.platform);return o.map(e=>{const o=e.isReady,d=e.id===t;return(0,a.jsxs)("div",{className:ke({"state-ready":e.isReady,"full-screen":Boolean(s),hidden:!d||r,"ios-safari":this.context.isSafari&&l,"ios-less-14":l&&this.isIOSVersionLessThan14}),style:{height:e.height?`${e.height}px`:"auto"},children:[(0,a.jsx)("div",{className:ke("holder"),children:(0,a.jsx)("iframe",fe(ye({className:ke("frame")},d&&{"data-active-iframe":""}),{"data-auth":e.dataAuth,"data-token":e.token,ref:this.setIframeRef(e.id),sandbox:"allow-popups allow-forms allow-scripts allow-same-origin allow-top-navigation-by-user-activation",src:e.src}))}),!o&&(0,a.jsx)("div",{className:ke("spin-wrapper"),children:n?(0,a.jsx)(b.y,{size:32,spinning:!0,text:e.setReadyStateTimeout?i("spin.wait"):i("spin.loading")}):(0,a.jsx)(b.y,{size:76,spinning:!0})})]},e.id)})}}const Ie=(0,U.$j)(function(e){return{api:(0,Y.Z)(e.apiData),darkTheme:(0,J.Up)(e),userData:e.userData,getText:e.getText,partnerEventsLogParams:(0,X.GA)(e)}},function(e){return(0,V.DE)({setUserBalanceFetchingStatus:y.k1},e)})(Pe);var Te=Object.defineProperty,Ee=Object.defineProperties,Ce=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,Re=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,_e=(e,t,r)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class Oe extends W.P{constructor(){var e;super(...arguments),_e(this,"symbol"!=typeof(e="handleEvent")?e+"":e,(e,t,r)=>{const{type:a,data:s={}}=e.data,{shouldWaitIframeButtonClick:i=!0,onStarted:n}=this.props,o=(e,a)=>{(0,I.H)({block:T.W.TRUST,message:`[Payment Trust] ${a||e}`}),r.rejectPromise(t,new g.Z({code:"PAYMENT_FAILURE",message:e}))};switch(be(`Handle trust event '${a}'`,JSON.stringify(e.data,null,"\t")),a){case"on_resize":r.setHeight(t,e.data.data.height);break;case"form-submit":null==n||n();break;case"trust-challenge-end":if(i)return;s.success?r.resolvePromise(t):o("Payment fail.","Fail");break;case"before_submit":r.startPurchase();break;case"payment-loaded":r.setReadyState(t,!0,150);break;case"frame-error":o("Frame error.");break;case"payment-status":"success"===s.value&&r.resolvePromise(t);break;case"payment-complete":"success"===s.status&&r.resolvePromise(t);break;case"payment-check-failure":o("Payment check failure.","Check failure");break;case"payment-update-failure":o("Payment update failure.","Update failure");break;case"payment-fail":o("Payment fail.","Fail");break;case"payment-timeout":{const e=new g.Z({code:"PAYMENT_TIMEOUT",message:"Payment timeout."});r.rejectPromise(t,e);break}case"3ds-status":"3ds-success"===s?r.resolvePromise(t):"3ds-failure"===s&&o("Payment 3ds failure.","3ds failure");break;case"redirect-callback":r.resolvePromise(t);break;case"sbp-bank-selected":window.open(s,"_self")}})}isValidEvent(e){return t=e.origin,!!/^https:\/\/(.+\.){0,7}yandex\.(ru|by|kz|uk|uz|com|com\.tr)(:\d+)?$/.test(t)&&!(!e.data||"YandexTrustPaymentForm"!==e.data.source);var t}render(){const{props:e}=this;return(0,a.jsx)(Ie,((e,t)=>Ee(e,Ce(t)))(((e,t)=>{for(var r in t||(t={}))Re.call(t,r)&&_e(e,r,t[r]);if(De)for(var r of De(t))xe.call(t,r)&&_e(e,r,t[r]);return e})({},e),{handleEvent:this.handleEvent,isValidEvent:this.isValidEvent,provider:oe.qY.TRUST}))}}var Le=r(3891),Be=Object.defineProperty,Ne=Object.defineProperties,je=Object.getOwnPropertyDescriptors,Me=Object.getOwnPropertySymbols,He=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable,Fe=(e,t,r)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,We=(e,t,r)=>(Fe(e,"symbol"!=typeof t?t+"":t,r),r);class Ze extends W.P{constructor(){super(...arguments),We(this,"resolveTimeoutId"),We(this,"handleEvent",(e,t,r)=>{let a;try{a=JSON.parse(e.data)}catch(t){return void(0,I.H)({block:T.W.XSOLLA,message:"[Payment Xsolla] Error while attempting to parse Xsolla data",additional:{data:e.data}},t)}switch(null==a?void 0:a.action){case"resize":return void r.setHeight(t,a.height);case"finish":const e=new g.Z({code:"PAYMENT_FAILURE",message:"Payment cancelled."});return(0,I.H)({block:T.W.XSOLLA,message:"[Payment Xsolla] Cancelled"}),void r.rejectPromise(t,e)}switch(null==a?void 0:a.command){case"open-paystation":return void r.setReadyState(t,!0,150);case"resize":return void r.setHeight(t,a.data.dimensions.height);case"change-status":switch(a.data.value){case"done":return void(this.resolveTimeoutId=window.setTimeout(()=>{delete this.resolveTimeoutId,r.resolvePromise(t)},2e3));case"processing":return void r.startPurchase();case"canceled":return(0,I.H)({block:T.W.XSOLLA,message:"[Payment Xsolla] Declined"}),void r.afterPurchase()}}})}isValidEvent(e){return(0,Le.W)(e.origin)}render(){const{props:e}=this;return(0,a.jsx)(Ie,((e,t)=>Ne(e,je(t)))(((e,t)=>{for(var r in t||(t={}))He.call(t,r)&&Fe(e,r,t[r]);if(Me)for(var r of Me(t))$e.call(t,r)&&Fe(e,r,t[r]);return e})({},e),{handleEvent:this.handleEvent,isValidEvent:this.isValidEvent,provider:oe.qY.XSOLLA}))}}var qe=r(1285),Ge=r(39138),ze=r(4522),Ue=r(20504);const Ve=({amount:e,bounty:t=0,checked:r,currency:i,isBestseller:n,name:o,price:l,value:d,onChange:c})=>{const h=(0,Ge.T)(),{lang:p}=(0,u.b)(),v=Math.ceil(t/e*100),[m,g]=(0,s.useMemo)(()=>{let r=t>0?l+t/e*l:0,a=!1;const s=function(e){const t=e.toString(),r=t.indexOf(".");return-1===r?0:t.length-r-1}(l);return l>10&&s>=1&&(a=!0),(l>10&&s>=2||l>100&&s>=1)&&(r=Math.round(r)),[r,a]},[e,t,l]);return(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{checked:r,className:"CurrencyPack-module__input--n0ykh",name:o,type:"radio",value:d,onChange:c}),(0,a.jsxs)("div",{className:(0,ze.E)("CurrencyPack-module__pack--HKw6U",r?"CurrencyPack-module__checked--JgyM_":void 0),children:[(0,a.jsx)(qe.Z,{amount:(0,Ue.l)(e+t,!0),size:16,withIcon:!0}),n&&(0,a.jsx)("div",{className:"CurrencyPack-module__bestseller--jlUGw",children:h("currency-pack.bestseller")}),v>0&&(0,a.jsx)("div",{className:"CurrencyPack-module__discount--id1f8",children:`âˆ’${v}%`}),(0,a.jsxs)("div",{className:"CurrencyPack-module__bottom--dFUEy",children:[(0,a.jsx)("div",{className:"CurrencyPack-module__price--SNCWU",children:(0,f.k_)(l,i,p)}),(0,a.jsx)("div",{className:(0,ze.E)("CurrencyPack-module__oldPrice--tHYlA",g?"CurrencyPack-module__smallOldPrice--f7hdS":void 0),children:m>0?(0,f.k_)(m,i,p):null})]})]})]})};var Ke=r(95100),Ye=r(47587);const Xe="Carousel-critical-module__arrowButton--G2cjW",Je="Carousel-critical-module__arrowButtonRow--cvZ3F",Qe="Carousel-critical-module__arrowButtonColumn--WdStc";function et(e,t,r){return"vertical"!==e&&r?"prev"===t?"right":"left":"prev"===t?"left":"right"}const tt={32:"Carousel-critical-module__arrowButton32--O9VWb",40:"Carousel-critical-module__arrowButton40--aoDQn"},rt=({arrowsSize:e=32,direction:t,hasArrowsTopOffset:r,loop:i=!1,mix:n,onNext:o,onPrev:l,sliderInstance:d})=>{const{rtl:c}=(0,u.b)(),[h,p]=(0,s.useState)(i),[v,m]=(0,s.useState)(i),g=(0,Ge.T)();(0,s.useEffect)(()=>{if(!d.current)return;const e=d.current,t=e=>{i||(p(e.track.details.abs>0),m(e.track.details.abs!==e.track.details.maxIdx))};return t(e),e.on("detailsChanged",t),()=>{e.on("detailsChanged",t,!0)}},[i,d]);const y=et(t,"prev",c),f=et(t,"next",c);return(0,a.jsxs)(a.Fragment,{children:[h&&(0,a.jsx)(Ye.Q,{alt:g(`common.scroll.${y}`),className:(0,ze.E)(Xe,r&&"arrowTopOffset",tt[e],"Carousel-critical-module__arrowPrev--p733k","vertical"===t?Qe:Je,null==n?void 0:n.prev),"data-testid":"carousel-button-prev",direction:y,onClick:l}),v&&(0,a.jsx)(Ye.Q,{alt:g(`common.scroll.${f}`),className:(0,ze.E)(Xe,r&&"arrowTopOffset",tt[e],"Carousel-critical-module__arrowNext--Srzzg","vertical"===t?Qe:Je,null==n?void 0:n.next),"data-testid":"carousel-button-next",direction:f,onClick:o})]})},at=8*se.WT,st="autoSwitchPause",it="autoSwitchResume",nt=(0,s.forwardRef)(({children:e,className:t},r)=>(0,a.jsx)("div",{className:(0,ze.E)("keen-slider__slide",t),ref:r,children:e})),ot=e=>{let t,r,a;function s(t,a){r.x-=t.deltaX/2,r.y-=t.deltaY/2,e.container.dispatchEvent(new CustomEvent(a,{detail:{x:r.x,y:r.y}}))}function i(i){const n=0===i.deltaX||Math.abs(i.deltaX/i.deltaY)<.1;e.options.vertical===n&&(i.preventDefault(),a||(a=!0,r={x:i.pageX,y:i.pageY},s(i,"ksDragStart")),s(i,"ksDrag"),window.clearTimeout(t),t=window.setTimeout(()=>{a=!1,s(i,"ksDragEnd")},200))}e.on("created",()=>{e.container.addEventListener("wheel",i,{passive:!1})}),e.on("destroyed",()=>{e.container.removeEventListener("wheel",i)})};var lt=r(73520),dt=r(98307),ct=r(34589),ut=r(95663),ht=r(24046);const pt="carouselInit",vt=(e,t)=>{if(null===e)return t;const r=e.options.slides;return"object"==typeof r&&"number"==typeof(null==r?void 0:r.perView)?r.perView:t},mt=(0,s.createContext)(void 0),gt=(0,s.forwardRef)(({arrowsSize:e=32,autoSwitch:t=!1,autoSwitchTimeoutMs:r,breakpoints:n,clickDaemonParams:o,children:l,className:d,direction:c="vertical",disableScrollLog:h=!1,drag:p=!0,hasArrowsTopOffset:v,loop:m=!1,mix:g,mode:y="free-snap",onAnimationEnded:f,onAnimationStarted:w,onAnimationStopped:b,onDragEnded:k,onDragStarted:A,onItemActive:S,onNextClick:P,onPrevClick:I,onSlideChanged:T,renderMode:E="precision",slidesPerView:C=3,spaceBetween:D=16,withArrows:R=!0,wrapperClassName:x,wrapperRef:_},O)=>{const L=void 0!==o,B=(0,dt.l)(o||{}),N=(0,ct.$)(o),{rtl:j}=(0,u.b)(),[M,H]=(0,s.useState)(0),$=(0,s.useRef)(null),F=_||$,W=(0,ut.f)(),Z=(0,s.useRef)(!1),q=(0,s.useMemo)(()=>{const e=[ot];return t&&e.push((e=>{const t=null!=e?e:at;return e=>{let r,a=!1,s=t,i=Date.now();function n(){window.clearTimeout(r)}function o(){n(),a||(i=Date.now(),s=t,r=window.setTimeout(()=>{e.next()},t))}function l(){a||(a=!0,s=Math.max(0,s-(Date.now()-i)),n())}function d(){a&&(a=!1,i=Date.now(),r=window.setTimeout(()=>{e.next()},s))}e.on("created",()=>{o(),e.container.addEventListener(st,l),e.container.addEventListener(it,d)}),e.on("dragStarted",n),e.on("animationEnded",o),e.on("updated",o),e.on("destroyed",()=>{n(),e.container.removeEventListener(st,l),e.container.removeEventListener(it,d)})}})(r)),e},[t,r]),[G,z]=(0,Ke.E)({breakpoints:n,drag:p,vertical:"vertical"===c,slides:{perView:C,spacing:D},renderMode:E,loop:m,mode:y,rtl:"horizontal"===c&&j,rubberband:!1,slideChanged:()=>{L&&!h&&B()},dragStarted:()=>{L&&(Z.current=!0),null==A||A()},dragEnded:()=>{L&&(Z.current=!1),null==k||k()},animationStarted:()=>{null==w||w()},animationEnded:()=>{var e;null==(e=F.current)||e.dispatchEvent(new CustomEvent("horizontalScroll")),L&&(Z.current=!1),null==f||f()},animationStopped:()=>{null==b||b()}},q);(0,s.useImperativeHandle)(O,()=>({prev:()=>{var e;return null==(e=z.current)?void 0:e.prev()},next:()=>{var e;return null==(e=z.current)?void 0:e.next()}}),[z]),(0,s.useEffect)(()=>{var e;null==(e=z.current)||e.update()},[l,z]);const U=(0,s.useRef)(vt(z.current,"auto"===C?1:C));(0,s.useEffect)(()=>{if(!F.current)return;const e=new ResizeObserver(()=>{var e;null==(e=z.current)||e.update(),U.current=vt(z.current,"auto"===C?1:C)});return e.observe(F.current),()=>{e.disconnect()}},[C,z,F]),(0,s.useEffect)(()=>{if(z.current){if(!z.current.track.details||"auto"===C)return;const e=(M-z.current.track.details.abs)%C,t=0===e;e===C-1&&z.current.next(),t&&z.current.prev()}null==S||S(M)},[M,S,C,z]),(0,s.useEffect)(()=>{if(!z.current)return;const e=z.current,t=e=>{var t;const{slides:r}=e;r.forEach((e,t)=>{e.addEventListener("click",()=>{H(t)})}),null==(t=F.current)||t.classList.remove(pt)};return t(e),e.on("created",t),()=>{e.on("created",t,!0)}},[z,F]),(0,s.useEffect)(()=>{if(!z.current||!T)return;const e=z.current,t=i().Children.count(l),r=()=>{var r,a;const s=null!=(a=null==(r=e.track.details)?void 0:r.abs)?a:0;T(m?(s%t+t)%t:s)};return e.on("slideChanged",r),()=>{e.on("slideChanged",r,!0)}},[z,T,m,l]);const V=(0,s.useCallback)(e=>{e.stopPropagation();const t=z.current;if(t){if(L&&N({action:{name:lt.C.CLICK}},{block:ht.Q.CAROUSEL,item:(null==o?void 0:o.item)||"block",elem:"carousel_prev"}),"auto"===C){const e=t.track.details.slides;let r=e.findIndex(e=>e.distance>0),a=0;do{a+=e[--r].size}while(r>0&&a<1);t.moveToIdx(r)}else{const e=vt(t,C),r=t.track.details.abs;if(m){const a=i().Children.count(l),s=(r-Math.floor(e))%a,n=s<0?s+a:s;t.moveToIdx(n)}else{const a=r-Math.floor(e),s=t.track.details.minIdx,i=Math.max(a,s);t.moveToIdx(i)}}null==I||I()}},[l,m,I,N,L,z,C,o]),K=(0,s.useCallback)(e=>{e.stopPropagation();const t=z.current;if(t){if(L&&N({action:{name:lt.C.CLICK}},{block:ht.Q.CAROUSEL,item:(null==o?void 0:o.item)||"block",elem:"carousel_next"}),"auto"===C){const e=t.track.details.slides.findIndex(e=>e.distance>0&&e.portion<.95);t.moveToIdx(Math.min(e,t.track.details.maxIdx))}else{const e=vt(t,C),r=t.track.details.abs;if(m){const a=i().Children.count(l),s=(r+Math.floor(e))%a;t.moveToIdx(s)}else{const a=r+Math.floor(e),s=t.track.details.maxIdx,i=Math.min(a,s);t.moveToIdx(i)}}null==P||P()}},[l,m,P,N,L,z,C,o]),Y=(0,s.useMemo)(()=>"auto"!==C?l:i().Children.map(l,e=>(0,a.jsx)(nt,{className:"Carousel-critical-module__autoSlide--TeQvE",children:e})),[l,C]);return(0,a.jsxs)("div",{className:(0,ze.E)("Carousel-critical-module__wrapper--dfc7_",W?void 0:pt,x),ref:F,style:{"--carousel-spacing":`${D}px`,"--carousel-slides-per-view":C},children:[(0,a.jsx)("div",{className:(0,ze.E)("keen-slider","Carousel-critical-module__slider--vAvB8","horizontal"===c?"Carousel-critical-module__horizontal--IKPpl":void 0,d),ref:G,children:(0,a.jsx)(mt.Provider,{value:{carouselSize:U.current},children:Y})}),R&&(0,a.jsx)(rt,{arrowsSize:e,direction:c,hasArrowsTopOffset:v,loop:m,mix:null==g?void 0:g.arrows,sliderInstance:z,onNext:K,onPrev:V})]})});gt.displayName="Carousel";const yt=gt,ft=({children:e})=>(0,l.v_)({off:"payments_partner_special_offer"})?e:(0,a.jsx)(yt,{direction:"horizontal",slidesPerView:"auto",spaceBetween:8,withArrows:!0,children:e});var wt=r(69005);const bt=({className:e,currencyPacks:t,onChange:r})=>{const n=(0,Ge.T)(),o=n("currency-pack.description",{params:{currency:n("payments.currencies",{number:1})}}).split("{bold}"),[l,d]=i().useState((null==t?void 0:t[0])||null);(0,s.useEffect)(()=>{d((null==t?void 0:t[0])||null)},[t]);const c=(0,s.useCallback)(e=>{const r=e.target.value,a=(null==t?void 0:t.find(e=>e.productId===r))||null;d(a)},[t]);if((0,s.useEffect)(()=>{r(l)},[l,r]),null==t?void 0:t.length)return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,ze.E)("CurrencyPacks-module__description--YM7rL",e),children:[(0,a.jsx)(wt.Z,{size:16}),o[0],(0,a.jsx)("b",{children:o[1]})]}),(0,a.jsx)("div",{className:(0,ze.E)("CurrencyPacks-module__packs--vwhRs",e),children:(0,a.jsx)(ft,{children:null==t?void 0:t.map(e=>{const{extraInfo:t,productId:r,isBestSeller:s}=e,{amount:i}=t;return(0,a.jsx)(Ve,{amount:i.real,bounty:i.bounty,checked:e===l,currency:t.currency,isBestseller:s,name:r,price:(0,f.OO)(t.price[t.currency]),value:r,onChange:c},r)})})})]})};var kt=r(36329),At=r(56053);const St=e=>{const[t,r]=(0,s.useState)(e),a=(0,s.useRef)(void 0),i=(0,s.useRef)(!0),n=(0,s.useCallback)((e,t)=>{a.current=t,r(e)},[]);return(0,s.useEffect)(()=>{var e;i.current?i.current=!1:null==(e=a.current)||e.call(a,t)},[t]),[t,n]};var Pt=r(19544),It=r(29513);const Tt=e=>It.CU.test(e),Et=({amount:e,className:t,currency:r,initialEmail:i,onConfirmClick:o,isFormDisabled:l,isTestPurchaseCheckboxChecked:d})=>{const c=(0,Ge.T)(),{lang:h}=(0,u.b)(),p=(0,s.useRef)(null),v=(0,n.C)(e=>Boolean(e.userData.login)),m=(0,n.C)(e=>e.ui.isFullscreenActive),[g,y]=(0,s.useState)(null!=i?i:""),[w,b]=(0,s.useState)(void 0),[k,A]=St(!1),[S,P]=(0,s.useState)(),I=(0,s.useMemo)(()=>!v&&e>0,[v,e]);(0,s.useEffect)(()=>{g.length?Tt(g)?(b("correct"),P(void 0)):b("warning"):b(void 0)},[g]),(0,s.useEffect)(()=>{i&&y(i)},[i]);const T=(0,s.useCallback)(e=>{m&&Tt(g)&&A(!0),P(void 0)},[m,A,g]),E=(0,s.useCallback)(e=>y(e.target.value),[]),C=(0,s.useCallback)(()=>{var e;!I||g.length&&"warning"!==w?((0,Pt.i)(),P(void 0),null==(e=p.current)||e.blur(),o(g)):P(c("payments.invalid-email-warning"))},[g,c,w,I,o]),D=(0,s.useCallback)(e=>{e.preventDefault(),C()},[C]),R=(0,s.useCallback)(()=>{A(!1,()=>{var e;return null==(e=p.current)?void 0:e.focus()})},[A]),x=(0,s.useMemo)(()=>l?c("in-app-payments.payment.method"):0===e||d?c("payments.buy"):c("payments.pay",{params:{price:(0,f.T4)(e,r,h)}}),[l,c,e,r,h,d]);return(0,a.jsx)("div",{className:t,"data-testid":"payment-confirm-form",children:(0,a.jsxs)("form",{onSubmit:D,children:[I&&(0,a.jsxs)(a.Fragment,{children:[m&&k&&(0,a.jsx)("div",{className:"PaymentConfirmForm-module__editButtonWrapper--xbhND",children:(0,a.jsx)(kt.z,{size:24,type:"button",view:"empty",onClick:R,children:c("payments.edit")})}),(0,a.jsx)(At.I,{autoComplete:"email","data-testid":"payment-form-email-input",disabled:k||l,errorMessage:S,errorMessageClassName:"PaymentConfirmForm-module__emailLabel--mMY1A",hasIcon:Boolean(w),maxLength:It.bV,placeholder:c("payments.email-input-placeholder"),ref:p,size:40,state:w,type:"email",value:g,onBlur:T,onChange:E})]}),(0,a.jsx)("div",{className:I?"PaymentConfirmForm-module__confirmButtonWrapper--SivgC":"",children:(0,a.jsx)(kt.z,{"data-testid":"payment-form-pay-button",disabled:l,size:40,view:"primary",width:"max",children:x})})]})})},Ct="InAppPayments-module__sectionWithPadding--C9nxU",Dt="InAppPayments-module__sectionWithMargin--MGANx",Rt="InAppPayments-module__paymentsStateWrapper--TLCL8";var xt=r(99654);const _t="PaymentsHeader-module__secondary-text--dAxIj";var Ot=r(13466),Lt=r(65745);const Bt=({className:e})=>{const t=(0,Ge.T)(),r=(0,n.C)(e=>{var t;return null!=(t=e.user.balance.value)?t:0});return(0,a.jsxs)("div",{className:(0,ze.E)("PaymentsHeader-module__payments-header--NjXGA",e),"data-testid":"payments-header",children:[(0,a.jsx)("div",{className:"PaymentsHeader-module__logo-with-button--gUEYe",children:(0,a.jsx)(Ot.Z,{type:Lt.q7.PAYMENTS})}),(0,a.jsxs)("div",{className:"PaymentsHeader-module__yans-amount--ge_eY","data-testid":"payment-form-yans-amount",children:[(0,a.jsx)("span",{className:_t,children:t("payments.you_have")}),(0,a.jsx)(qe.Z,{amount:r,size:14,withIcon:!0}),(0,a.jsx)("span",{className:_t,children:t("payments.currency",{number:r}).toLowerCase()})]})]})},Nt=({children:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Bt,{className:Ct}),e,(0,a.jsx)(xt.Z,{className:Ct})]}),jt=({className:e,email:t,onCancel:r,onApprove:i})=>{const n=(0,Ge.T)(),o=(0,s.useCallback)(()=>{i(t)},[i,t]);return(0,a.jsxs)("div",{className:e,"data-testid":"payments-approve-state",children:[(0,a.jsx)("div",{className:"payment-approve-state-module__main--v60c4",children:(0,a.jsxs)("div",{className:"payment-approve-state-module__content--rfvLD",children:[(0,a.jsx)("div",{className:"payment-approve-state-module__icon--ce57o",children:(0,a.jsx)("div",{className:"payment-approve-state-module__iconImage--MxYFa"})}),(0,a.jsx)("div",{className:"payment-approve-state-module__text--mcGRe",children:n("payments.approve.question")})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"payment-approve-state-module__buttonApprove--ugOgW",children:(0,a.jsx)(kt.z,{size:40,type:"submit",view:"primary",width:"max",onClick:o,children:n("payments.approve.confirm")})}),(0,a.jsx)("div",{children:(0,a.jsx)(kt.z,{size:40,type:"submit",view:"secondary",width:"max",onClick:r,children:n("payments.approve.cancel")})})]})]})};var Mt=r(55990);var Ht=(e=>(e.COMMON="common",e.PRODUCT_LOAD_FAILED="product_load_failed",e))(Ht||{});const $t=({onActionClick:e,reason:t,className:r})=>{const i=(0,Ge.T)(),{title:n,description:o,withRetry:l}=function(e,t){return"product_load_failed"===t?{title:e("payments.product-load-failed-title"),description:e("payments.product-load-failed-description"),withRetry:!1}:{title:e("payments.purchase-failed-title"),description:e("payments.purchase-failed-description"),withRetry:!0}}(i,t),d=(0,s.useCallback)(()=>{e(l)},[l,e]);return(0,a.jsxs)("div",{className:(0,ze.E)("payment-failed-state-module__container--rQIq_",r),"data-testid":"payments-failed-state",children:[(0,a.jsx)(Mt.Z,{type:"failed"}),(0,a.jsx)("span",{className:"payment-failed-state-module__title--im0Dx",children:n}),(0,a.jsx)("span",{className:"payment-failed-state-module__description--B0LJg",children:o}),(0,a.jsx)(kt.z,{size:40,view:"primary",width:"max",onClick:d,children:i(l?"payments.try-again":"payments.close-modal")})]})};var Ft=(e=>(e.AVAILABLE_PROMOCODE="available_promocode",e.CLIENT_OFFER_APPLIED="client_offer_applied",e.PURCHASE_SUCCESS="purchase_success",e.PURCHASE_SUCCESS_WITH_CLIENT_OFFER="purchase_success_with_client_offer",e.PURCHASE_SUCCESS_WITH_PARTNER_OFFER="purchase_success_with_partner_offer",e))(Ft||{});const Wt=e=>{if(!e)return"";const t=e.toLowerCase();return`${t.slice(0,10)}\n${t.slice(10)}\n`},Zt=({className:e,scenario:t,onActionClick:r,email:s,isLogin:i})=>{const n=(0,Ge.T)(),{title:o,description:l,buttonText:d,iconType:c}=((e,t,r)=>{switch(e.type){case"client_offer_applied":return{title:r("payment-success.client-offer-applied.title"),description:r("payment-success.client-offer-applied.description"),buttonText:r("payment-success.client-offer-applied.button-text"),iconType:"soon-balance"};case"purchase_success_with_client_offer":return{title:r("payments.succeed-with-offer-title"),description:r(t.isLogin?"payments.succeed-with-offer-description":"payment-success.non-logged-in-client-offer.description"),buttonText:r(t.isLogin?"payments.return-to-game":"payment-success.non-logged-in-client-offer.button-text"),iconType:"done"};case"purchase_success_with_partner_offer":return{title:r("payments.succeed-with-offer-title"),description:null,buttonText:r("payments.return-to-game"),iconType:"done"};case"available_promocode":return{title:r("payment-success.promocode.title"),description:r("payment-success.promocode.description"),buttonText:r("payment-success.promocode.button-text"),iconType:"discount"};case"purchase_success":return{title:r("payments.purchase-complete-title"),description:t.isLogin?null:r("payments.purchase-complete-description",{params:{email:t.email,recoveryCode:Wt(e.recoveryCode)}}),buttonText:r("payments.return-to-game"),iconType:"done"};default:return{title:r("payments.purchase-complete-title"),description:null,buttonText:r("payments.return-to-game"),iconType:"done"}}})(t,{email:s,isLogin:i},n);return(0,a.jsxs)("div",{className:(0,ze.E)(e,"payment-success-state-module__container--yo5D0"),"data-testid":"payments-success-state",children:[(0,a.jsx)(Mt.Z,{className:"payment-success-state-module__successIcon--CNoqe",type:c}),(0,a.jsxs)("div",{className:"payment-success-state-module__infoContainer--EeQFK",children:[(0,a.jsx)("span",{className:"payment-success-state-module__title--zgPvb",children:o}),l&&(0,a.jsx)("span",{className:"payment-success-state-module__description--HhDJi",children:l})]}),(0,a.jsx)(kt.z,{className:"payment-success-state-module__button--Z514X",size:40,type:"submit",view:"primary",width:"max",onClick:r,children:d})]})};var qt=r(10796),Gt=r(7628),zt=r(61161);const Ut={productCard:"product-card-module__productCard--X0L6y",productInfo:"product-card-module__productInfo--u6iNP",productImage:"product-card-module__productImage--jHaIi",productTitle:"product-card-module__productTitle--AXWmj",productText:"product-card-module__productText--MrYzN",gift:"product-card-module__gift--OFAu3"},Vt=({className:e,image:t,title:r,textClassname:s,description:i,dataTestId:n="product-card",tooltipDescription:o,variant:l="default"})=>{const d="default"!==l?Ut[l]:"";return(0,a.jsxs)("div",{className:(0,ze.E)(Ut.productCard,d,e),"data-testid":n,children:[(0,a.jsx)(zt.Z,{alt:"",className:Ut.productImage,src:t}),(0,a.jsxs)("div",{className:Ut.productInfo,children:[(0,a.jsx)("h5",{className:Ut.productTitle,title:r,children:r}),(0,a.jsx)("p",{className:(0,ze.E)(Ut.productText,s),title:i,children:i})]}),o&&(0,a.jsx)(Gt.L,{tooltipDescription:o})]})},Kt="product-price-info-module__text--x0TRd",Yt=({price:e,dataTestId:t="product-price-info",title:r,description:i,discountPrice:n,onCollapseInfo:o})=>{const[l,d]=St(!0),c=(0,s.useCallback)(()=>d(!l,e=>"boolean"==typeof e&&(null==o?void 0:o(e))),[d,l,o]),u=l?"arrow-down":"arrow-pointer";return(0,a.jsxs)("div",{className:"product-price-info-module__productPriceInfo--yE0Zj","data-testid":t,onClick:c,children:[(0,a.jsxs)("div",{children:[n?(0,a.jsxs)("div",{children:[(0,a.jsx)(qe.Z,{amount:n,size:20,withIcon:!0}),(0,a.jsx)("span",{className:"product-price-info-module__realPrice--v1yh1",children:e})]}):(0,a.jsx)(qe.Z,{amount:e,size:15,withIcon:!0}),(0,a.jsx)("p",{className:Kt,children:r}),!l&&(0,a.jsx)("p",{className:(0,ze.E)(Kt,"product-price-info-module__descriptionText--eyApw"),"data-testid":`${t}-description`,children:i})]}),(0,a.jsx)(Mt.Z,{className:"product-price-info-module__toggleIcon--MRJy7",size:"xs",type:u})]})},Xt=({title:e,imageURL:t,label:r,className:s})=>(0,a.jsxs)("div",{className:(0,ze.E)("gift-card-module__giftCardWrapper--gVX0N",s),"data-testid":"gift-card",children:[(0,a.jsx)(zt.Z,{className:"gift-card-module__giftImage--NJNE9",src:`${t}/default192x192`}),(0,a.jsx)("p",{className:"gift-card-module__giftTitle--U2Tft",children:e}),(0,a.jsxs)("div",{className:"gift-card-module__giftBadgeContainer--k1KOP",children:[(0,a.jsx)("div",{className:"gift-card-module__badge--imQ4k"}),(0,a.jsx)("span",{className:"gift-card-module__badgeText--jRkd6",children:r})]})]}),Jt=({title:e,imageURL:t,description:r,label:s})=>(0,a.jsx)(Vt,{dataTestId:"inline-gift-card",description:s,image:`${t}/default192x192`,title:e,tooltipDescription:r,variant:"gift"}),Qt=({title:e,giftPack:t,cardView:r=!1})=>{const s=(0,Ge.T)();return t?(0,a.jsxs)("div",{className:"client-gift-list-module__listWrapper--HNpYL","data-testid":"gift-list",children:[e&&(0,a.jsx)("span",{className:"client-gift-list-module__title--jV0Uo",children:e}),(0,a.jsx)("div",{className:r?"client-gift-list-module__cardGiftsContainer--EwngT":"",children:t.products.map(({icon:e,id:t,title:i,description:n})=>r?(0,a.jsx)(Xt,{imageURL:e.urlPrefix,label:s("gift-card.gift-label"),title:i},t):(0,a.jsx)(Jt,{description:n,imageURL:e.urlPrefix,label:s("payments.gift-description"),title:i},t))})]}):null};var er=r(79332),tr=r(46207),rr=r(15292),ar=r(76753),sr=r(38207),ir=Object.defineProperty,nr=Object.defineProperties,or=Object.getOwnPropertyDescriptors,lr=Object.getOwnPropertySymbols,dr=Object.prototype.hasOwnProperty,cr=Object.prototype.propertyIsEnumerable,ur=(e,t,r)=>t in e?ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hr=(e,t)=>{for(var r in t||(t={}))dr.call(t,r)&&ur(e,r,t[r]);if(lr)for(var r of lr(t))cr.call(t,r)&&ur(e,r,t[r]);return e},pr=(e,t)=>nr(e,or(t));let vr;function mr(e,t){return t-Number(e.priceValue)>=0}vr=r(45758).Z;const gr=(0,s.memo)(({config:{developerPayload:e,lang:t,productId:r,signed:i},gameInfo:o,hasInitialLoader:d,onPurchaseFailed:h,onConfirmSuccessPurchase:P,onPurchaseSuccess:x,onClosePaymentModal:_})=>{const{lang:O,playPageData:L,abt:B}=(0,u.b)(),N=(0,C.z)(),j=(0,Ge.T)(),W=(0,n.T)(),Z=(0,sr.ff)(),q=(0,er.U)(),{value:G=0,fetching:z,fetchedTimestamp:U}=(0,n.C)(e=>e.user.balance),V=(0,n.C)(e=>e.user.payCurrency),K=(0,n.C)(e=>e.userData),Y=U>0,{amountToBuy:X,loadProduct:J,product:Q,isLoading:ee,isProductMockable:te}=(()=>{const e=(0,C.z)(),[t,r]=(0,s.useReducer)(F,$),{isProductMockable:a,isLoading:i,amountToBuy:n,product:o}=t,l=(0,s.useCallback)(t=>{return a=function*(){r({type:"SET_LOADING",payload:!0});try{const{amountToBuy:a,product:s,mockable:i}=yield e.getGameProductById(H(M({},t),{draft:(0,R.m)(),with_amount_to_buy:!0}));(0,A.q)("Fetched product",s);const n=new D.Z(s);return(0,A.q)("is shown with productData:",n),r({type:"SET_PRODUCT_DATA",payload:{product:n,amountToBuy:a,mockable:i}}),{product:s}}catch(e){throw e}finally{r({type:"SET_LOADING",payload:!1})}},new Promise((e,t)=>{var r=e=>{try{i(a.next(e))}catch(e){t(e)}},s=e=>{try{i(a.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);i((a=a.apply(void 0,null)).next())});var a},[e]);return(0,s.useMemo)(()=>({loadProduct:l,isLoading:i,product:o,isProductMockable:a,amountToBuy:n}),[l,i,o,a,n])})(),{loadSpecialOffers:re,isLoading:ae,specialOffer:ie}=(()=>{const e=(0,C.z)(),{lang:t}=(0,u.b)(),[r,a]=(0,s.useState)(!1),[i,n]=(0,s.useState)(null),o=(0,s.useCallback)(r=>{return s=function*(){a(!0);try{const a=yield e.getGameSpecialOffers(Number(r),t);return(0,A.q)("Fetched special offer",a),n(a),{specialOffer:a}}catch(e){throw e}finally{a(!1)}},new Promise((e,t)=>{var r=e=>{try{i(s.next(e))}catch(e){t(e)}},a=e=>{try{i(s.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,a);i((s=s.apply(void 0,null)).next())});var s},[e,t]);return(0,s.useMemo)(()=>({loadSpecialOffers:o,isLoading:r,specialOffer:i}),[o,r,i])})(),{buyGameProduct:ne,isLoading:le}=(()=>{const[e,t]=(0,s.useState)(!1),r=(0,C.z)(),a=(0,s.useCallback)(e=>{return a=function*(){const{productId:a,developerPayload:s,isTestPurchase:i,offerId:n,signed:o,gameId:l,isDraftGame:d,userDiscountId:c}=e;if(!a)throw new Error("No current product");t(!0);try{const e=yield E(r,{developerPayload:s||"",id:a,mock:Boolean(i),signed:Boolean(o),offerId:n,userDiscountId:c},{"app-id":l||"",draft:d});t(!1),(0,A.q)("buy response",e);const{data:u,signature:h}=(0,S.c)(e,I.H);return(0,A.q)("data",u),(0,A.q)("signature",h),{data:u,signature:h}}catch(e){throw t(!1),e}},new Promise((e,t)=>{var r=e=>{try{i(a.next(e))}catch(e){t(e)}},s=e=>{try{i(a.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);i((a=a.apply(void 0,null)).next())});var a},[r]);return(0,s.useMemo)(()=>({buyGameProduct:a,isLoading:e}),[a,e])})(),{getProductCurrency:de,realAmount:ce,productCurrencyPack:ue,currencyPrice:he,isLoadingProductCurrency:pe}=(()=>{const e=(0,C.z)(),[t,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(0),o=(0,n.T)(),{lang:l,playPageData:{gameInfo:d}}=(0,u.b)(),[c,h]=(0,s.useState)(!1),p=(0,s.useCallback)(t=>{return a=function*(){try{(0,A.q)("Load product pack"),h(!0);const{data:a}=yield e.fetchCurrencyProducts({amount:t,lang:l,appId:null==d?void 0:d.appId}),s=a[0].extraInfo.currency;return r(a[0]),i((0,f.OO)(a[0].extraInfo.price[s])),o((0,y.NW)(s||"RUB")),a[0]}catch(e){(0,A.q)("Error loading product pack",e)}finally{h(!1)}},new Promise((e,t)=>{var r=e=>{try{i(a.next(e))}catch(e){t(e)}},s=e=>{try{i(a.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,s);i((a=a.apply(void 0,null)).next())});var a},[e,o,l,null==d?void 0:d.appId]);return(0,s.useMemo)(()=>{var e;return{getProductCurrency:p,productCurrencyPack:t,currencyPrice:a,isLoadingProductCurrency:c,realAmount:null!=(e=null==t?void 0:t.extraInfo.amount.real)?e:0}},[p,t,c,a])})(),{getCurrencyPacks:ve,currencyPacks:me}=(()=>{const e=(0,C.z)(),{lang:t,playPageData:{gameInfo:r}}=(0,u.b)(),[a,i]=(0,s.useState)(!1),[n,o]=(0,s.useState)(null),l=(0,s.useCallback)(a=>{return s=function*(){try{(0,A.q)("Load currency packs"),i(!0);let{data:s}=yield e.fetchCurrencyProducts({forceGeneratedPack:!0,packsLimit:8,lang:t,minRequiredAmount:a,appId:null==r?void 0:r.appId});s=s.filter(e=>e.active),o(s)}catch(e){(0,A.q)("Failed to get currency packs",e)}finally{i(!1)}},new Promise((e,t)=>{var r=e=>{try{i(s.next(e))}catch(e){t(e)}},a=e=>{try{i(s.throw(e))}catch(e){t(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,a);i((s=s.apply(void 0,null)).next())});var s},[e,null==r?void 0:r.appId,t]);return(0,s.useMemo)(()=>({currencyPacks:n,getCurrencyPacks:l,isLoadingCurrencyPacks:a}),[l,n,a])})(),ge=(0,rr.u)(),[ye,fe]=(0,s.useState)(!1),[we,be]=(0,s.useState)(!1),[ke,Ae]=(0,s.useState)(!1),[Se,Pe]=(0,s.useState)(null),[Ie,Te]=(0,s.useState)(""),[Ee,Ce]=(0,s.useState)(!1),[De,Re]=(0,s.useState)(!1),[xe,_e]=(0,s.useState)(null),Le=(0,s.useMemo)(()=>null==Q?void 0:Q.getProductDiscount(),[Q]),Be=(0,s.useMemo)(()=>(null==Le?void 0:Le.discountedCurrencyPrice)?(0,f.OO)(Le.discountedCurrencyPrice):null,[Le]),Ne=(0,s.useMemo)(()=>null==Q?void 0:Q.getProductSpecialOffers(),[Q]),je=(0,l.v_)({on:"loyalty_offers"})?Ne:ie,Me=null==ue?void 0:ue.extraInfo.minAmount,He=(0,s.useMemo)(()=>(0,p.Z)(),[]),[$e,Fe]=(0,s.useState)((0,l.v_)({on:"payments_improvements_downgrade.fake_timeout"})),[We,qe]=(0,s.useState)(0),[Ue,Ve]=(0,s.useState)(d),Ke=(0,s.useMemo)(()=>Ue||ee||z||le||pe||Ee||ae,[Ue,ee,le,pe,z,Ee,ae]),Ye=(0,v.wc)(),Xe=(0,s.useRef)(new qt.Z({appId:(null==o?void 0:o.id)||"",productStatData:{id:r||""},basicSupportPaymentRequest:He,supportPaymentRequest:!1,dialogType:c.Z.PURCHASE,reachGoalRef:Ye})),Je=(0,s.useCallback)(e=>{!le&&Q&&he&&_e(t=>{var r,a,s,i,n,o,l;const d=null!=(s=null!=(a=null!=(r=null==e?void 0:e.amount)?r:null==Le?void 0:Le.discountedPrice)?a:null==t?void 0:t.amount)?s:ce;return{amount:d,balanceDiff:d,email:Ie||(null==e?void 0:e.email)||void 0,payCurrency:V,paymentService:ge,packId:null!=(i=null==e?void 0:e.packId)?i:null==t?void 0:t.packId,price:null!=(l=null!=(o=null!=(n=null==e?void 0:e.price)?n:Be)?o:null==t?void 0:t.price)?l:he,reason:oe.YC.PURCHASE,value:d}})},[le,Q,he,Le,Be,ce,Ie,V,ge]);(0,s.useEffect)(()=>{te&&Ae(!0)},[te]),(0,s.useEffect)(()=>{Je()},[Je]),(0,ar.q)(()=>{if(!(0,l.v_)({on:"payments_improvements_downgrade.fake_timeout"}))return;const e=window.setInterval(()=>{qe(t=>{const r=t+1;return r>=2&&(window.clearInterval(e),Fe(!1)),r})},5*se.WT);return()=>{window.clearInterval(e)}}),(0,s.useEffect)(()=>{Q&&Y&&Ue&&!$e&&(he||mr(Q,G))&&Ve(!1)},[he,$e,Y,G,K.uid,xe,Ue,Q,z,ue]),(0,ar.q)(()=>(o&&Z.gamePause("play_purchase_dialog"),r&&((0,A.q)("Load products"),J({"app-id":(null==o?void 0:o.id)||"",id:r,lang:t||O}).catch(e=>{tt(e,Ht.PRODUCT_LOAD_FAILED)})),()=>{ee&&Xe.current.error(new Error("InApp payment popup was closed."),{errorPlace:"purchase-show"}),o&&Z.gameResume("play_purchase_dialog")}));const Qe=(0,s.useCallback)(e=>{let t;null==x||x(e),t=(0,l.v_)({on:"partner_events"})&&(null==q?void 0:q.entitySlug)&&K.uid?{type:Ft.PURCHASE_SUCCESS_WITH_PARTNER_OFFER,partner:q.entitySlug}:e.offerId?{type:Ft.PURCHASE_SUCCESS_WITH_CLIENT_OFFER}:{type:Ft.PURCHASE_SUCCESS,recoveryCode:e.recoveryCode},Pe({name:"success",data:e,scenario:t})},[x,null==q?void 0:q.entitySlug,K.uid]),et=(0,s.useCallback)(()=>{"success"===(null==Se?void 0:Se.name)&&Se.data&&P(Se.data)},[P,Se]),tt=((0,s.useCallback)(()=>{_e(null),Re(!1),ye&&_()},[_,ye]),(0,s.useCallback)((e,t)=>{"RETRY_WITH"!==e.code&&(Xe.current.error(e,{errorPlace:"purchase",preventDestroy:!0}),h(e),Pe({name:"failure",reason:t||Ht.COMMON})),"RETRY_WITH"===e.code&&be(!0),_e(null),Re(!1)},[h,Pe])),rt=(0,s.useCallback)(()=>{return t=function*(){if(Q){Re(!1);try{if(o){const t=yield ne({developerPayload:e,gameId:o.id,isDraftGame:o.isDraft,userDiscountId:null==Le?void 0:Le.userDiscountId,signed:i,productId:Q.id,isTestPurchase:ke,offerId:null==je?void 0:je.offerID});if("success"===(null==t?void 0:t.data.status)){(null==je?void 0:je.offerID)&&W((0,k.ov)(je.offerID,B.flags)),W((0,y.uV)({forceFetch:!0}));const e=Boolean(K.uid);if(Xe.current.buyProduct({category:o.category,publisherName:o.publisherName}),e)Qe(pr(hr({},t),{offerId:null==je?void 0:je.offerID}));else{Ce(!0);try{const{code:e}=yield N.getRecoveryCode();Ce(!1),Qe(pr(hr({},t),{recoveryCode:e}))}catch(e){(0,I.H)({block:T.W.PAYMENT,sourceMethod:"getRecoveryCode",message:`${m.EW} getRecoveryCode error`,type:"fetch"},e)}}}else"failure"===(null==t?void 0:t.data.status)?tt(new g.Z({code:"PAYMENT_FAILURE",message:"Failure payment status."})):tt(new g.Z({code:"PAYMENT_FAILURE",message:"Unknown error"}))}}catch(e){(0,I.H)({block:T.W.PAYMENT},e),Ce(!1),tt(new g.Z({code:"PAYMENT_FAILURE",message:"Unknown error"}))}}},new Promise((e,r)=>{var a=e=>{try{i(t.next(e))}catch(e){r(e)}},s=e=>{try{i(t.throw(e))}catch(e){r(e)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,s);i((t=t.apply(undefined,null)).next())});var t},[B.flags,N,ne,Q,null==je?void 0:je.offerID,e,W,o,ke,null==Le?void 0:Le.userDiscountId,tt,Qe,i,K.uid]),at=(0,s.useCallback)(e=>{Xe.current.log(e?"productInfoCollapsed":"productInfoExpanded")},[]),st=(0,s.useCallback)(({amount:e,balance:t,currency:r,currentProduct:a,minAmount:s})=>{var i;if(!r||!a)return null;const n=Number(a.priceValue),o=Number(null==(i=a.getProductDiscount())?void 0:i.discountedPrice);if(o)return{price:n,discountPrice:o,title:j("purchase.price-details.discount.title"),description:j("payments.currency-not-enough-on-balance",{params:{currency:j("payments.currency",{number:o}).toLowerCase(),number:o}})};if(t&&t>=n){const e=t-n;return{price:n,title:j("payments.currency-will-be-debited-from-balance"),description:j("payments.currency-will-remain",{params:{currency:j("payments.currency",{number:e}).toLowerCase(),number:e}})}}const l=n-(null!=t?t:0);return{price:e,title:j("payments.total-to-be-paid"),description:l<s?j("payments.refill-min-amount",{params:{currency:j("payments.currency",{number:s}).toLowerCase(),number:s}}):j("payments.currency-not-enough-on-balance",{params:{currency:j("payments.currency",{number:l}).toLowerCase(),number:l}})}},[j]),it=(0,s.useCallback)(e=>{e&&(e.generated?Je({amount:ce,packId:-1,price:(0,f.OO)(e.extraInfo.price[V])}):Je({amount:e.extraInfo.amount.real,packId:e.id,price:(0,f.OO)(e.extraInfo.price[V])}))},[Je,ce,V]),nt=(0,s.useCallback)(e=>{(0,A.q)("confirmPayment"),Pe(null),be(!1),!he||ke?rt():(Xe.current.log("showPaymentIframe",{purchase:xe}),Re(!0),Je({email:e}))},[Je,rt,he,xe,ke]),ot=(0,s.useCallback)(e=>{(0,A.q)("onPaymentConfirm"),Te(e),(0,l.v_)({on:"payments_improvements_downgrade.approve_question"})?Pe({name:"approve"}):nt(e)},[nt]),lt=(0,s.useCallback)(e=>{e?(Pe(null),Re(ye),ye&&Je(),Xe.current.log("retry",{basicSupportPaymentRequest:He})):_()},[Pe,Je,He,_,ye]),dt=(0,s.useCallback)(()=>{Ae(!ke)},[ke]),ct=(0,s.useCallback)((e,t)=>{tt(t)},[tt]);(0,s.useEffect)(()=>{if(!Q||z||ue||!(null==o?void 0:o.id))return;const e=mr(Q,G),t=X;((0,l.v_)({on:"loyalty_offers"})?Promise.resolve({specialOffer:Ne}):re(o.id)).then(({specialOffer:r})=>{(null==r?void 0:r.offerID)&&Xe.current.sexyOfferShown(),e||(null==r?void 0:r.offerID)||ve(t)}).catch(e=>{tt(e)}),e||de(t).then(()=>{Xe.current.log("show",{basicSupportPaymentRequest:He}),Xe.current.addProductInCart({category:o.category,publisherName:o.publisherName})})},[Q,G,z,ve,de,re,tt,Ne,He,X,ue,o]);const ut=(0,s.useCallback)(()=>j($e?0===We?"spin.connection":"spin.initialization":"spin.wait"),[j,$e,We]),ht=(0,s.useCallback)(()=>(0,a.jsx)(b.y,{fullWidth:!0,position:"center",size:38,spinning:!0,text:ut()}),[ut]),pt=(0,s.useCallback)(()=>{if(!(null==xe?void 0:xe.price)||we||"success"===(null==Se?void 0:Se.name))return null;const e=xe.paymentService===oe.ob.PSP?Oe:Ze;return(0,a.jsx)(e,pr(hr({},xe),{amount:xe.packId&&-1!==xe.packId?void 0:xe.amount,dialogType:c.Z.PURCHASE,fullScreen:!0,gameId:null==o?void 0:o.id,hasSmallSpinWithText:!0,isInvisible:!1,packId:xe.packId&&-1!==xe.packId?xe.packId:void 0,shouldWaitIframeButtonClick:!1,onCreateIFrame:Te,onReject:ct,onResolve:rt}))},[xe,we,Se,o,ct,rt]),vt=()=>{if(!Q)return null;const e=st({amount:X,minAmount:null!=Me?Me:0,balance:G,currency:V,currentProduct:Q});return(0,a.jsxs)("div",{className:Dt,"data-testid":"product-info",children:[(0,a.jsx)(Vt,{description:Q.description,image:Q.imageURI,title:Q.title}),je&&(0,a.jsx)(l.hW,{off:"enable_client_gifts_card_view",onComponent:(0,a.jsx)(Qt,{giftPack:je})}),e?(0,a.jsx)(Yt,pr(hr({},e),{onCollapseInfo:at})):null]})},mt=Ke&&!Se;return(0,a.jsx)(vr,{isSpinVisible:mt,isVisibleIframe:De,purchaseInfo:xe,renderPurchaseIframe:pt,renderSpin:ht,skipEmail:ye&&!Se,onClosePaymentModal:_,children:!mt&&(("approve"===(null==Se?void 0:Se.name)?(0,a.jsx)(Nt,{children:(0,a.jsx)(jt,{className:Ct,email:Ie,onApprove:nt,onCancel:_})}):"success"===(null==Se?void 0:Se.name)?(0,a.jsx)(Nt,{children:(0,a.jsx)(Zt,{className:Rt,email:Ie,isLogin:Boolean(K.uid),scenario:Se.scenario,onActionClick:et})}):"failure"===(null==Se?void 0:Se.name)?(0,a.jsx)(Nt,{children:(0,a.jsx)($t,{className:Rt,reason:Se.reason,onActionClick:lt})}):void 0)||(0,a.jsxs)(Nt,{children:[vt(),te&&!De&&(0,a.jsx)("div",{className:"InAppPayments-module__testPurchaseCheckbox--zMouK",children:(0,a.jsx)(w.X,{checked:ke,label:j("payments.test-purchase"),size:18,onChange:dt})}),!je&&!(null==Le?void 0:Le.userDiscountId)&&(0,a.jsx)(bt,{className:Ct,currencyPacks:me,onChange:it}),(0,a.jsx)(l.hW,{on:"payments_partner_special_offer",onComponent:(0,a.jsx)(tr.O,{className:Dt,partnerModalType:"in-app",startPartnerOfferInNewTab:!0})}),(0,a.jsx)(l.hW,{on:"enable_client_gifts_card_view",onComponent:(0,a.jsx)("div",{className:Dt,children:(0,a.jsx)(Qt,{cardView:!0,giftPack:je,title:j("client-gift-list.title")})})}),(0,a.jsx)(Et,{amount:xe?xe.price:null!=Be?Be:he,className:(0,ze.E)((0,l.v_)({on:"sticky_payment_button"})&&"InAppPayments-module__confirmForm--MpsQ6",Dt),currency:V,initialEmail:Ie,isFormDisabled:De,isTestPurchaseCheckboxChecked:ke,onConfirmClick:ot})]}))})});var yr=r(25954);const fr=(0,s.memo)(({config:e,gameInfo:t,hasInitialLoader:r,onClose:i,onOpen:o,onPaymentFailed:l,onPaymentResolve:d=()=>{},onPaymentSuccess:c})=>{const[u,h]=(0,s.useState)(null),[p,v]=(0,s.useState)(null),f=(0,n.T)();(0,ar.q)(()=>{f((0,y.Zc)({forceFetch:!0})),null==o||o()});const w=(0,s.useCallback)(e=>{v({error:(0,yr.E)(e)})},[v]),b=(0,s.useCallback)(()=>{if(u)return c(u),void i(!0);if(p)return l(p),void i();const e=new g.Z({code:"PAYMENT_USER_CANCELED",message:"User canceled the order."});(0,I.H)({prefix:m.EW,block:T.W.PAYMENT},e),l({error:e}),i()},[l,c,i,u,p]),k=(0,s.useCallback)(e=>{c(e)},[c]),A=(0,s.useCallback)(e=>{h(e),d(e)},[d]);return(0,a.jsx)(gr,{config:e,gameInfo:t,hasInitialLoader:r,onClosePaymentModal:b,onConfirmSuccessPurchase:k,onPurchaseFailed:w,onPurchaseSuccess:A})});var wr=r(41145),br=r(61265);const kr={[oe.ob.PSP]:oe.qY.TRUST,[oe.ob.XSOLLA]:oe.qY.XSOLLA};var Ar=(e=>(e.START="start",e))(Ar||{}),Sr=Object.defineProperty,Pr=Object.defineProperties,Ir=Object.getOwnPropertyDescriptors,Tr=Object.getOwnPropertySymbols,Er=Object.prototype.hasOwnProperty,Cr=Object.prototype.propertyIsEnumerable,Dr=(e,t,r)=>t in e?Sr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rr=(e,t)=>{for(var r in t||(t={}))Er.call(t,r)&&Dr(e,r,t[r]);if(Tr)for(var r of Tr(t))Cr.call(t,r)&&Dr(e,r,t[r]);return e};class xr{constructor(){var e;Dr(this,"symbol"!=typeof(e="paymentsProvider")?e+"":e,undefined)}setPaymentsProvider(e){this.paymentsProvider=e}logError(e,t={}){const r=new Error(e);r.additional=t,(0,I.H)({prefix:"Payments ClickDaemon error",block:T.W.PAYMENT,additional:t},r)}sendLog(e,t){var r;const a=((e,t)=>Pr(e,Ir(t)))(Rr({},t),{provider:this.paymentsProvider,isLoggedIn:Boolean(t.isLoggedIn)});null==(r=window.clickdaemonLog)||r.call(window,`payment_${e}`,a)}start(e){const t=Rr({},e);e.appId&&(t.game_id=e.appId),this.sendLog(Ar.START,t)}}var _r=r(21595);const Or=({gameInfo:e,onStart:t})=>{const r=(0,s.useRef)(null),{registerPopup:i,isShown:g,hidePopup:y,showPopup:f}=(0,s.useContext)(br.OM),w=(0,v.wc)(),{config:b,finishPurchase:k}=(0,_r.W)(),A=(0,rr.u)(),S=(0,s.useRef)(null),P=(0,n.C)(e=>Boolean(e.userData.uid));(0,s.useEffect)(()=>{S.current=new xr},[]),(0,s.useEffect)(()=>{r.current=new qt.Z({appId:(null==e?void 0:e.id)||"",productStatData:{id:(null==b?void 0:b.productId)||""},basicSupportPaymentRequest:(0,p.Z)(),supportPaymentRequest:!1,dialogType:wr.Z.PURCHASE,reachGoalRef:w})},[e,b,w]),(0,s.useEffect)(()=>{b&&f({name:d,weight:50})},[b,f]),(0,s.useEffect)(()=>{var e;null==(e=S.current)||e.setPaymentsProvider((e=>kr[e])(A))},[A]),(0,ar.q)(()=>{i({name:d,weight:50,showCondition:()=>!1})});const I=(0,s.useCallback)(()=>{var r;null==(r=S.current)||r.start({appId:null==e?void 0:e.id,isLoggedIn:Boolean(P)}),null==t||t()},[e,P,t]),{handleClose:T,handlePaymentResolve:E,handleSuccessPayment:C,handleFailedPayment:D,handleOpenModal:R}=(({hidePopup:e,metrikaLogger:t,onFinish:r,onStart:a})=>{const{abt:i,tld:g,playPageData:y}=(0,u.b)(),f=(0,n.C)(e=>e.user),w=(0,n.C)(e=>e.userData.login),b=y.gameInfo.appId,k=(0,l.v_)({on:"payments_resolve_modal_promise_on_success"}),A=(0,v.vE)(),S=(0,s.useCallback)(t=>{A(m.Ji.PURCHASES_PURCHASE_CLOSE,{auth:w,dialog_type:c.Z.PURCHASE,appId:b,success_payment:Boolean(t)}),e(d)},[A,w,b,e]),P=(0,s.useCallback)(e=>{null==t||t.log("success",{basicSupportPaymentRequest:(0,p.Z)(),supportPaymentRequest:!1,purchaseToken:e.data.token,preventDestroy:!0}),null==t||t.reachGoals({hasAuth:Boolean(w),provider:f.payCurrencyFetched?(0,h.Y)(i.flags,g,f.payCurrency,(0,o.getDomainConfig)().payments.xsollaEnabled):void 0,offerId:e.offerId}),null==r||r({data:e})},[t,w,f.payCurrencyFetched,f.payCurrency,i.flags,g,r]),I=k?P:void 0,T=(0,s.useCallback)(e=>{k||P(e),S(!0)},[S,P,k]),E=(0,s.useCallback)(e=>{null==t||t.error(e.error,{errorPlace:"purchase",continuePaymentProcess:!0}),null==r||r({error:e.error})},[t,r]),C=(0,s.useCallback)(()=>{null==t||t.log("open"),null==t||t.openPurchase(Boolean(w)),null==a||a()},[t,w,a]);return{handleClose:S,handlePaymentResolve:I,handleSuccessPayment:T,handleFailedPayment:E,handleOpenModal:C}})({hidePopup:y,metrikaLogger:r.current,onFinish:k,onStart:I});return g(d)&&b?(0,a.jsx)(fr,{config:b,gameInfo:e,hasInitialLoader:!0,onClose:T,onOpen:R,onPaymentFailed:D,onPaymentResolve:E,onPaymentSuccess:C}):null}},3465:(e,t,r)=>{r.d(t,{I:()=>o,s:()=>l});var a=r(57627),s=r(87363),i=r(55557);const n=(0,s.createContext)(null),o=e=>{const[t,r]=(0,s.useState)(!1);return(0,a.jsx)(n.Provider,{value:{isReady:t,setIsReady:r},children:e.children})},l=()=>(0,i.C)({context:n,hookName:"useWithReady",contextName:"WithReadyContext"})},81391:(e,t,r)=>{r.d(t,{EP:()=>s});var a=r(99251);function s(e){const{hostname:t}=(0,a.e)();if(/\.yandex\.ru$/.test(t)){const r=new URL(e);r.hostname=t,e=r.toString()}return e}},43770:(e,t,r)=>{r.d(t,{TE:()=>u});var a=r(2592),s=Object.defineProperty,i=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,c=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;a.WT;const u=a.WT;i(((e,t)=>{for(var r in t||(t={}))l.call(t,r)&&c(e,r,t[r]);if(o)for(var r of o(t))d.call(t,r)&&c(e,r,t[r]);return e})({},{default:[[300,250],[300,300]],wide:[[728,90],[750,200],[970,90],[970,250],[980,90],[980,120]]}),n({wide:[[728,90],[970,90],[970,250]]}))},68401:(e,t,r)=>{r.d(t,{M:()=>i});var a=r(12536),s=r(71112);function i(e,t){const{blockId:r,pageId:a}=t;let i="__getTextFromYandexAdvError_EMPTY_ERROR_TEXT__";if(e.text){const t=new RegExp((0,s.h)(r),"g");if(i=e.text.replace(t,"{see additional}"),"number"==typeof a){const e=new RegExp(`{see additional}_${a}`,"g");i=i.replace(e,"{see additional}_{see additional}")}}return i}(0,a.bb)(a.QQ.NewByera)},23202:(e,t,r)=>{r.d(t,{H:()=>s});var a=r(20966);function s({adUnitCodes:e,advTag:t,bids:r}){for(let s of e){const e=null==r?void 0:r[s];if(e){const r=e.bids[0];(0,a.Kz)("prebid_auction","",{additional:{tag:t,bidder:r.bidder,currency:r.currency,originalCurrency:r.originalCurrency,size:r.size}})}else(0,a.Kz)("prebid_auction","",{additional:{tag:t,bidder:"none"}})}}},67296:(e,t,r)=>{r.d(t,{Z:()=>m});var a=r(55468),s=r(78825),i=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h=(e,t)=>{for(var r in t||(t={}))d.call(t,r)&&u(e,r,t[r]);if(l)for(var r of l(t))c.call(t,r)&&u(e,r,t[r]);return e},p=(e,t)=>n(e,o(t));function v(e,t={}){return s.Z.post({type:"auth",action:e,data:p(h({},t),{initializer:"auth-fetch-wrapper"})})}function m(e){return function(...t){return new Promise((r,s)=>{e(...t).then(e=>{r(e)}).catch(i=>{(0,a.ZR)(i)?(v("set-auth",{hasAuth:!1}),v("auth-dialog-open").then(({errorInstance:a})=>{if(a)throw a;e(...t).then(r).catch(s)}).catch(s)):s(i)})})}}},87343:(e,t,r)=>{function a(e){if(!e)return"";const t={"&amp;":"&","&#39;":"'","&quot;":'"'};return e.replace(/&amp;|&#39;|&quot;/g,e=>t[e])}r.d(t,{T:()=>a})},90336:(e,t,r)=>{r.d(t,{r:()=>s});var a=r(61916);const s=()=>"object"==typeof window&&"2735850"===(0,a.KT)()},87437:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(87026),s=r(20966),i=r(97731);const n=function(){const e=(0,a.Au)(),t=(0,a.H$)(),r=(0,a.Um)(),n=(0,a.q7)();try{if(window.yandex&&window.yandex.app&&"function"==typeof PaymentRequest&&t&&(e||n&&r))return!0}catch(e){(0,s.H)({block:i.W.PAYMENT},e)}return!1}},17332:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(78825),s=r(7323),i=r(29513);function n(){(0,s.Ur)(i.Z5,"true"),a.Z.post({type:"payments",action:"platform-purchase-start",data:{paymentsConfig:{},purchaseConfig:{id:i.U0.NO_ADS_ONE_DAY,developerPayload:""}}})}},26592:(e,t,r)=>{r.d(t,{G:()=>s,g:()=>i});var a=r(27713);const s=e=>Boolean((null==e?void 0:e.BrowserName)&&/Safari/i.test(e.BrowserName)),i=e=>(null==e?void 0:e.OSFamily)===a.k.IOS},95100:(e,t,r)=>{var a=r(87363);function s(e){return Array.prototype.slice.call(e)}function i(e,t){var r=Math.floor(e);return r===t||r+1===t?e:t}function n(){return Date.now()}function o(e,t,r){if(t="data-keen-slider-"+t,null===r)return e.removeAttribute(t);e.setAttribute(t,r||"")}function l(e,t){return t=t||document,"function"==typeof e&&(e=e(t)),Array.isArray(e)?e:"string"==typeof e?s(t.querySelectorAll(e)):e instanceof HTMLElement?[e]:e instanceof NodeList?s(e):[]}function d(e){e.raw&&(e=e.raw),e.cancelable&&!e.defaultPrevented&&e.preventDefault()}function c(e){e.raw&&(e=e.raw),e.stopPropagation&&e.stopPropagation()}function u(){var e=[];return{add:function(t,r,a,s){t.addListener?t.addListener(a):t.addEventListener(r,a,s),e.push([t,r,a,s])},input:function(e,t,r,a){this.add(e,t,function(e){return function(t){t.nativeEvent&&(t=t.nativeEvent);var r=t.changedTouches||[],a=t.targetTouches||[],s=t.detail&&t.detail.x?t.detail:null;return e({id:s?s.identifier?s.identifier:"i":a[0]?a[0]?a[0].identifier:"e":"d",idChanged:s?s.identifier?s.identifier:"i":r[0]?r[0]?r[0].identifier:"e":"d",raw:t,x:s&&s.x?s.x:a[0]?a[0].screenX:s?s.x:t.pageX,y:s&&s.y?s.y:a[0]?a[0].screenY:s?s.y:t.pageY})}}(r),a)},purge:function(){e.forEach(function(e){e[0].removeListener?e[0].removeListener(e[2]):e[0].removeEventListener(e[1],e[2],e[3])}),e=[]}}}function h(e,t,r){return Math.min(Math.max(e,t),r)}function p(e){return(e>0?1:0)-(e<0?1:0)||+e}function v(e){var t=e.getBoundingClientRect();return{height:i(t.height,e.offsetHeight),width:i(t.width,e.offsetWidth)}}function m(e,t,r,a){var s=e&&e[t];return null==s?r:a&&"function"==typeof s?s():s}function g(e){return Math.round(1e6*e)/1e6}function y(e,t){if(e===t)return!0;var r=typeof e;if(r!==typeof t)return!1;if("object"!==r||null===e||null===t)return"function"===r&&e.toString()===t.toString();if(e.length!==t.length||Object.getOwnPropertyNames(e).length!==Object.getOwnPropertyNames(t).length)return!1;for(var a in e)if(!y(e[a],t[a]))return!1;return!0}var f=function(){return f=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},f.apply(this,arguments)};function w(e,t,r){if(r||2===arguments.length)for(var a,s=0,i=t.length;s<i;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}function b(e){var t,r,a,s,i,o,l,d,c,u,v,y,f,b,k=1/0,A=[],S=null,P=0;function I(e){L(P+e)}function T(e){var t=E(P+e).abs;return R(t)?t:null}function E(e){var t=Math.floor(Math.abs(g(e/r))),a=g((e%r+r)%r);a===r&&(a=0);var s=p(e),i=l.indexOf(w([],l,!0).reduce(function(e,t){return Math.abs(t-a)<Math.abs(e-a)?t:e})),n=i;return s<0&&t++,i===o&&(n=0,t+=s>0?1:-1),{abs:n+t*o*s,origin:i,rel:n}}function C(e,t,r){var a;if(t||!_())return D(e,r);if(!R(e))return null;var s=E(null!=r?r:P),i=s.abs,n=e-s.rel,l=i+n;a=D(l);var d=D(l-o*p(n));return(null!==d&&Math.abs(d)<Math.abs(a)||null===a)&&(a=d),g(a)}function D(e,t){if(null==t&&(t=g(P)),!R(e)||null===e)return null;e=Math.round(e);var a=E(t),s=a.abs,i=a.rel,n=a.origin,d=O(e),c=(t%r+r)%r,u=l[n],h=Math.floor((e-(s-i))/o)*r;return g(u-c-u+l[d]+h+(n===o?r:0))}function R(e){return x(e)===e}function x(e){return h(e,c,u)}function _(){return s.loop}function O(e){return(e%o+o)%o}function L(t){var r;r=t-P,A.push({distance:r,timestamp:n()}),A.length>6&&(A=A.slice(-6)),P=g(t);var a=B().abs;if(a!==S){var s=null!==S;S=a,s&&e.emit("slideChanged")}}function B(n){var l=n?null:function(){if(o){var e=_(),t=e?(P%r+r)%r:P,n=(e?P%r:P)-i[0][2],l=0-(n<0&&e?r-Math.abs(n):n),d=0,h=E(P),m=h.abs,g=h.rel,w=i[g][2],k=i.map(function(t,a){var i=l+d;(i<0-t[0]||i>1)&&(i+=(Math.abs(i)>r-1&&e?r:0)*p(-i));var n=a-g,c=p(n),u=n+m;e&&(-1===c&&i>w&&(u+=o),1===c&&i<w&&(u-=o),null!==v&&u<v&&(i+=r),null!==y&&u>y&&(i-=r));var h=i+t[0]+t[1],f=Math.max(i>=0&&h<=1?1:h<0||i>1?0:i<0?Math.min(1,(t[0]+i)/t[0]):(1-i)/t[0],0);return d+=t[0]+t[1],{abs:u,distance:s.rtl?-1*i+1-t[0]:i,portion:f,size:t[0]}});return m=x(m),g=O(m),{abs:x(m),length:a,max:b,maxIdx:u,min:f,minIdx:c,position:P,progress:e?t/r:P/a,rel:g,slides:k,slidesLength:r}}}();return t.details=l,e.emit("detailsChanged"),l}return t={absToRel:O,add:I,details:null,distToIdx:T,idxToDist:C,init:function(t){if(function(){if(s=e.options,i=(s.trackConfig||[]).map(function(e){return[m(e,"size",1),m(e,"spacing",0),m(e,"origin",0)]}),o=i.length){r=g(i.reduce(function(e,t){return e+t[0]+t[1]},0));var t,n=o-1;a=g(r+i[0][2]-i[n][0]-i[n][2]-i[n][1]),l=i.reduce(function(e,r){if(!e)return[0];var a=i[e.length-1],s=e[e.length-1]+(a[0]+a[2])+a[1];return s-=r[2],e[e.length-1]>s&&(s=e[e.length-1]),s=g(s),e.push(s),(!t||t<s)&&(d=e.length-1),t=s,e},null),0===a&&(d=0),l.push(g(r))}}(),!o)return B(!0);var n;!function(){var t=e.options.range,r=e.options.loop;v=c=r?m(r,"min",-1/0):0,y=u=r?m(r,"max",k):d;var a=m(t,"min",null),s=m(t,"max",null);null!==a&&(c=a),null!==s&&(u=s),f=c===-1/0?c:e.track.idxToDist(c||0,!0,0),b=u===k?u:C(u,!0,0),null===s&&(y=u),m(t,"align",!1)&&u!==k&&0===i[O(u)][2]&&(b-=1-i[O(u)][0],u=T(b-P)),f=g(f),b=g(b)}(),n=t,Number(n)===n?I(D(x(t))):B()},to:L,velocity:function(){var e=n(),t=A.reduce(function(t,r){var a=r.distance,s=r.timestamp;return e-s>200||(p(a)!==p(t.distance)&&t.distance&&(t={distance:0,lastTimestamp:0,time:0}),t.time&&(t.distance+=a),t.lastTimestamp&&(t.time+=s-t.lastTimestamp),t.lastTimestamp=s),t},{distance:0,lastTimestamp:0,time:0});return t.distance/t.time||0}}}function k(e){var t,r,a,s,i,n,o,l;function d(e){return 2*e}function c(e){return h(e,o,l)}function u(e){return 1-Math.pow(1-e,3)}function v(){return a?e.track.velocity():0}function m(e,t){void 0===t&&(t=1e3);var r=147e-9+(e=Math.abs(e))/t;return{dist:Math.pow(e,2)/r,dur:e/r}}function g(){var t=e.track.details;t&&(i=t.min,n=t.max,o=t.minIdx,l=t.maxIdx)}function y(){e.animator.stop()}e.on("updated",g),e.on("optionsChanged",g),e.on("created",g),e.on("dragStarted",function(){a=!1,y(),t=r=e.track.details.abs}),e.on("dragChecked",function(){a=!0}),e.on("dragEnded",function(){var a=e.options.mode;"snap"===a&&function(){var a=e.track,s=e.track.details,o=s.position,l=p(v());(o>n||o<i)&&(l=0);var d=t+l;0===s.slides[a.absToRel(d)].portion&&(d-=l),t!==r&&(d=r),p(a.idxToDist(d,!0))!==l&&(d+=l),d=c(d);var u=a.idxToDist(d,!0);e.animator.start([{distance:u,duration:500,easing:function(e){return 1+--e*e*e*e*e}}])}(),"free"!==a&&"free-snap"!==a||function(){y();var t="free-snap"===e.options.mode,r=e.track,a=v();s=p(a);var o=e.track.details,l=[];if(a||!t){var h=m(a),g=h.dist,f=h.dur;if(f=d(f),g*=s,t){var w=r.idxToDist(r.distToIdx(g),!0);w&&(g=w)}l.push({distance:g,duration:f,easing:u});var b=o.position,k=b+g;if(k<i||k>n){var A=k<i?i-b:n-b,S=0,P=a;if(p(A)===s){var I=Math.min(Math.abs(A)/Math.abs(g),1),T=function(e){return 1-Math.pow(1-e,1/3)}(I)*f;l[0].earlyExit=T,P=a*(1-I)}else l[0].earlyExit=0,S+=A;var E=m(P,100),C=E.dist*s;e.options.rubberband&&(l.push({distance:C,duration:d(E.dur),easing:u}),l.push({distance:-C+S,duration:500,easing:u}))}e.animator.start(l)}else e.moveToIdx(c(o.abs),!0,{duration:500,easing:function(e){return 1+--e*e*e*e*e}})}()}),e.on("dragged",function(){r=e.track.details.abs})}function A(e){var t,r,a,s,i,n,o,v,m,g,y,f,w,b,k,A,S,P,I=u();function T(t){if(n&&v===t.id){var l=R(t);if(m){if(!D(t))return C(t);g=l,m=!1,e.emit("dragChecked")}if(A)return g=l;d(t);var u=function(t){if(S===-1/0&&P===1/0)return t;var a=e.track.details,n=a.length,o=a.position,l=h(t,S-o,P-o);if(0===n)return 0;if(!e.options.rubberband)return l;if(o<=P&&o>=S)return t;if(o<S&&r>0||o>P&&r<0)return t;var d=(o<S?o-S:o-P)/n,c=s*n,u=Math.abs(d*c),p=Math.max(0,1-u/i*2);return p*p*t}(o(g-l)/s*a);r=p(u);var w=e.track.details.position;(w>S&&w<P||w===S&&r>0||w===P&&r<0)&&c(t),y+=u,!f&&Math.abs(y*s)>5&&(f=!0),e.track.add(u),g=l,e.emit("dragged")}}function E(t){!n&&e.track.details&&e.track.details.length&&(y=0,n=!0,f=!1,m=!0,v=t.id,D(t),g=R(t),e.emit("dragStarted"))}function C(t){n&&v===t.idChanged&&(n=!1,e.emit("dragEnded"))}function D(e){var t=x(),r=t?e.y:e.x,a=t?e.x:e.y,s=void 0!==w&&void 0!==b&&Math.abs(b-a)<=Math.abs(w-r);return w=r,b=a,s}function R(e){return x()?e.y:e.x}function x(){return e.options.vertical}function _(){s=e.size,i=x()?window.innerHeight:window.innerWidth;var t=e.track.details;t&&(S=t.min,P=t.max)}function O(e){f&&(c(e),d(e))}function L(){if(I.purge(),e.options.drag&&!e.options.disabled){var r;r=e.options.dragSpeed||1,o="function"==typeof r?r:function(e){return e*r},a=e.options.rtl?-1:1,_(),t=e.container,function(){var e="data-keen-slider-clickable";l("[".concat(e,"]:not([").concat(e,"=false])"),t).map(function(e){I.add(e,"dragstart",c),I.add(e,"mousedown",c),I.add(e,"touchstart",c)})}(),I.add(t,"dragstart",function(e){d(e)}),I.add(t,"click",O,{capture:!0}),I.input(t,"ksDragStart",E),I.input(t,"ksDrag",T),I.input(t,"ksDragEnd",C),I.input(t,"mousedown",E),I.input(t,"mousemove",T),I.input(t,"mouseleave",C),I.input(t,"mouseup",C),I.input(t,"touchstart",E,{passive:!0}),I.input(t,"touchmove",T,{passive:!1}),I.input(t,"touchend",C),I.input(t,"touchcancel",C),I.add(window,"wheel",function(e){n&&d(e)});var s="data-keen-slider-scrollable";l("[".concat(s,"]:not([").concat(s,"=false])"),e.container).map(function(e){return function(e){var t;I.input(e,"touchstart",function(e){t=R(e),A=!0,k=!0},{passive:!0}),I.input(e,"touchmove",function(r){var a=x(),s=a?e.scrollHeight-e.clientHeight:e.scrollWidth-e.clientWidth,i=t-R(r),n=a?e.scrollTop:e.scrollLeft,o=a&&"scroll"===e.style.overflowY||!a&&"scroll"===e.style.overflowX;if(t=R(r),(i<0&&n>0||i>0&&n<s)&&k&&o)return A=!0;k=!1,d(r),A=!1}),I.input(e,"touchend",function(){A=!1})}(e)})}}e.on("updated",_),e.on("optionsChanged",L),e.on("created",L),e.on("destroyed",I.purge)}function S(e){var t,r,a=null;function s(t,r,a){e.animator.active?n(t,r,a):requestAnimationFrame(function(){return n(t,r,a)})}function i(){s(!1,!1,r)}function n(r,s,i){var n=0,o=e.size,c=e.track.details;if(c&&t){var u=c.slides;t.forEach(function(e,t){if(r)!a&&s&&l(e,null,i),d(e,null,i);else{if(!u[t])return;var c=u[t].size*o;!a&&s&&l(e,c,i),d(e,u[t].distance*o-n,i),n+=c}})}}function o(t){return"performance"===e.options.renderMode?Math.round(t):t}function l(e,t,r){var a=r?"height":"width";null!==t&&(t=o(t)+"px"),e.style["min-"+a]=t,e.style["max-"+a]=t}function d(e,t,r){if(null!==t){t=o(t);var a=r?t:0;t="translate3d(".concat(r?0:t,"px, ").concat(a,"px, 0)")}e.style.transform=t,e.style["-webkit-transform"]=t}function c(){t&&(n(!0,!0,r),t=null),e.on("detailsChanged",i,!0)}function u(){s(!1,!0,r)}function h(){c(),r=e.options.vertical,e.options.disabled||"custom"===e.options.renderMode||(a="auto"===m(e.options.slides,"perView",null),e.on("detailsChanged",i),(t=e.slides).length&&u())}e.on("created",h),e.on("optionsChanged",h),e.on("beforeOptionsChanged",function(){c()}),e.on("updated",u),e.on("destroyed",c)}function P(e,t){return function(r){var a,s,i,n,d,c=u();function h(e){var t;o(r.container,"reverse","rtl"!==(t=r.container,window.getComputedStyle(t,null).getPropertyValue("direction"))||e?null:""),o(r.container,"v",r.options.vertical&&!e?"":null),o(r.container,"disabled",r.options.disabled&&!e?"":null)}function p(){g()&&A()}function g(){var e=null;if(n.forEach(function(t){t.matches&&(e=t.__media)}),e===a)return!1;a||r.emit("beforeOptionsChanged"),a=e;var t=e?i.breakpoints[e]:i;return r.options=f(f({},i),t),h(),E(),C(),P(),!0}function y(e){var t=v(e);return(r.options.vertical?t.height:t.width)/r.size||1}function w(){return r.options.trackConfig.length}function b(e){for(var o in a=!1,i=f(f({},t),e),c.purge(),s=r.size,n=[],i.breakpoints||[]){var l=window.matchMedia(o);l.__media=o,n.push(l),c.add(l,"change",p)}c.add(window,"orientationchange",T),c.add(window,"resize",I),g()}function k(e){r.animator.stop();var t=r.track.details;r.track.init(null!=e?e:t?t.abs:0)}function A(e){k(e),r.emit("optionsChanged")}function S(e,t){if(e)return b(e),void A(t);E(),C();var a=w();P(),w()!==a?A(t):k(t),r.emit("updated")}function P(){var e=r.options.slides;if("function"==typeof e)return r.options.trackConfig=e(r.size,r.slides);for(var t=r.slides,a=t.length,s="number"==typeof e?e:m(e,"number",a,!0),i=[],n=m(e,"perView",1,!0),o=m(e,"spacing",0,!0)/r.size||0,l="auto"===n?o:o/n,d=m(e,"origin","auto"),c=0,u=0;u<s;u++){var h="auto"===n?y(t[u]):1/n-o+l,p="center"===d?.5-h/2:"auto"===d?0:d;i.push({origin:p,size:h,spacing:o}),c+=h}if(c+=o*(s-1),"auto"===d&&!r.options.loop&&1!==n){var v=0;i.map(function(e){var t=c-v;return v+=e.size+o,t>=1||(e.origin=1-t-(c>1?0:1-c)),e})}r.options.trackConfig=i}function I(){E();var e=r.size;r.options.disabled||e===s||(s=e,S())}function T(){I(),setTimeout(I,500),setTimeout(I,2e3)}function E(){var e=v(r.container);r.size=(r.options.vertical?e.height:e.width)||1}function C(){r.slides=l(r.options.selector,r.container)}r.container=(d=l(e,document)).length?d[0]:null,r.destroy=function(){c.purge(),r.emit("destroyed"),h(!0)},r.prev=function(){r.moveToIdx(r.track.details.abs-1,!0)},r.next=function(){r.moveToIdx(r.track.details.abs+1,!0)},r.update=S,b(r.options)}}var I=function(e,t,r){try{return function(e,t){var r,a={};return r={emit:function(e){a[e]&&a[e].forEach(function(e){e(r)});var t=r.options&&r.options[e];t&&t(r)},moveToIdx:function(e,t,a){var s=r.track.idxToDist(e,t);if(s){var i=r.options.defaultAnimation;r.animator.start([{distance:s,duration:m(a||i,"duration",500),easing:m(a||i,"easing",function(e){return 1+--e*e*e*e*e})}])}},on:function(e,t,r){void 0===r&&(r=!1),a[e]||(a[e]=[]);var s=a[e].indexOf(t);s>-1?r&&delete a[e][s]:r||a[e].push(t)},options:e},function(){if(r.track=b(r),r.animator=function(e){var t,r,a,s,i,n;function o(t){n||(n=t),l(!0);var i=t-n;i>a&&(i=a);var u=s[r];if(u[3]<i)return r++,o(t);var h=u[2],p=u[4],v=u[0],m=u[1]*(0,u[5])(0===p?1:(i-h)/p);if(m&&e.track.to(v+m),i<a)return c();n=null,l(!1),d(null),e.emit("animationEnded")}function l(e){t.active=e}function d(e){t.targetIdx=e}function c(){var e;e=o,i=window.requestAnimationFrame(e)}function u(){var t;t=i,window.cancelAnimationFrame(t),l(!1),d(null),n&&e.emit("animationStopped"),n=null}return t={active:!1,start:function(t){if(u(),e.track.details){var i=0,n=e.track.details.position;r=0,a=0,s=t.map(function(e){var t,r=Number(n),s=null!==(t=e.earlyExit)&&void 0!==t?t:e.duration,o=e.easing,l=e.distance*o(s/e.duration)||0;n+=l;var d=a;return a+=s,i+=l,[r,e.distance,d,a,e.duration,o]}),d(e.track.distToIdx(i)),c(),e.emit("animationStarted")}},stop:u,targetIdx:null}}(r),t)for(var e=0,a=t;e<a.length;e++)(0,a[e])(r);r.track.init(r.options.initial||0),r.emit("created")}(),r}(t,w([P(e,{drag:!0,mode:"snap",renderMode:"precision",rubberband:!0,selector:".keen-slider__slide"}),S,A,k],r||[],!0))}catch(e){console.error(e)}};t.E=function(e,t){var r=a.useRef(null),s=a.useRef(!1),i=a.useRef(e),n=a.useCallback(function(a){a?(i.current=e,r.current=new I(a,e,t),s.current=!1):(r.current&&r.current.destroy&&r.current.destroy(),r.current=null)},[]);return a.useEffect(function(){y(i.current,e)||(i.current=e,r.current&&r.current.update(i.current))},[e]),[n,r]}},68178:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});const a={label:"checkbox-desktop-critical-module__label--GXRye"}},10767:(e,t,r)=>{r.r(t)}}]);
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/build/client/game/desktop/yandex/5512.b0bffc9fb8d734233f61.js.map