"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[891],{35158:(e,n,t)=>{t.r(n),t.d(n,{DebugInfoForSupport:()=>L});var o=t(71112);function r(e,n){const t=new RegExp(`(?:^|;) ?${(0,o.h)(n)}=([^;]*)`),r=e.match(t);if(r)try{return decodeURIComponent(r[1])}catch(e){}}var a=t(87363),u=t(38225),i=t(77314),s=t(4545);function c(){const{hostname:e}=(0,s.getDomainConfig)();return`${e}_support_debug_log`}var d=t(78825),l=t(76753),g=t(23665),f=t(61712),y=t(20966),h=t(7323),v=t(97731);function _(e,n,t){try{const o=c(),r=JSON.parse((0,h.dq)(o).value||"{}");r[e]=t(void 0===r[e]?n:r[e]),(0,h.Ur)(o,JSON.stringify(r))}catch(e){(0,y.H)({block:v.W.APP_PAGE,sourceMethod:"updateDebugInfoField"},e)}}function p(){var e;try{const n=(null==(e=(JSON.parse((0,h.dq)(c()).value||"{}").logins||[])[0])?void 0:e.cookie)||"";return{yandexuid:r(n,"yandexuid"),yandexLogin:r(n,"yandex_login")}}catch(e){return(0,y.H)({block:v.W.APP_PAGE,sourceMethod:"DebugInfoForSupport"},e),{}}}const L=()=>{const e=(0,u.C)(e=>e.userData.login),n=(0,a.useRef)({}),t=(0,a.useRef)(e),{playPageData:{playerInfo:{hasAuthOnStart:o}}}=(0,i.b)(),r=(0,a.useCallback)(()=>{const e=(0,g.e)("yandexuid")||"",o=t.current!==n.current.yandexLogin;if(t.current&&n.current.yandexLogin&&o&&(0,f.U4)({},{loginWasChanged:!0}),o||e!==n.current.yandexuid){n.current={yandexuid:e,yandexLogin:t.current};const o={cookie:`yandexuid=${e}; yandex_login=${t.current}`,timestamp:Date.now()};_("logins",[],e=>[o].concat(e).slice(0,5))}},[]);return(0,l.q)(()=>{n.current=p(),document.addEventListener("visibilitychange",r),window.addEventListener("focus",r);const e=e=>{e.key===c()&&(n.current=p())};return window.addEventListener("storage",e),()=>{document.removeEventListener("visibilitychange",r),window.removeEventListener("focus",r),window.removeEventListener("storage",e)}}),(0,a.useEffect)(()=>{e!==t.current&&(t.current=e,r())},[e,r]),(0,l.q)(()=>{if(!o)return;const e=n=>{const{action:t}=n.data;"auth-dialog-open"===t&&(d.Z.offAllMessages("auth",e),(0,f.U4)({},{authorizationReset:!0}),_("authorizationReset","No",()=>"Yes"))};return d.Z.onAllMessages("auth",e),()=>{d.Z.offAllMessages("auth",e)}}),null}}}]);
//# sourceMappingURL=https://s3.mdst.yandex.net/games/source-maps/_/build/client/game/desktop/yandex/DebugInfoForSupport.component.async.36fa3d8f5ddb4edb9071.js.map